---
TOCTitle: 'MS04-028'
Title: 'Microsoft 安全公告 MS04-028 - 严重'
ms:assetid: 'ms04-028'
ms:contentKeyID: 61236592
ms:mtpsurl: 'https://technet.microsoft.com/zh-CN/library/ms04-028(v=Security.10)'
---

Microsoft 安全公告 MS04-028 - 严重
==================================

JPEG 处理时 (GDI+) 的缓冲区溢出可能允许执行代码 (833987)
--------------------------------------------------------

发布时间: 2004年9月14日 | 更新时间: 2004年12月14日

**发布日期：**2004 年 9 月 14 日
**更新日期：**2004 年 12 月 14 日
**版本：**3.0

#### 摘要

**本文的目标读者：**使用任何受影响的操作系统、受影响的软件程序或受影响的组件的客户。

**漏洞的影响：**远程执行代码

**最高严重等级：**严重

**建议：**用户应立即应用此更新。

**安全更新替代：**无

**注意事项：**如果已经安装公告中列出的任何受到影响的程序或组件，则应该为每一个受到影响的程序或组件安装所需的安全更新。 这可能要求安装多个安全更新。 有关详细信息，请参见本公告的 FAQ 部分。
Microsoft 知识库文章 [833987](http://support.microsoft.com/default.aspx?scid=kb;zh-cn;833987) 介绍了客户在安装此安全更新时可能遇到的当前已知的问题。 这篇文章还介绍了这些问题的建议解决办法。 有关详细信息，请参见 Microsoft 知识库文章 [833987](http://support.microsoft.com/default.aspx?scid=kb;zh-cn;833987) 或本安全公告的 FAQ 部分。

**测试过的软件和安全更新下载位置：**  

**受影响的软件：**  

-   Microsoft Windows XP 和 Microsoft Windows XP Service Pack 1 – [下载此更新 (KB833987)](http://www.microsoft.com/downloads/details.aspx?displaylang=zh-cn&familyid=6f8d70c1-63bd-4213-82c1-20266fdfd735)
-   Microsoft Windows XP 64-Bit Edition Service Pack 1 – [下载此更新 (KB833987) \[英文\]](http://www.microsoft.com/downloads/details.aspx?familyid=1631c3f7-a40e-4b26-bd92-12141e6a7f58&displaylang=en)
-   Microsoft Windows XP 64-Bit Edition Version 2003 – [下载此更新 (KB833987) \[英文\]](http://www.microsoft.com/downloads/details.aspx?familyid=98bff681-9703-4d23-8df8-b7239d6c531c&displaylang=en)
-   Microsoft Windows Server™ 2003 – [下载此更新 (KB833987)](http://www.microsoft.com/downloads/details.aspx?displaylang=zh-cn&familyid=b2fbd93c-3dc3-4a9e-bdd6-9f39726ee3e2)
-   Microsoft Windows Server 2003 64-Bit Edition – [下载此更新 (KB833987) \[英文\]](http://www.microsoft.com/downloads/details.aspx?familyid=98bff681-9703-4d23-8df8-b7239d6c531c&displaylang=en)
-   Microsoft Office XP Service Pack 3 – [下载此更新 (KB832332)](http://www.microsoft.com/downloads/details.aspx?displaylang=zh-cn&familyid=7d128614-6d34-49df-8d63-6c17e9a2d312)

    Microsoft Office XP Service Pack 2 – [下载此管理更新 (KB832332)](http://www.microsoft.com/downloads/details.aspx?displaylang=zh-cn&familyid=7d128614-6d34-49df-8d63-6c17e9a2d312)

    Microsoft Office XP 软件：

    -   Outlook® 2002
    -   Word 2002
    -   Excel 2002
    -   PowerPoint® 2002
    -   FrontPage® 2002
    -   Publisher 2002
    -   Access 2002

-   Microsoft Office 2003 – [下载此更新 (KB838905)](http://www.microsoft.com/downloads/details.aspx?displaylang=zh-cn&familyid=106bcf99-1ba9-4035-94c5-2a7fa90e5971)

    Microsoft Office 2003 软件：

    -   Outlook® 2003
    -   Word 2003
    -   Excel 2003
    -   PowerPoint® 2003
    -   FrontPage® 2003
    -   Publisher 2003
    -   Access 2003
    -   InfoPath™ 2003
    -   OneNote™ 2003

-   Microsoft Project 2002（所有版本）和 Microsoft Project 2002 Service Pack 1（所有版本）– [下载此更新 (KB831931)](http://www.microsoft.com/downloads/details.aspx?displaylang=zh-cn&familyid=b3ebccea-b0e4-41c7-a6f4-413864d2ccf3)
-   Microsoft Project 2003（所有版本） – [下载此更新 (KB838344)](http://www.microsoft.com/downloads/details.aspx?displaylang=zh-cn&familyid=9e37b6b0-a028-47ea-8fa1-3705877a2908)
-   Microsoft Visio 2002 Service Pack 1（所有版本）和 Microsoft Visio 2002 Service Pack 2（所有版本） – [下载此更新 (KB831932)](http://www.microsoft.com/downloads/details.aspx?displaylang=zh-cn&familyid=16c2dffd-7b73-43c4-ab0d-2b5efc80eb63)
-   Microsoft Visio 2003（所有版本） – [下载此更新 (KB838345)](http://www.microsoft.com/downloads/details.aspx?displaylang=zh-cn&familyid=c07d40a5-6f87-4d50-9640-34ffd2f189e1)
-   Microsoft Visual Studio .NET 2002 – [下载此更新 (KB830348)](http://www.microsoft.com/downloads/details.aspx?displaylang=zh-cn&familyid=44004d19-b22f-4af2-a701-1fcb0467fbf9)

    Microsoft Visual Studio .NET 2002 软件：

    -   Visual Basic .NET Standard 2002
    -   Visual C\# .NET Standard 2002
    -   Visual C++ .NET Standard 2002

-   Microsoft Visual Studio .NET 2003 – [下载此更新 (KB830348)](http://www.microsoft.com/downloads/details.aspx?displaylang=zh-cn&familyid=a13b7a21-463c-4286-ad68-e692417e80e2)

    Microsoft Visual Studio .NET 2003 软件：

    -   Visual Basic .NET Standard 2003
    -   Visual C\# .NET Standard 2003
    -   Visual C++ .NET Standard 2003
    -   Visual J\# .NET Standard 2003

-   Microsoft Visual FoxPro 8.0 – [下载此更新 (KB887684) \[更新中\]](http://www.microsoft.com/downloads/details.aspx?familyid=a1c5e871-596c-4e33-9eaf-f9a2e4d4dad0)
-   Microsoft Visual FoxPro 8.0 Runtime Library – [下载此更新 (KB887685) \[更新中\]](http://www.microsoft.com/downloads/details.aspx?familyid=aec714be-9747-4b57-9967-5f5ac8b8ee87)
-   Microsoft .NET Framework 版本 1.0 SDK Service Pack 2 – [下载此更新 (KB830348) \[更新中\]](http://www.microsoft.com/downloads/details.aspx?familyid=69703d1d-2ce3-42da-abf8-353d2121dab0) 或[下载 Microsoft .NET Framework 版本 1.0 Service Pack 3 (KB867461)](http://www.microsoft.com/downloads/details.aspx?displaylang=zh-cn&familyid=6978d761-4a92-4106-a9bc-83e78d4abc5b)
-   Microsoft Picture It!® 2002（所有版本） – [下载此更新 \[英文\]](http://www.microsoft.com/downloads/details.aspx?familyid=235ebc80-564b-4b52-a344-502e25aad7fe&displaylang=en)
-   Microsoft Greetings 2002 – [下载此更新 \[英文\]](http://www.microsoft.com/downloads/details.aspx?familyid=235ebc80-564b-4b52-a344-502e25aad7fe&displaylang=en)
-   Microsoft Picture It! 版本 7.0（所有版本）– [下载此更新 \[英文\]](http://www.microsoft.com/downloads/details.aspx?familyid=235ebc80-564b-4b52-a344-502e25aad7fe&displaylang=en)
-   Microsoft Digital Image Pro 版本 7.0 – [下载此更新 \[英文\]](http://www.microsoft.com/downloads/details.aspx?familyid=235ebc80-564b-4b52-a344-502e25aad7fe&displaylang=en)
-   Microsoft Picture It! 版本 9（所有版本，包括 Picture It! 库）– [下载此更新 \[英文\]](http://www.microsoft.com/downloads/details.aspx?familyid=235ebc80-564b-4b52-a344-502e25aad7fe&displaylang=en)
-   Microsoft Digital Image Pro 版本 9 – [下载此更新 \[英文\]](http://www.microsoft.com/downloads/details.aspx?familyid=235ebc80-564b-4b52-a344-502e25aad7fe&displaylang=en)
-   Microsoft Digital Image Suite 版本 9 – [下载此更新 \[英文\]](http://www.microsoft.com/downloads/details.aspx?familyid=235ebc80-564b-4b52-a344-502e25aad7fe&displaylang=en)
-   Microsoft Office PowerPoint 的 Microsoft Producer（所有版本） – [下载此更新](http://www.microsoft.com/downloads/details.aspx?displaylang=zh-cn&familyid=1b3c76d5-fc75-4f99-94bc-784919468e73)
-   Microsoft Platform SDK Redistributable: GDI+ - [下载此更新 \[英文\]](http://www.microsoft.com/downloads/details.aspx?familyid=6a63ab9c-df12-4d41-933c-be590feaa05a&displaylang=en)

**Office 用户注意：**Office XP Service Pack 2 和 Office XP Service Pack 3 都存在此漏洞。 但是，Office XP Service Pack 2 的安全更新仅作为 Office XP 管理安全更新的一部分提供。 有关详细信息，请参见“安全更新信息”部分。 [Office 2003 Service Pack 1](http://www.microsoft.com/downloads/details.aspx?displaylang=zh-cn&familyid=9c51d3a6-7cb1-4f61-837e-5f938254fc47)、[Visio 2003 Service Pack 1](http://www.microsoft.com/downloads/details.aspx?displaylang=zh-cn&familyid=afca0578-e1fb-4540-b0cc-ff83def61cc6) 和 [Project 2003 Service Pack 1](http://www.microsoft.com/downloads/details.aspx?displaylang=zh-cn&familyid=1b04c073-e58f-4f42-b76d-6b565a45cdc3) 包含受影响组件的更新版本，因此它们不受影响。 已经安装这些 Service Pack 的客户不需要为这些产品安装可用的安全更新。 建议使用 Visio 2002 Viewer、Visio 2003 Viewer 或 PowerPoint 2003 Viewer 程序的客户阅读下列常见问题解答，以了解更多有关这些程序的信息。

**MSN 9 用户注意：**MSN 9 分发 Picture It! Express 版本 9 和 Picture It! 库。 在安装 MSN 9 时，您可以选择安装这些程序。 如果已安装 MSN 9， 只有安装了 Picture It! Express 版本 9 或 Picture It! Library 时， 才需要安装 Picture It! 版本 9 更新。

**受影响的组件：**  

-   Internet Explorer 6 Service Pack 1 - [下载此更新 (KB833989)](http://www.microsoft.com/downloads/details.aspx?displaylang=zh-cn&familyid=b0095851-674d-4357-868c-dd75d88405ec)
-   Microsoft .NET Framework 版本 1.0 Service Pack 2 – [下载此更新 (KB830348) \[更新中\]](http://www.microsoft.com/downloads/details.aspx?familyid=69703d1d-2ce3-42da-abf8-353d2121dab0) 或[下载 Microsoft .NET Framework 版本 1.0 Service Pack 3 (KB867461)](http://www.microsoft.com/downloads/details.aspx?displaylang=zh-cn&familyid=6978d761-4a92-4106-a9bc-83e78d4abc5b)
-   The Microsoft .NET Framework 版本 1.1 – [下载此更新 (KB830348)](http://www.microsoft.com/downloads/details.aspx?familyid=2a2cd786-cb0f-4946-9d76-d744683bd270) 或[下载 Microsoft .NET Framework 版本 1.1 Service Pack 1 (KB867460)](http://www.microsoft.com/downloads/details.aspx?displaylang=zh-cn&familyid=a8f5654f-088e-40b2-bbdb-a83353618b38)
-   Windows Journal Viewer – [下载此更新 (KB886179)](http://www.microsoft.com/downloads/details.aspx?displaylang=zh-cn&familyid=dbf1ea4e-72bd-4359-9f93-7c232ed2dcd3)

**不受影响的软件**  

-   Microsoft Windows NT Server 4.0 Service Pack 6a
-   Microsoft Windows NT Server 4.0 Terminal Server Edition Service Pack 6
-   Microsoft Windows 2000 Service Pack 3 和 Microsoft Windows 2000 Service Pack 4
-   Microsoft Windows XP Service Pack 2
-   Microsoft Windows 98、Microsoft Windows 98 Second Edition (SE) 和 Microsoft Windows Millennium Edition (Me)
-   Microsoft Office 2003 Service Pack 1
-   Microsoft Office 2000
-   Microsoft Visio 2003 Service Pack 1
-   Microsoft Visio 2000
-   Microsoft Project 2003 Service Pack 1
-   Microsoft Project 2000
-   Microsoft Digital Image Suite 10 和 Microsoft Digital Image Pro 10，Picture It! Premium 10
-   Microsoft .NET Framework 版本 1.1 SDK
-   Microsoft Works（所有版本）
-   Microsoft Systems Management Server（所有版本）
-   Microsoft SQL Server Reporting Services
-   Microsoft Broadband Networking

**不受影响的组件：**  

-   Windows 2000 Service Pack 3 上的 Internet Explorer 5.01 Service Pack 3
-   Windows 2000 Service Pack 4 上的 Internet Explorer 5.01 Service Pack 4
-   Windows Millennium Edition 上的 Internet Explorer 5.5 Service Pack 2
-   Microsoft .NET Framework 版本 1.0 Service Pack 3
-   Microsoft .NET Framework 版本 1.1 Service Pack 1
-   用于 Windows Server 2003 的 Microsoft .NET Framework 版本 1.1 Service Pack 1

**注意：**Windows 的不受影响版本在本机不包含容易受到攻击的组件。 但是，在安装此公告中“受影响的软件和受影响的组件”部分列出的软件程序或组件时，将会在这些不受影响的操作系统上安装容易受到攻击的组件。 有关详细信息，请参见本公告的“常见问题解答”部分。

已对此列表中的软件进行了测试，以确定这些版本是否会受到影响。 其他版本或者不再包括安全更新支持，或者可能不会受到影响。 要确定产品和版本的技术支持生命周期，请访问 [Microsoft 产品技术支持生命周期网站](http://go.microsoft.com/fwlink/?linkid=21742)。

### 一般信息

摘要
----

<span></span>
**摘要：**  

此更新可消除一个秘密报告的新发现漏洞。 在处理 JPEG 图像格式时存在[缓冲区溢出](http://go.microsoft.com/fwlink/?linkid=21142)漏洞，此漏洞可能允许在受影响的系统上远程执行代码。 此漏洞在本公告的相应章节加以说明。

如果用户使用管理权限登录，成功利用此漏洞的攻击者可以完全控制受影响的系统，包括安装程序；查看、更改或删除数据；或者创建拥有完全权限的新帐户。 其帐户被配置为拥有较少系统权限的用户比具有管理权限的用户受到的威胁要小。

Microsoft 建议用户立即应用此更新。

**严重等级和漏洞标识符：**  

| 漏洞标识符                                                                                   | 安全漏洞的影响 | Outlook（版本 2002 和 2003） | Internet Explorer 6 Service Pack 1 | Windows XP、Windows XP Service Pack 1、Windows Server 2003 | .NET Framework 1.0、Service Pack 2、.NET Framework 1.1 | 其他较早列出的受影响的软件和组件 |
|----------------------------------------------------------------------------------------------|----------------|------------------------------|------------------------------------|------------------------------------------------------------|--------------------------------------------------------|----------------------------------|
| JPEG 漏洞 - [CAN-2004-0200](http://www.cve.mitre.org/cgi-bin/cvename.cgi?name=can-2004-0200) | 远程执行代码   | 严重                         | 严重                               | 严重                                                       | 严重                                                   | 重要事项                         |

此[评估](http://go.microsoft.com/fwlink/?linkid=21140)是基于以下几点作出的：受此漏洞影响的系统类型，它们的典型部署模式，以及利用此漏洞会对它们产生什么影响。

与此安全更新相关的常见问题解答 (FAQ)
------------------------------------

<span></span>
**为什么在 2004 年 12 月 14 日更新此安全公告？**  
安全公告已被更新，通知现已发布其他信息，以便帮助您解决此漏洞：

-   现已提供单机版的 Microsoft .NET Framework 版本 1.0 Service Pack 2 和 Microsoft .NET Framework 版本 1.1。 根据客户反馈，Microsoft 创建了单机版的更新，以便帮助那些尚未部署 Microsoft .NET Framework 1.0 Service Pack 3 或 Microsoft .NET Framework 1.1 Service Pack 1 的客户解决此漏洞。 不过，Microsoft 建议客户安装最新版本的服务包，以便接收针对此漏洞以及其他相关问题的保护功能。 已经安装 Microsoft .NET Framework 版本 1.0 Service Pack 3 或 Microsoft .NET Framework version 1.1 Service Pack 1 的客户无需应用这些附加的安全更新。
-   现已提供针对 Microsoft Visual FoxPro 8.0 的安全更新。 开发人员应使用 Microsoft Visual FoxPro 8.0 更新来更新他们的开发环境。 分发使用 Microsoft Visual FoxPro 8.0 并包括含有漏洞的 gdiplus.dll 文件副本开发的自定义运行时应用程序的开发人员应评估是否需要部署针对 Microsoft Visual FoxPro 8.0 Runtime Library 的安全更新。
-   Windows Messenger 5.0 分发了一个含有漏洞的 gdiplus.dll 文件版本的副本。 不过，由于它不易受到任何已知的或可能的攻击媒介的攻击，因此它不被视为此问题的漏洞。 但是，如果客户担心存在此文件可能会使以后的攻击媒介将其找到，则应升级至 Windows Messenger 5.1。 Windows Messenger 5.1 含有最新版本的 gdiplus.dll 文件，并且是建议使用的 Windows Messenger 版本。 Windows Messenger 5.1 可从以下站点下载。

MS04-028 Enterprise Update Scanning 工具已被更新，可检测和部署单机版的 Microsoft .NET Framework 版本 1.0 Service Pack 2 和 Microsoft .NET Framework 版本 1.1 以及 Microsoft Visual FoxPro 8.0 和 Microsoft Visual FoxPro 8.0 Runtime 安全更新。 此工具的现有版本支持检测和部署 Microsoft .NET Framework 版本 1.0 Service Pack 3 和 Microsoft .NET Framework 版本 1.1 Service Pack 1。 现已提供单机版的安全更新，并且此工具已被更新为使用单机版的更新，而不再使用服务包更新。 喜欢此服务包更新支持的客户应继续使用此工具的现有版本。 由于 Windows Messenger 不被视为任何已知的或可能的攻击媒介的漏洞，因此它不会被包括到此更新中。 有关 MS04-028 Enterprise Update Scanning 工具的详细信息，请参见 Microsoft 知识库文章 [886988](http://support.microsoft.com/default.aspx?id=886988)。

**为什么在 2004 年 10 月 12 日更新此安全公告？**  
Microsoft 知识库文章 [833987](http://support.microsoft.com/default.aspx?scid=kb;zh-cn;833987) 介绍了客户在安装此安全更新时可能遇到的当前已知的问题。 这篇文章还介绍了这些问题的建议解决办法。 有关详细信息，请参见 Microsoft 知识库文章 [833987](http://support.microsoft.com/default.aspx?scid=kb;zh-cn;833987)。

在发布 MS04-028 安全公告后，Microsoft 意识到一个影响客户在基于 Windows XP Service Pack 2 的系统上部署 Office XP、Visio 2002 和 Project 2002 更新的问题。 在某些情况下，此问题使安全更新看起来像是已正确安装，但事实上并未正确安装。 此问题是由安全更新中使用的安装程序引起的。 有关此问题的技术上的更多详细信息，以及可能导致安装失败的特定条件，请参阅 Microsoft 知识库文章 [885876](http://support.microsoft.com/default.aspx?scid=kb;zh-cn;885876)。

请注意，Windows XP Service Pack 2 现已包含能够解决操作系统附带的 JPEG Parsing Engine 中漏洞的安全更新。 不过，客户仍需成功应用针对 Office XP、Visio 2002 和 Project 2002 的安全更新，以防在使用这些应用程序时此漏洞受到攻击。

Microsoft 研究过此问题，并且为这些应用程序提供经过修订的安全更新，以帮助确保可以在基于 Windows XP Service Pack 2 的系统上成功地进行安装。 这些修订后的安全更新可以从 Office Update 和 Microsoft 下载中心获取。 对于尚未应用这些原版更新的客户，应该访问 Office Update 以接收已修订的更新。 对于尚未应用这些原版更新的企业客户，应该使用“受影响的软件”安全公告中提供的下载链接从 Microsoft 下载中心获取已修订的更新。

对于已应用原始 Office XP、Visio 2002 和 Project 2002 更新的客户，以及使用 Windows XP Service Pack 2 的客户，以下任一步骤都将纠正此问题且正确应用更新：

-   对于在 Windows XP Service Pack 2 中启用“自动更新”的客户，Microsoft 已通过 Windows Update 提供更新的安装软件包，该软件包将纠正安装问题并安装正确的文件。 由于 Windows XP Service Pack 2 建议和提示客户打开“自动更新”，因此大多数 Windows XP Service Pack 2 用户将无需执行其他步骤。 此已更新的安装软件包在 Microsoft 知识库文章 [885884](http://support.microsoft.com/default.aspx?scid=kb;zh-cn;885884) 中进行了介绍。
-   访问 Office Update 以获取已修订的更新。 Office update 将检测系统上的漏洞，并使用安装程序软件的已修订版本进行更新。
-   企业客户应该从 Microsoft 下载中心获取已修订的安全更新，并对运行 Windows XP Service Pack 2 的客户机重新部署这些更新。
-   客户可使用受影响的应用程序内的“检测并修复”功能。 此过程将成功安装帮助防止漏洞所需的受影响文件的正确版本。 有关使用手动“检测并修复”功能的更多信息，请参见 Microsoft 知识库文章 [821593](http://support.microsoft.com/?id=821593)

Microsoft 还将 Windows Journal Viewer 识别为受此安全漏洞的影响，并已发布基于 Windows 2000 系统的更新。 请参见以下 FAQ，以获取有关用于基于 Windows 2000 的系统的 Windows Journal Viewer 的更新的详细信息。

作为此更新的一部分，Microsoft 还发布了 MS04-028 Enterprise Update Scanning 工具。 查看此已更新的安全公告中的“MS04-028 Enterprise Update Scanning 工具 FAQ”，以获取详细信息。

**为什么 Microsoft 在 2004 年 10 月 12 日发布 Windows Journal Viewer 的更新？**  
对于没有正在运行 Windows XP Tablet PC Edition 的系统的用户，Windows Journal Viewer 使其可以在 Tablet PC 上查看 Windows Journal 中创建的文件。 Windows Journal Viewer 在此公告中所述的安全漏洞上容易受到攻击。 但是，在基于 Windows XP 的系统上使用时，Windows Journal Viewer 会使用操作系统提供的受影响组件的版本。 当在基于 Windows XP 和 Windows XP Service Pack 1 的系统上应用 Windows XP 操作系统更新时，Windows Journal Viewer 在此问题上将不再容易受到攻击。 由于 dows XP Service Pack 2 在此问题上不易受到攻击，因此在基于 Windows XP Service Pack 2 的系统上使用 Windows Journal Viewer 时，在此问题上也不易受到攻击。 我们现已发布 Windows Journal Viewer 的安全更新，这将有助于保护可能安装了 Windows Journal Viewer 的基于 Windows 2000 的系统。

即使已在 Windows 2000 上安装所有前面可用的安全更新，但如果安装了 Windows Journal Viewer，您也仍然务必要安装此安全更新。 Windows Update 将仅为已安装 Windows Journal Viewer 的基于 Windows 2000 的系统提供此更新。 如果您要使用 Windows XP，或者尚未在 Windows 2000 上安装 Windows Journal Viewer，则不需要此安全更新。 此程序在 Windows Server 2003 上不受支持。 但是，如果它安装在 Windows Server 2003 上，它还是会使用含有容易受到攻击的组件的操作系统版本。 如果在 Windows Server 2003 上使用此程序，确保安装 Windows Server 2003 安全更新。

**什么是 GDI+？**  
GDI+ 是一种图形设备接口，能够为应用程序和程序员提供二维矢量图形、映像和版式。

**为什么会有几种受影响的程序和组件？**  
Windows XP、Windows XP Service Pack 1 和 Windows Server 2003 提供的操作系统版本含有容易受该问题攻击的组件。 Windows 的较早版本提供的操作系统不含有此组件。 因此，在 Windows 的较早版本上安装需要此功能的程序时，通常安装此组件。 通常，将这些程序安装到 Windows XP、Windows XP Service Pack 1 或 Windows Server 2003 上时，即使安装了一份容易受到攻击的组件，也只能使用操作系统提供的版本。

Office XP、Visio 2002、Project 2002、Office 2003、Visio 2003 和 Project 2003 例外。 为了帮助确保 JPEG 图像在所有的操作系统上都能得到一致的处理，这些程序都使用自已版本的容易受到攻击的组件。 容易受到攻击的组件的此版本安装在这些程序支持的所有操作系统上。 如果已经安装了这些程序，则必须安装这些程序的更新。 如果使用 Windows XP、Windows XP Service Pack 1 或 Windows Server 2003，则还必须安装操作系统更新。 同时，请查看以下与应用程序开发人员和第三方应用程序异常相关的 FAQ 问题。

**如果我使用 Windows XP Service Pack 2 和任何受影响的软件，我应该怎么做？**  
Windows XP Service Pack 2 不包含受影响组件的容易受攻击的版本。 但如果已经安装了任何受影响的 Office、Visio 或 Project 应用程序，则应该为这些应用程序安装更新。 解决漏洞的最简单方法是安装 [Office Update](http://go.microsoft.com/fwlink/?linkid=21135) 提供的更新。 如果您尚未安装任何受影响的 Office、Visio 或 Project 应用程序，则无需安装任何其他安全更新，因为其他受影响的软件和组件使用的是 Windows XP Service Pack 2 上容易受攻击组件的操作系统版本。 但是，请查看以下与应用程序开发人员和第三方应用程序异常相关的 FAQ 问题。 跟前面的 FAQ 中说明的一样，在某些情况下，原版的 Office、Visio 和 Project 安全更新可能并未正确安装。 有关详细信息，请参见 Microsoft 知识库文章 [833987](http://support.microsoft.com/default.aspx?scid=kb;zh-cn;833987)。

**如果我使用 Windows XP、Windows XP Service Pack 1 或 Windows Server 2003，并使用任何受到影响的软件，我应该怎么做？**  
如果已经安装了任何受到影响的 Office、Visio 或 Project 应用程序，解决漏洞的最简单方法是安装 [Windows Update](http://go.microsoft.com/fwlink/?linkid=21130) 和 [Office Update](http://go.microsoft.com/fwlink/?linkid=21135) 提供的更新。 如果没有安装任何受到影响的 Office、Visio 或 Project 应用程序，解决漏洞的最简单方法是安装 [Windows Update](http://go.microsoft.com/fwlink/?linkid=21130) 提供的更新。 由于其他受影响的软件和组件在 Windows XP 和 Windows Server 2003 上使用该操作系统版本的组件，因此您不必安装任何其他安全更新。 但是，请查看以下与应用程序开发人员和第三方应用程序异常相关的 FAQ 问题。

**如果我使用 Windows 98、Windows 98 Second Edition (SE)、Windows Millennium 版 (Me)、Windows NT 4.0 或 Windows 2000，我应该怎么做？**  
默认情况下，这些操作系统本身并不提供易受攻击的组件版本，因此不会受到影响。 但是，在安装此公告中“受影响的软件和受影响的组件”部分列出的软件程序或组件时，将会在这些不受影响的操作系统上安装容易受到攻击的组件。

但如果已经安装了任何受影响的程序和组件，则应该为那些程序和组件安装需要的安全更新。 例如，如果在 Windows 2000 系统上安装 Internet Explorer 6 Service Pack 1 和 Office XP，则必须安装 Internet Explorer 6 Service Pack 1 安全更新和 Office XP 安全更新。 如果没有安装任何受影响的程序或组件，则不必安装任何安全更新。

**如果我使用的 Internet Explorer 版本早于 Internet Explorer 6 Service Pack 1，我的计算机是否容易受到此问题的攻击？**  
已经对 Windows 2000 上的 Internet Explorer 5.01 Service Pack 3 和 Internet Explorer 5.01 Service Pack 4，以及 Windows Me 上的 Internet Explorer 5.5 Service Pack 2 进行测试，证明它们不容易受到攻击。

仅 Windows XP、Windows XP Service Pack 1 和 Windows Server 2003 支持 Internet Explorer 6。 Windows XP、Windows XP Service Pack 1 和 Windows Server 2003 上的 Internet Explorer 6 使用易受攻击的组件的操作系统版本。 在安装了 Windows XP、Windows XP Service Pack 1 和 Windows Server 2003 操作系统更新后，Internet Explorer 6 不容易受到攻击。 Windows XP Service Pack 2 包括 Internet Explorer 6 Service Pack 2 并且不容易受到此问题攻击。 Internet Explorer 6 不再受其他操作系统支持，并且在那些操作系统上可能容易受到此问题攻击。 没有使用 Windows XP、Windows XP Service Pack 1 或 Windows Server 2003 的客户，以及使用的 Internet Explorer 6 版本早于 Internet Explorer 6 Service Pack 1 的客户应该升级到 Internet Explorer 6 Service Pack 1，然后安装此安全公告中提供的 Internet Explorer 6 Service Pack 1 安全更新。对于 Windows XP 客户，可升级到 [Windows XP Service Pack 2](http://www.microsoft.com/windowsxp/sp2/default.mspx)。 要安装 Internet Explorer 6 Service Pack 1，请访问以下 [Web 站点](http://www.microsoft.com/windows/ie/downloads/critical/ie6sp1/default.asp)。 有关 Internet Explorer 的技术支持周期的详细信息，请访问以下 [Microsoft 产品技术支持周期 Web 站点](http://go.microsoft.com/fwlink/?linkid=21742)。

**如果我使用分发 gdiplus.dll 文件的第三方应用程序，则在我安装全部必需的 Microsoft 安全更新后仍然会容易受到攻击吗？**  
是。 在一些情况下，即使安装了必需的操作系统更新和此公告的“受影响软件和受影响组件”部分列出的程序或组件的更新，在此问题上仍可能容易受到攻击。
如果 Gdiplus.dll 文件安装在系统上，则您可能必须安装用于此程序的更新。 由于可能不使用 Gdiplus.dll 文件来处理 JPEG 图像，因此并非安装此文件的每个程序都在此问题上容易受到攻击。 即使第三方应用程序使用 Gdiplus.dll 文件处理 JPEG 图像，它仍然可能不会容易受到攻击。 例如，如果应用程序不允许用户提供要处理的图像或在处理前对图像执行其他验证，则它可能不容易受到攻击。 但是，只有此程序的制造商能作出确定。 这可能包括但不限于第三方应用程序（使用 Visual Studio .NET 2002、Visual Studio .NET 2003 或 Microsoft .NET Framework 1.0 SDK Service Pack 2 开发）。
此外，Windows XP 和 Windows Server 2003 提供了其他方法帮助安全应用程序。 这些操作系统提供了某个操作系统版本的受影响组件，并且可以集中进行保护。 这意味着大多数情况下，即使应用程序安装了某个版本的 Gdiplus.dll 文件，应用程序仍将使用操作系统提供的版本。 当您安装相应的操作系统更新时会更新该操作系统版本的 Gdiplus.dll 文件，且将保护大多数应用程序免受此漏洞的影响。

但是，开发人员或管理员可能会强制应用程序绕过操作系统提供的 Gdiplus.dll 文件版本，而使用他们所提供的版本。 应用程序开发人员有多种方法可以设计他们的应用程序，以便不使用该操作系统版本的组件。 他们可能会显式调用他们所提供的某个版本的组件，或可能使用同时绕过功能来调用该版本的受影响组件。 在大多数情况下，不可能使用这一功能。 但是，如果验证他们的程序使用了任何类型的绕过功能，您可能需要考虑与第三方应用程序制造商联系，以获取其程序的更新版本。 可在 Microsoft 知识库文章 [835322](http://support.microsoft.com/default.aspx?scid=kb;zh-cn;835322) 中找到有关确定应用程序是否使用了同时绕过功能的步骤。 要确定您的应用程序是否显式调用了它们提供的组件版本，我们建议您与应用程序制造商联系。 请注意，一般情况下极少使用这些类型的功能，而且我们建议您不要使用它们。 有关详细信息，请参见 [MSDN Web 站点](http://msdn.microsoft.com/library/default.asp?url=/library/en-us/dnsecure/html/gdiplus10security.asp)

此外，在这些情况下，当使用受到影响的程序来处理图像时，您在此问题上可能会容易受到攻击。 安装操作系统更新和此公告中列出的受影响程序和组件的更新有助于减少来自最常见攻击源的攻击机会。攻击者经常使用这些攻击源来利用漏洞。

另请注意，如有可能，您应该安装可用的安全更新，而不是手动更新受到影响的组件。 手动更新受到影响的组件可能会造成应用程序的兼容性问题，且不受支持。 另外，如果手动更新受到影响的组件，则具有“检测并修复”功能的应用程序将不能接收到用来防止这些功能部件在执行时可能引起漏洞所需的必要信息。

**如果我是一名开发人员，使用 Visual Studio .NET 2002、Visual Studio .NET 2003、Microsoft .NET Framework 1.0 SDK Service Pack 2 或 Microsoft Platform SDK Redistributable: GDI+ 来开发应用程序，那么应该怎么做？**  

当这些程序安装在 Windows XP、Windows XP Service Pack 1 或 Windows Server 2003 上时，它们使用容易受攻击的组件的操作系统版本。 如果您在 Windows XP、Windows XP Service Pack 1 或 Windows Server 2003 上使用这些程序，确保安装了安全更新的操作系统版本。 如果在其他操作系统上使用这些程序，确保为这些程序安装更新。

但是，如果您使用这些程序创建分发某个版本的 Gdiplus.dll 文件的应用程序，即使已安装可用的操作系统更新或正在使用 Windows XP Service Pack 2，您仍然需要基于所使用的开发工具安装适当的安全更新。 如果使用 Gdiplus.dll 文件来处理 JPEG，则应考虑更新您的应用程序，以使用更新版本的 Gdiplus.dll 文件。 但是，正如前面 FAQ 提到的一样，您的应用程序在此问题上不容易直接遭受攻击。 此外，您应该确保不使用前面 FAQ 中提到的绕过功能，它可能会引起应用程序中出现漏洞。

**我可以手动进行脚本编制并部署所需的安全更新吗？**  
是。 我们已发布 Microsoft 知识库文章 [885885](http://support.microsoft.com/?kbid=885885)，它将有助于您手动安装某些可用的安全更新。 本文章不提供有关安装所有可用安全更新的说明，而是仅作为创建自定义脚本的指南提供。

**为什么 Microsoft .NET Framework 1.0 和 Microsoft .NET Framework 1.1 安全更新最初会以 Service Pack 提供？**  

此问题不影响部署了 Microsoft .NET Framework 1.0 Service pack 3 (SP3) 和 Microsoft .NET Framework 1.1 Service Pack 1 (SP1) 的客户。 这些 service pack 在此安全公告之前发布，它已包含针对此问题的安全更新以及发行这些软件组件后客户报告的所有问题的其他安全更改。 因此，我们强烈建议使用 Microsoft .NET Framework 1.0 或 Microsoft .NET Framework 1.1 的客户安装这些 Service Pack，它不仅可以增强安全性以防止出现漏洞，还可以解决发行 Microsoft .NET Framework 后客户报告的所有问题。

**可否使用 Microsoft Baseline Security Analyzer (MBSA) 确定是否需要此更新？**  
MBSA 通过扫描本地计算机，能够检测到 Office XP、Office 2003、Project 2002、Project 2003、Visio 2002 和 Visio 2003 是否需要针对此漏洞的更新。 有关 MBSA 如何检测 Office update 的详细信息，请访问下列 [Web 站点](http://go.microsoft.com/fwlink/?linkid=19025)。 MBSA 会显示一个注释，指示需要哪些操作系统更新。 但是，MBSA 目前不支持检测此安全公告的“受影响的软件和组件”部分中列出的若干程序。 有关 MBSA 当前不检测的程序的详细信息，请参见 Microsoft 知识库文章 [306460](http://support.microsoft.com/default.aspx?scid=kb;zh-cn;306460)。 如果您安装了此安全公告的“受影响的软件和组件”部分中列出的任何程序，那么可能需要手动确定是否需要安装所需的更新。 例如，已经安装 Internet Explorer 6 Service Pack 1 的 Windows 2000 或 Windows NT 4.0 系统需要安装 Internet Explorer 6 Service Pack 1 安全更新，而 MBSA 不能检测出这些配置中缺少的更新。 同样，MBSA 不能使用 Office Detection 工具来扫描远程系统，只能使用此工具来扫描本地系统上所需的安全更新。 有关 MBSA 的详细信息，请访问 [MBSA 网站](http://go.microsoft.com/fwlink/?linkid=21134)。

**注意：**在 2004 年 4 月 20 日以后，将不再使用新的安全公告数据来更新 MBSA 1.1.1 及更早版本所使用的 Mssecure.xml 文件。 因此，该日期后使用 MBSA 1.1.1 或更早版本所进行的扫描将是不完整的。 所有用户都应升级到 MBSA 1.2，因为该版本提供更准确的安全更新检测，并支持其他的产品。 用户可以从 [MBSA 网站](http://go.microsoft.com/fwlink/?linkid=21134)下载 MBSA 1.2。 有关 MBSA 支持的详细信息，请访问 [Microsoft 基准安全分析器](http://www.microsoft.com/technet/security/tools/mbsaqa.mspx)[1.2 问题与解答 Web 站点](http://www.microsoft.com/technet/security/tools/mbsaqa.mspx)</a>。

**可否使用 Systems Management Server (SMS) 确定是否需要此更新？**  
是。 SMS 可以帮助您检测和部署此安全更新。 有关 SMS 的信息，请访问 [SMS 网站](http://go.microsoft.com/fwlink/?linkid=21158)。 SMS 使用 MBSA 进行检测；因此，SMS 具有本公告前面所列的与 MBSA 不检测的程序有关的相同限制。 但是，SMS 还能够使用 Microsoft Office 清单工具检测 Microsoft Office 组件所需的更新。

**可否使用 SMS 确定是否安装了必须更新的程序？**  
是。 SMS 可以帮助您检测是否安装了受影响的程序和组件，而这些程序和组件安装了容易受到攻击的组件版本。 SMS 可以搜索文件 Gdiplus.dll 是否存在。 对于此公告中列出的受影响的程序和组件，可能需要更新版本 5.1.3102.1355 之前的所有 Gdiplus.dll 版本或以下 FAQ 中确定为容易受到攻击的受影响应用程序所使用的版本。 参见此公告中“如果我使用分发 gdiplus.dll 文件的第三方应用程序，则在我安装全部必需的 Microsoft 安全更新后仍然会容易受到攻击吗？”FAQ，以获取有关可能已安装 Gdiplus.dll 文件的其他应用程序的详细信息。
但是，请注意，您应该安装可用的安全更新，而不是手动更新受到影响的组件。 手动更新受到影响的组件可能会造成应用程序的兼容性问题，且不受支持。 另外，如果手动更新受到影响的组件，则具有“检测并修复”功能的应用程序将不能接收到用来防止这些功能部件在执行时可能引起漏洞所需的必要信息。

Office XP、Visio 2002、Project 2002 和 Internet Explorer 6 Service Pack 1 (SP1) 的安装将容易受攻击的组件的功能与其他文件相结合。 对于 Office XP 和 Project 2002，还应该搜索 Mso.dll 文件是否存在。 Mso.dll 的更新版本早于受影响的应用程序正在使用的版本 10.0.6714.0。 对于 Visio 2002，由于 Visio 2002 分发 Mso.dll 文件和 Gdiplus.dll，必须搜索这两个 文件是否存在；而 Windows XP 或 Windows Server 2003 例外，只分发 Mso.dll 文件。

对于不在 Windows XP 或 Windows Server 2003 操作系统上运行的 Internet Explorer 6 Service Pack 1，搜索 Vgx.dll 文件。 更新早于版本 6.0.2800.1411 的所有 Vgx.dll 版本。 Internet Explorer 6 Service Pack 1 在 Windows XP 和 Windows Server 2003 上使用容易受到攻击的组件的操作系统版本。 对于那些操作系统，不必更新 Internet Explorer 6 Service Pack 1。 这些 .dll 文件记录在此安全公告的“安全更新信息”部分。 您还可以使用 SMS 的[清单和软件分发](http://www.microsoft.com/technet/prodtechnol/sms/sms2003/patchupdate.mspx)功能，部署公告提供的更新。

**哪个版本的 Gdiplus.dll 文件可能会导致应用程序变得容易受到攻击？**  
切记，存在 Gdiplus.dll 文件并不能确定应用程序在此问题上是否容易受到攻击。 前面的 FAQ 可用来帮助您确定是否在将 Gdiplus.dll 文件作为容易受到攻击的应用程序的一部分使用。 作为帮助管理员和开发人员确定是否在使用某个版本的 Gdiplus.dll 文件（可能会使其应用程序在此问题上变得容易受到攻击）的通用指南，我们创建了以下 Gdiplus.dll 文件信息表。

| Gdiplus.dll 文件版本                | State          | 一般说明                                                                                                                                                                         |
|-------------------------------------|----------------|----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
| 所有 5.1.3102.1355 之前的版本       | 容易受到攻击   | 包括 Windows XP、Windows XP Service Pack 1 和大多数重新分发此文件的第三方应用程序。                                                                                              |
| 5.1.3102.1355                       | 不容易受到攻击 | 作为此安全公告的一部分提供。                                                                                                                                                     |
| 5.1.3102.1360                       | 不容易受到攻击 | 作为此安全公告的一部分提供。                                                                                                                                                     |
| 版本 5.1.3102.2000 到 5.1.3102.2179 | 不受支持       | 这些版本作为早期 Windows XP Service Pack 2 Beta 版的一部分提供，但不受支持。 客户应该升级到已发布的 Windows XP Service Pack 2 版本。 这些 Gdiplus.dll 文件版本通常不对公众发行。 |
| 5.1.3102.2180                       | 不容易受到攻击 | 随 Windows XP Service Pack 2 附带提供。                                                                                                                                          |
| 5.2.3790.0                          | 容易受到攻击   | 随 Windows Server 2003 附带提供。                                                                                                                                                |
| 5.2.3790.136                        | 不容易受到攻击 | 作为此安全公告的一部分提供。                                                                                                                                                     |
| 6.0.3260.0                          | 容易受到攻击   | 随 Office 2003、Visio 2003 和 Project 2003 附带提供。                                                                                                                            |
| 版本 6.0.3264.0 及更高版本。        | 不容易受到攻击 | 作为此安全公告的一部分提供。                                                                                                                                                     |

**Microsoft 已发行 MS04-028 Enterprise Update Scanning 工具，它将协助企业客户检测是否在运行一个或多个受影响的产品和组件，并帮助部署可用的安全更新。 我可以从哪里获得有关此工具的详细信息？**  
为了进一步帮助企业客户解决因受影响的产品和组件数而造成 MS04-28 独特的部署复杂性问题，Microsoft 发布了扫描工具和指导说明，它使系统管理员可以扫描其网络上的计算机，以确定是否存在本安全公告的“受影响的软件和组件”部分列出的软件，并自动应用相应的 MS04-028 更新。 该工具也可与 Microsoft System Management Server (SMS) 一起配合使用。 有关 MS04-028 Enterprise Update Scanning 工具的详细信息，请参见 Microsoft 知识库文章 [886988](http://support.microsoft.com/default.aspx?id=886988)。 此工具不支持 Windows Journal Viewer 安全更新。

**Microsoft 为用户发布了 GDI+ Detection 工具，它还将帮助您检测是否在运行一个或多个受影响的产品和组件。 我可以从哪里获得有关此工具的详细信息？**  

Microsoft 创建了 GDI+ Detection 工具，以帮助用户检测是否在运行一个或多个受影响的软件版本，该受影响的软件版本在本安全公告（包含其系统上容易受到攻击的版本的 JPEG 分析组件）的“受影响的软件和组件”部分中列出。 Microsoft 知识库文章 [873374](http://support.microsoft.com/default.aspx?scid=kb;zh-cn;873374) 介绍了此工具，并提供如何下载工具的说明。 此工具尚未更新，不支持 Windows Journal Viewer 安全更新。

**GDI+ Detection 工具有什么功能？**  

GDI+ Detection 工具会扫描您的系统，以获取在此安全公告的“受影响的软件和组件”部分（我们知道它包含容易受到攻击的组件）中列出的非操作系统软件。 然后它将用户定向到适当的位置，下载更新来解决漏洞。

**如果我的系统存在漏洞的风险，GDI+ Detection 工具是否会告诉我？**  

否。 此工具仅设计用来扫描系统并检测是否存在此安全公告的“受影响的软件和组件”部分（我们知道它包含容易受到攻击的组件）中列出的软件。 此工具不能确定这些产品是否已经更新为使用受影响组件的安全版本。

**我使用软件更新服务 (SUS) 在企业中部署安全更新。 我是否应该在所有系统中部署 GDI+ Detection 工具？**  

GDI+ Detection 工具以前是通过 SUS 获得的，但该工具现在已经给删除了。 此工具未设计用于在企业环境中使用或受支持。

**Windows Update 提供哪些安全更新来帮助解决漏洞？**  
[Windows Update](http://go.microsoft.com/fwlink/?linkid=21130) 为 Windows XP、Windows XP Service Pack 1 和 Windows Server 2003 提供需要的操作系统更新。 由于 Windows XP Service Pack 2 不包含受影响组件的容易受攻击的版本，它不需要更新。 Windows Update 为 Windows 98、Windows 98 SE、Windows Me、Windows NT 4.0 和 Windows 2000 操作系统提供 Internet Explorer 6 Service Pack 1 安全更新。 Windows Update 为 Windows NT 4.0 和 Windows 2000 操作系统提供 .NET Framework 版本 1.0 Service Pack 3 (SP3) 和 .NET Framework 版本 1.1 Service Pack 1。 Windows Update 仅为安装了 Windows Journal Viewer 的基于 Windows 2000 的系统提供用于 Windows Journal Viewer 的更新。 没有为 Windows XP 或 Windows Server 2003 系统提供这些安全更新，原因是这些操作系统组件和应用程序在 Window XP 和 Windows Server 2003 上使用该操作系统版本的受影响组件。

跟前面的 FAQ 中说明的一样，在某些情况下，当使用 Windows XP Service Pack 2 时，可能尚未正确安装原版的 Office XP、Visio 2002 和 Project 2002 安全更新。 对于这些 Windows XP Service Pack 2 客户，Microsoft 通过 Windows Update 提供了更新的安装软件包，它会纠正安装问题并安装正确的文件。 由于 Windows XP Service Pack 2 建议和提示客户打开“自动更新”，因此大多数 Windows XP Service Pack 2 用户将无需执行其他步骤。 此已更新的安装软件包在 Microsoft 知识库文章 [885884](http://support.microsoft.com/default.aspx?scid=kb;zh-cn;885884) 中进行了介绍。

**Office Update 提供哪些安全更新来帮助解决漏洞？**  
[**Office Update**](http://go.microsoft.com/fwlink/?linkid=21135) 为 Office XP、Office 2003、Project 2002、Project 2003、Visio 2002 和 Visio 2003 提供需要的更新。 安装这些产品的所有操作系统都需要这些更新。 [Office 2003 Service Pack 1](http://www.microsoft.com/downloads/details.aspx?familyid=9c51d3a6-7cb1-4f61-837e-5f938254fc47&displaylang=en)、[Visio 2003 Service Pack 1](http://www.microsoft.com/downloads/details.aspx?familyid=afca0578-e1fb-4540-b0cc-ff83def61cc6&displaylang=en) 和 [Project 2003 Service Pack 1](http://www.microsoft.com/downloads/details.aspx?familyid=1b04c073-e58f-4f42-b76d-6b565a45cdc3&displaylang=en) 不会受到影响，因此会提供给使用 Office 2003、Project 2003 和 Visio 2003 的客户，而无需单个更新。 已经安装这些 Service Pack 的客户不会因应用程序的易受攻击而受到影响。

**哪些更新不能通过 Windows Update 或 Office Update 提供来帮助解决漏洞，而需要手动安装**  
[Windows Update](http://go.microsoft.com/fwlink/?linkid=21130) 和 [Office Update](http://go.microsoft.com/fwlink/?linkid=21135) 不提供对剩余程序的支持。 这包括 Visual Studio .NET 2002（和所有包括的程序）、Visual Studio .NET 2003（和所有包括的程序）、Greetings 2002、Picture It! （所有版本）、Digital Image（所有版本）、Microsoft .NET Framework 版本 1.0 SDK Service Pack 2、Microsoft .NET Framework 版本 1.0 Service Pack 2 单机版安全更新、Microsoft .NET Framework 版本 1.1 单机版安全更新、Producer for Microsoft Office PowerPoint（所有版本）以及 Platform SDK Redistributable：GDI+。 安装这些产品的 Windows 98、Windows 98 SE、Windows Me、Windows NT 4.0 和 Windows 2000 操作系统需要这些安全更新。 **注意：** Visual Studio .NET 2002 Enterprise Architect 和 Visual Studio .NET 2003 Enterprise Architect 包括 Visio 2002。 Office Update 支持 Visio 2002。

**Visio 2002 Viewer、Visio 2003 Viewer 和 PowerPoint 2003 Viewer 程序是否受此漏洞的影响？**  
较早版本的 Visio 2002 Viewer、Visio 2003 Viewer 和 PowerPoint 2003 Viewer 程序会受此漏洞影响。 我们不提供这些程序的安全更新支持。 但是，最新版本的 [Visio 2002 Viewer](http://www.microsoft.com/downloads/details.aspx?familyid=8fad9237-c0a7-4b80-a5df-46ce54dad2df)、[Visio 2003 Viewer](http://www.microsoft.com/downloads/details.aspx?familyid=3fb3bd5c-fed1-46cf-bd53-da23635ab2df) 和 [PowerPoint 2003 Viewer](http://www.microsoft.com/downloads/details.aspx?familyid=428d5727-43ab-4f24-90b7-a94784af71a4) 程序不受此漏洞影响。 建议客户安装这些程序的最新版本。

漏洞详细资料
------------

<span></span>
#### JPEG 漏洞 - CAN-2004-0200

在处理 JPEG 图像格式时存在[缓冲区溢出](http://technet.microsoft.com/security/bulletin/glossary)漏洞，此漏洞可能允许在受影响的系统上远程执行代码。 任何在受影响系统上处理 JPEG 图像的程序均容易受到此类攻击，并且使用受影响程序或组件的任何系统都容易受到此类攻击。 成功利用此漏洞的攻击者可以完全控制受影响的系统。

#### JPEG 漏洞 - CAN-2004-0200 的缓解因素：

-   成功利用此漏洞的攻击者只能获得与用户相同的权限。 其帐户被配置为拥有较少系统权限的用户比具有管理权限的用户受到的威胁要小。
-   攻击者只有通过诱使用户打开特制的文件或查看包含特制图像的目录，才能利用此漏洞。 攻击者没有任何办法强迫用户打开恶意文件。
-   在基于 Web 的攻击中，攻击者必须拥有一个网站，并在上面放置用来利用此漏洞的网页。 攻击者无法强迫用户访问恶意网站。 相反，攻击者必须劝诱用户访问该网站，通常是让用户单击通向攻击者站点的链接。
-   仅 Windows XP、Window XP Service Pack 1 和 Windows Server 2003 是在默认情况下包括容易受攻击的组件的操作系统。 默认情况下，Windows 98、Windows 98 SE、Windows Me、Windows NT 4.0、Windows 2000 和 Windows XP Service Pack 2 在此问题上不容易受到攻击。 但是，可以通过此公告的受影响软件部分列出的任何程序来将受影响组件安装到这些操作系统上，因此应该为这些程序安装相应的安全更新。

#### JPEG 漏洞 - CAN-2004-0200 的变通办法：

Microsoft 已测试过以下变通办法。 尽管这些变通办法不能从根本上消除此漏洞，但它们有助于阻塞已知的攻击媒介。 如果某种变通办法导致功能下降，在下面将进行说明。

**如果您使用的是 Outlook 2002 或更高版本，或者使用的是 Outlook Express 6 SP1 或更高版本，请用纯文本格式阅读电子邮件，以帮助保护自己免受来自 HTML 电子邮件攻击媒介的攻击。**  

已应用了 Office XP Service Pack 1 或更高版本的 Microsoft Outlook 2002 用户以及应用了 Internet Explorer 6 Service Pack 1 的 Microsoft Outlook Express 6 用户可以启用此设置，仅用纯文本格式查看所有不带数字签名的电子邮件或未加密的电子邮件。

带数字签名的电子邮件或加密的电子邮件不受此设置的影响，可以用其原始格式阅读。 有关在 Outlook 2002 中启用此设置的详细信息，请参见 Microsoft 知识库文章 [307594](http://support.microsoft.com/default.aspx?scid=kb;zh-cn;307594)。

有关 Outlook Express 6 中此设置的信息，请参见 Microsoft 知识库文章 [291387](http://support.microsoft.com/?kbid=291387)。

**变通办法的影响：**用纯文本格式查看的电子邮件中不会包含图片、特殊字体、动画或其他丰富内容。 此外：

-   这些变化适用于预览窗格和打开的邮件。
-   图片变成了附件，因此不会丢失。 **注意** 如果正在使用容易受攻击的应用程序或操作系统，手动查看这些图片可能允许执行远程代码。
-   由于存储区中的邮件仍然是 RTF 格式或 HTML 格式，因此对象模型（自定义代码解决方案）可能不按预期方式运行。

#### JPEG 漏洞 - CAN-2004-0200 常见问题解答：

**此漏洞的影响范围有多大？**  
这是一个[缓冲溢出](http://go.microsoft.com/fwlink/?linkid=21141)漏洞。 如果用户使用管理权限登录，成功利用此漏洞的攻击者可以完全控制受影响的系统，包括安装程序；查看、更改或删除数据；或者创建拥有完全权限的新帐户。 其帐户被配置为拥有较少系统权限的用户比具有管理权限的用户受到的威胁要小。

**造成漏洞的原因是什么？**  
JPEG 图像处理中的未检查缓冲区。

**JPEG 图像是什么？**  
JPEG 是与平台无关的图像格式，支持高程度的压缩。 JPEG 是广泛支持的 Internet 标准，由联合图像专家小组开发。

**攻击者可能利用此漏洞执行什么操作？**  
成功利用此漏洞的攻击者可以完全控制受影响的系统，包括：安装程序；查看、更改或删除数据；或者创建拥有完全权限的新帐户等。

**攻击者如何利用此漏洞？**  
任何处理 JPEG 图像的程序都可能容易受到攻击。 下面是一些示例：

-   攻击者可能拥有一个旨在通过 Internet Explorer 6 利用此漏洞的恶意 Web 站点，然后诱使用户查看这个 Web 站点。
-   攻击者还可能创建一个夹带了特制图像的 HTML 电子邮件。 特制图像可以设计为通过 Outlook 2002 或 Outlook Express 6 利用此漏洞。 攻击者可能诱使用户查看或预览该 HTML 电子邮件。
-   攻击者可能将特制图像嵌入 Office 文档中，然后诱使用户查看该文档。
-   攻击者可能将特制图像添加到本地文件系统中，或者添加到网络共享中，然后诱使用户使用 Windows Explorer 预览目录。

**受此漏洞威胁最大的系统有哪些？**  
攻击者只能在受影响的系统上，通过诱使用户打开特制文件或查看包含特制图像的目录来利用此漏洞。 攻击者没有任何办法强迫用户打开恶意文件。

在基于 Web 的攻击中，攻击者必须拥有一个网站，并在上面放置用来利用此漏洞的网页。 攻击者无法强迫用户访问恶意网站。 相反，攻击者必须劝诱用户访问该网站，通常是让用户单击通向攻击者站点的链接。

在默认情况下，Windows XP、Windows XP Service Pack 1 和 Windows Server 2003 容易受到攻击。 在默认情况下，Windows XP Service Pack 2、Windows 98、Windows 98 SE、Windows Me、Windows NT 4.0 和 Windows 2000 不容易受到攻击。 但是，容易受攻击的组件可能会通过受影响软件部分列出的任何产品，安装在这些操作系统上。 执行 JPEG 处理的第三方应用程序；使用 Visual Studio .NET 2002、Visual Studio .NET 2003 或 the Microsoft .NET Framework 版本 1.0 SDK Service Pack 2 开发的第三方应用程序；以及分发容易受到攻击组件自已的副本第三方应用程序也可能容易受到攻击。

**此更新有什么作用？**  
更新通过修改受影响的组件验证受影响的图像类型的方式来消除此漏洞。

**发布此安全公告时，此漏洞是否已公开披露？**  
否。 Microsoft 通过可靠的披露渠道了解到有关此漏洞的信息。 在最初发布此安全公告时，Microsoft 未收到任何表明此漏洞已公开披露的信息。

**在发布此安全公告时，Microsoft 是否收到任何有关此漏洞已被利用的报告？**  
否。 在最初发布此安全公告时，Microsoft 未收到任何表明此漏洞已被公开用于攻击用户的信息，也没有看到任何发布的概念证明代码示例。

安全更新信息
------------

<span></span>
**安装平台和先决条件：**  

有关针对您的平台的特定安全更新的信息，请单击相应的链接：

#### Windows Server 2003（所有版本）

**先决条件**  
此安全更新需要一个 Windows Server 2003 的已发布版本。

**包括在 Future Service Pack 中：**  
此问题的更新将包括在 Windows Server 2003 Service Pack 1 中。

**安装信息**  

此安全更新支持以下安装开关：

**/help                 **显示命令行选项

**安装模式**  

**/quiet  **              安静模式（无用户交互或显示）

**/passive**            无人参与模式（只显示进度栏）

**      /uninstall**          卸载软件包

**重新启动选项**  

**/norestart**          安装完成后不重新启动

**/forcerestart**     安装完成后重新启动

**特殊选项**  

**/l**                       列出已安装的 Windows 修补程序或更新软件包

**/o**                       不经提示而覆盖 OEM 文件

**/n**                       不备份卸载所需的文件

**/f**                       在计算机关机时强制关闭其他程序

**注意：**这些开关可以在一个命令中组合使用。 为了保持向后兼容，此安全更新还支持以前版本的安装实用工具所使用的安装开关。 有关受支持的安装开关的详细信息，请参见 Microsoft 知识库文章 [262841](http://support.microsoft.com/default.aspx?scid=kb;zh-cn;262841)。

**部署信息**  

对于 Windows Server 2003，要在没有任何用户干预的情况下安装此安全更新，请在命令提示符处使用以下命令：

**   Windowsserver2003-kb833987-x86-enu /passive /quiet**  

对于 Windows Server 2003，要安装此安全更新而不强制重新启动系统，请在命令提示符处使用以下命令：

**   Windowsserver2003-kb833987-x86-enu /norestart**  

有关如何使用软件更新服务部署此安全更新的信息，请访问[软件更新服务网站](http://go.microsoft.com/fwlink/?linkid=21125)。

**重新启动要求**  

在某些情况下，此更新不需要重新启动。 安装程序停止所需的服务，应用此更新，然后重新启动这些服务。 但是，如果由于某种原因而无法停止所需服务，或者正在使用所需文件，则此更新需要重新启动。 如果发生这种情况，将显示一条消息建议您重新启动。

**删除信息**  

要删除此更新，请使用“控制面板”中的“添加/删除程序”工具。

系统管理员也可以使用 Spuninst.exe 实用工具删除此安全更新。 Spuninst.exe 实用工具位于 %Windir%\\$NTUninstallKB833987$\\Spuninst 文件夹中。 Spuninst.exe 实用工具支持以下安装开关：

**   /?**：显示安装开关列表。

**   /u**：使用无人参与模式。

**   /f**：当计算机关机时强制其他程序退出。

**/z**：安装完成后不重新启动。

**/q**：使用安静模式（没有用户交互）。

**文件信息**  

此更新的英文版具有下表所列的文件属性（或更高版本）。 这些文件的日期和时间以协调世界时 (UTC) 列出。 当您查看文件信息时，它将转换为本地时间。 要了解 UTC 与本地时间之间的时差，请使用“控制面板”上的“日期/时间”工具中的**“时区”**选项卡。

Windows Server 2003 Enterprise Edition、Windows Server 2003 Standard Edition、Windows Server 2003 Web Edition 和 Windows Server 2003 Datacenter Edition：

`日期         时间   版本       大小       文件名     文件夹-----------------------------------------------------------------24-Mar-2004  01:02  5.2.3790.136  1,642,496  Gdiplus.dll24-Mar-2004  01:02  5.2.3790.121    751,104  Sxs.dll      RTMQFE`

Windows Server 2003 64-Bit Enterprise Edition 和 Windows Server 2003 64-Bit Datacenter Edition：

`日期         时间   版本         大小       文件名         平台  文件夹--------------------------------------------------------------------------------24-Mar-2004  01:02  5.2.3790.136    4,719,104  Gdiplus.dll      IA-6424-Mar-2004  01:02  5.2.3790.136    1,642,496  Gdiplus.dll      x8624-Mar-2004  01:02  5.2.3790.121    1,860,608  Sxs.dll          IA-64     RTMQFE24-Mar-2004  01:02  5.2.3790.121      751,104  Wsxs.dll         x86       RTMQFE\WOW`

**验证更新安装**  

-   **Microsoft Baseline Security Analyzer (MBSA)**  

    要验证受影响的系统上是否安装了安全更新，也许可以使用 Microsoft 基准安全分析器 (MBSA) 工具。使用此工具，管理员可以在本地和远程系统中扫描缺少的安全更新和常见的安全错误配置。 有关 MBSA 的详细信息，请访问 [Microsoft Baseline Security Analyzer 网站](http://go.microsoft.com/fwlink/?linkid=21134)。

-   **文件版本验证**  

    **注意：**由于 Microsoft Windows 有多个版本，因此以下步骤在您的计算机上可能会有所不同。 如果不同，请参阅产品文档来完成这些步骤。

    1.  单击**“开始”**，然后单击**“搜索”**。
    2.  在**“搜索结果”**窗格中，单击**“搜索助理”**下的**“所有文件和文件夹”**。
    3.  在**“完整或部分文件名”**框中，键入相应文件信息表中的一个文件名，然后单击**“搜索”**。
    4.  在文件列表中，用鼠标右键单击相应文件信息表中的一个文件名，然后单击**“属性”**。

        **注意：**取决于安装的操作系统或程序的版本，文件信息表中所列的某些文件可能并未安装。

    5.  在**“版本”**选项卡上，通过将计算机上安装的文件与相应文件信息表中记录的版本进行比较来确定该文件的版本。

        **注意：**在安装过程中，除文件版本以外的其他属性均可能会发生变化。 不支持通过将其他文件属性与文件信息表中的信息进行比较这种方法来验证更新安装。 另外，在某些情况下，在安装过程中还可能会重命名文件。 如果没有文件或版本信息，请使用另外一种方法来验证更新安装。

-   **注册表项验证**  

    也可以通过查看以下注册表项，检查此安全更新已安装的文件：

    HKEY\_LOCAL\_MACHINE\\SOFTWARE\\Microsoft\\Updates\\Windows Server 2003\\SP1\\KB833987\\Filelist

    **注意：**此注册表项可能不包含已安装文件的完整列表。 另外，如果管理员或 OEM 将 840315 安全更新集成或组合到 Windows 安装源文件中，则可能无法正确创建此注册表项。

#### Windows XP 和 Windows XP Service Pack 1（所有版本）

**注意：**对于 Windows XP 64-Bit Edition Version 2003，此安全更新与 Windows Server 2003 64-Bit Edition 的安全更新相同。

**先决条件**  
此安全更新需要 Windows XP 或 Windows XP Service Pack 1 (SP1) 的发布版本。 有关详细信息，请参见 Microsoft 知识库文章 [322389](http://support.microsoft.com/default.aspx?scid=kb;zh-cn;322389)。

**包括在 Future Service Pack 中：**  
问题的更新包括在 Windows XP Service Pack 2 中。

**安装信息**  

此安全更新支持以下安装开关：

**/help                 **显示命令行选项

**安装模式**  

**/quiet  **              安静模式（无用户交互或显示）

**/passive**            无人参与模式（只显示进度栏）

**      /uninstall**          卸载软件包

**重新启动选项**  

**/norestart**          安装完成后不重新启动

**/forcerestart**     安装完成后重新启动

**特殊选项**  

**/l**                       列出已安装的 Windows 修补程序或更新软件包

**/o**                       不经提示而覆盖 OEM 文件

**/n**                       不备份卸载所需的文件

**/f**                       在计算机关机时强制关闭其他程序

**注意：**这些开关可以在一个命令中组合使用。 为了保持向后兼容，此安全更新还支持以前版本的安装实用工具所使用的安装开关。 有关受支持的安装开关的详细信息，请参见 Microsoft 知识库文章 [262841](http://support.microsoft.com/default.aspx?scid=kb;zh-cn;262841)。

**部署信息**  

对于 Windows XP，要在没有任何用户干预的情况下安装此安全更新，请在命令提示符处使用以下命令：

**Windowsxp-kb833987-x86-enu /passive /quiet**  

对于 Windows XP，要安装此安全更新而不强制重新启动系统，请在命令提示符处使用以下命令：

**Windowsxp-kb833987-x86-enu /norestart**  

有关如何使用软件更新服务部署此安全更新的详细信息，请访问 [Software Update Services 网站](http://go.microsoft.com/fwlink/?linkid=21125)。

**重新启动要求**  

在某些情况下，此更新不需要重新启动。 安装程序停止所需的服务，应用此更新，然后重新启动这些服务。 但是，如果由于某种原因而无法停止所需服务，或者正在使用所需文件，则此更新需要重新启动。 如果发生这种情况，将显示一条消息建议您重新启动。

**删除信息**  

要删除此安全更新，请使用“控制面板”中的“添加或删除程序”工具。

系统管理员也可以使用 Spuninst.exe 实用工具删除此安全更新。 Spuninst.exe 位于 %Windir%\\$NTUninstallKB833987$\\Spuninst 文件夹中。 Spuninst.exe 实用工具支持以下安装开关：

**/?**：显示安装开关列表。

**/u**：使用无人参与模式。

**/f**：当计算机关机时强制其他程序退出。

**/z**：安装完成后不重新启动。

**/q**：使用安静模式（没有用户交互）。

**文件信息**  

此更新的英文版具有下表所列的文件属性（或更高版本）。 这些文件的日期和时间以协调世界时 (UTC) 列出。 当您查看文件信息时，它将转换为本地时间。 要了解 UTC 与本地时间之间的时差，请使用“控制面板”上的“日期/时间”工具中的**“时区”**选项卡。

Windows XP Home Edition、Windows XP Professional、Windows XP Home Edition Service Pack 1、Windows XP Professional Service Pack 1、Windows XP Tablet PC Edition 和 Windows XP Media Center Edition：

`日期         时间   版本        大小       文件名     文件夹--------------------------------------------------------------------------09-Mar-2004  01:58  5.1.2600.136     646,656  Sxs.dll       SP1 (Pre SP1)02-Mar-2004  21:19  5.1.3102.1360  1,638,400  Gdiplus.dll   SP1 (Pre SP1)09-Mar-2004  02:25  5.1.2600.1363    676,864  Sxs.dll       SP2 (With SP1)02-Mar-2004  21:19  5.1.3102.1360  1,638,400  Gdiplus.dll   SP2 (With SP1)`

Windows XP 64-Bit Edition Service Pack 1：

`日期         时间   版本        大小       文件名        平台--------------------------------------------------------------------------09-Mar-2004  02:33  5.1.2600.1363  2,018,816  Sxs.dll          IA-6409-Mar-2004  02:25  5.1.2600.1363    676,864  Wsxs.dll         x8609-Mar-2004  02:33  5.1.3102.1360  5,185,536  Gdiplus.dll      IA-64`

Windows XP 64-Bit Edition Version 2003：

`日期         时间   版本         大小       文件名        平台  文件夹--------------------------------------------------------------------------------24-Mar-2004  01:02  5.2.3790.136    4,719,104  Gdiplus.dll      IA-6424-Mar-2004  01:02  5.2.3790.136    1,642,496  Gdiplus.dll      x8624-Mar-2004  01:02  5.2.3790.121    1,860,608  Sxs.dll          IA-64     RTMQFE24-Mar-2004  01:02  5.2.3790.121      751,104  Wsxs.dll         x86    RTMQFE\WOW`

**备注**  

此安全更新的 Windows XP 和 Windows XP 64 位 Edition 版本 2003 版本被打包为双模式程序包，其中包含 Windows XP 的原始版本和 Windows XP Service Pack 1 (SP1) 的文件。 有关双模式程序包的详细信息，请参见 Microsoft 知识库文章 [328848](http://support.microsoft.com/default.aspx?kbid=328848)。

**验证更新安装**  

-   **Microsoft Baseline Security Analyzer (MBSA)**  

    要验证受影响的系统上是否安装了安全更新，也许可以使用 Microsoft 基准安全分析器 (MBSA) 工具。使用此工具，管理员可以在本地和远程系统中扫描缺少的安全更新和常见的安全错误配置。 有关 MBSA 的详细信息，请访问 [Microsoft Baseline Security Analyzer 网站](http://go.microsoft.com/fwlink/?linkid=21134)。

-   **文件版本验证**  

    **注意：**由于 Microsoft Windows 有多个版本，因此以下步骤在您的计算机上可能会有所不同。 如果不同，请参阅产品文档来完成这些步骤。

    1.  单击**“开始”**，然后单击**“搜索”**。
    2.  在**“搜索结果”**窗格中，单击**“搜索助理”**下的**“所有文件和文件夹”**。
    3.  在**“完整或部分文件名”**框中，键入相应文件信息表中的一个文件名，然后单击**“搜索”**。
    4.  在文件列表中，用鼠标右键单击相应文件信息表中的一个文件名，然后单击**“属性”**。

        **注意：**取决于安装的操作系统或程序的版本，文件信息表中所列的某些文件可能并未安装。

    5.  在**“版本”**选项卡上，通过将计算机上安装的文件与相应文件信息表中记录的版本进行比较来确定该文件的版本。

        **注意：**在安装过程中，除文件版本以外的其他属性均可能会发生变化。 不支持通过将其他文件属性与文件信息表中的信息进行比较这种方法来验证更新安装。 另外，在某些情况下，在安装过程中还可能会重命名文件。 如果没有文件或版本信息，请使用另外一种方法来验证更新安装。

-   **注册表项验证**  

    也可以通过查看以下注册表项，检查此安全更新已安装的文件。

    对于 Windows XP Home Edition、Windows XP Professional、Windows XP Home Edition Service Pack 1、Windows XP Professional Service Pack 1、Windows XP 64-Bit Edition Service Pack 1、Windows XP Tablet PC Edition 和 Windows XP Media Center Edition：

    HKEY\_LOCAL\_MACHINE\\SOFTWARE\\Microsoft\\Updates\\Windows XP\\SP2\\KB833987\\Filelist

    对于 Windows XP 64-Bit Edition Version 2003：

    HKEY\_LOCAL\_MACHINE\\SOFTWARE\\Microsoft\\Updates\\Windows Server 2003\\SP1\\KB833987\\Filelist

    **注意：**这些注册表项可能不包含已安装文件的完整列表。 另外，如果管理员或 OEM 将 839643 安全更新集成或组合到 Windows 安装源文件中，则可能无法正确创建这些注册表项。

#### Windows XP（所有版本）

#### 先决条件和其他更新详细信息

**重要事项：**在您安装此更新之前，请确保符合以下要求：

-   必须安装 Microsoft Windows Installer 2.0。 Microsoft Windows Server 2003、Windows XP 和 Microsoft Windows 2000 Service Pack 3 (SP3) 都包含了 Windows 安装程序 2.0 或更高版本。 要安装最新版本的 Windows 安装程序，请访问下列 Microsoft Web 站点之一。

    [Windows 95、Windows 98、Windows 98 SE 和 Windows Millennium Edition 的 Windows Installer 2.0](http://www.microsoft.com/downloads/release.asp?releaseid=32831)

    [Windows 2000 和 Windows NT 4.0 的 Windows Installer 2.0](http://www.microsoft.com/downloads/release.asp?releaseid=32832)

-   必须安装 Office XP Service Pack 3 (SP3)，以便安装客户机安全更新。 安装此更新之前，请安装 Office XP SP3。 有关如何安装 Office XP SP3 的其他信息，请参阅 Microsoft 知识库文章 [832671](http://support.microsoft.com/default.aspx?scid=kb;%5bln%5d;832671)。 管理更新也可以安装在运行 Office XP Service Pack 2 或 Office XP Service Pack 3 的系统上。 用于 Office XP Service Pack 2 的安全更新仅作为 Office XP 管理安全更新的一部分提供。

有关如何确定计算机上 Office XP 的版本的其他信息，请参阅 Microsoft 知识库文章 [291331](http://support.microsoft.com/default.aspx?scid=kb;%5bln%5d;291331)。

**注意：**虽然安全更新安装用户界面是英文界面，但是此更新的管理版本包括有支持在受影响的产品的本地化版本上进行安装所必需的文件。

**包括在将来的 Service Pack 中：**  

此问题的修补程序将包含在以后的 Service Pack 中。

**重新启动要求**  

无需重新启动。

**删除信息**  

安装更新后，无法删除它。 要在安装更新前还原安装，您必须删除该应用程序，然后通过原始的 CD-ROM 重新安装它。

#### 自动化客户端安装信息

**Office Update Web 站点**  

Microsoft 建议您通过 [Office Update Web 站点](http://go.microsoft.com/fwlink/?linkid=21135)安装 Microsoft Office XP 客户端。 Office Update Web 站点会检测您安装的特定程序，并提示您确切安装必须安装的更新，以确保所安装的程序彻底是最新的。

让 Office Update Web 站点检测您必须在计算机上安装的更新，请访问 [Office Update Web 站点](http://go.microsoft.com/fwlink/?linkid=21135)，然后单击“**检查更新**”。 检测完成后，您会收到供您认可的建议更新列表。 单击“**Start Installation**”（开始安装）以完成更新过程。

#### 手动客户端安装信息

有关如何手动安装此更新的详细信息，请查看以下部分。

**安装信息**  

此安全更新支持以下安装开关：

**/Q**   指定安静模式，或在提取文件时禁止显示提示。

**/Q:U**   指定用户安静模式，该模式向用户显示某些对话框。

**/Q:A**   指定管理员安静模式，该模式不向用户显示任何对话框。

/**T**:**&lt;full path&gt;**   指定用于提取文件的目标文件夹。

/**C** 提取文件，但不安装它们。 如果不指定 /**T**: 路径，系统将提示您提供一个目标文件夹。

**/C:&lt;Cmd&gt;** 覆盖作者定义的安装命令。 指定安装程序的 .inf 或 .exe 文件的路径和名称。

/**R:N** 安装后从不重新启动计算机。

**/R:I**   如果需要重新启动计算机，则提示用户重新启动，与 **/Q:A** 一起使用时除外。

/**R:A** 安装后始终重新启动计算机。

/**R:S** 安装后在不提示用户的情况下重新启动计算机。

**/N:V** 不进行版本检查，在任何以前的版本上安装程序。

**注意：**这些开关并不一定适用于所有更新。 如果某开关不可用，则表明该功能是正确安装更新所必需的。 此外，不支持使用 /**N:V** 开关，它可能会导致系统无法启动。 如果安装失败，您应该咨询您的支持专业人员以了解安装失败的原因。

有关受支持的安装开关的其他信息，请参见 Microsoft 知识库文章 [197147](http://support.microsoft.com/default.aspx?scid=kb;zh-cn;197147)。

**客户端部署信息**  

1.  [下载此安全更新的客户端版本。](http://www.microsoft.com/downloads/details.aspx?familyid=7d128614-6d34-49df-8d63-6c17e9a2d312&amp;displaylang=en)
2.  单击**“将该程序保存到磁盘”**，然后单击“**确定**”。
3.  单击“**保存**”。
4.  在 Windows 资源管理器中，找到包括已保存文件的文件夹，然后双击这个已保存的文件。
5.  如果系统提示您安装更新，则单击“**是**”。
6.  单击“**是**”接受许可协议。
7.  在系统提示时插入原始源 CD-ROM，然后单击**“确定”**。
8.  当您收到指示安装成功的消息时，单击“**确定**”。

**注意：**如果安全更新已经安装在计算机上，您会收到以下错误消息：**This update has already been applied or is included in an update that has already been applied（此更新已应用，或者包含在已应用的更新中）**。

**客户端安装文件信息**  

此更新的英文版具有下表所列的文件属性（或更高版本）。 这些文件的日期和时间以协调世界时 (UTC) 列出。 当您查看文件信息时，它将转换为本地时间。 要了解 UTC 与本地时间之间的时差，请使用“控制面板”上的“日期/时间”工具中的**“时区”**选项卡。

Office XP：

`日期         时间   版本      尺寸       文件名--------------------------------------------------------07-May-2004  21:56  10.0.6714.0  9,796,288  Mso.dll`

**验证更新安装**  

-   **Microsoft Baseline Security Analyzer**  

    要验证受影响的系统上是否安装了安全更新，也许可以使用 Microsoft 基准安全分析器 (MBSA) 工具。使用此工具，管理员可以在本地和远程系统中扫描缺少的安全更新和常见的安全错误配置。 有关 MBSA 的详细信息，请访问 [Microsoft Baseline Security Analyzer 网站](http://go.microsoft.com/fwlink/?linkid=21134)。

-   **文件版本验证**  

    **注意：**由于 Microsoft Windows 有多个版本，因此以下步骤在您的计算机上可能会有所不同。 如果不同，请参阅产品文档来完成这些步骤。

    1.  单击**“开始”**，然后单击**“搜索”**。
    2.  在**“搜索结果”**窗格中，单击**“搜索助理”**下的**“所有文件和文件夹”**。
    3.  在**“完整或部分文件名”**框中，键入相应文件信息表中的一个文件名，然后单击**“搜索”**。
    4.  在文件列表中，用鼠标右键单击相应文件信息表中的一个文件名，然后单击**“属性”**。

        **注意：**取决于安装的操作系统或程序的版本，文件信息表中所列的某些文件可能并未安装。

    5.  在**“版本”**选项卡上，通过将计算机上安装的文件与相应文件信息表中记录的版本进行比较来确定该文件的版本。

        **注意：**在安装过程中，除文件版本以外的其他属性均可能会发生变化。 不支持通过将其他文件属性与文件信息表中的信息进行比较这种方法来验证更新安装。 另外，在某些情况下，在安装过程中还可能会重命名文件。 如果没有文件或版本信息，请使用另外一种方法来验证更新安装。

#### 管理安装信息

如果从服务器位置安装了应用程序，则服务器的管理员必须利用管理更新对服务器位置进行更新，并将该更新部署到您的计算机。

**安装信息**  

以下安装开关与管理安装有关，因为使用这些开关，管理员可以自定义从安全更新内提取文件的方式：

/**?** 显示命令行选项

**/Q**   指定安静模式，或在提取文件时禁止显示提示。

/**T**:**&lt;full path&gt;**   指定用于提取文件的目标文件夹。

/**C** 提取文件，但不安装它们。 如果不指定 /**T**: 路径，系统将提示您提供一个目标文件夹。

**/C:&lt;Cmd&gt;** 覆盖作者定义的安装命令。 指定安装程序的 .inf 或 .exe 文件的路径和名称。

有关受支持的安装开关的其他信息，请参见 Microsoft 知识库文章 [197147](http://support.microsoft.com/default.aspx?scid=kb;zh-cn;197147)。

**管理部署信息**  

要更新您的管理安装，请执行以下步骤：

1.  [下载此安全更新的管理版本。](http://www.microsoft.com/downloads/details.aspx?familyid=7d128614-6d34-49df-8d63-6c17e9a2d312&amp;displaylang=en)
2.  单击**“将该程序保存到磁盘”**，然后单击“**确定**”。
3.  单击“**保存**”。
4.  在 Windows 资源管理器中，找到含有已保存文件的文件夹，然后双击这个保存的文件。
5.  如果系统提示您安装更新，则单击“**是**”。
6.  单击“**是**”接受许可协议。
7.  在**“请键入放置提取文件的位置”**框中，键入 c:\\adminUpdate，然后单击**“确定”**。
8.  当系统提示您创建该文件夹时，单击“**是**”。
9.  如果您熟悉用于更新管理安装的过程，请单击“**开始**”，然后单击“**运行**”。 在“打开”框中键入以下命令

    msiexec /a Admin Path\\MSI File /p C:\\adminUpdate\\MSP File SHORTFILENAMES=TRUE

    其中 Admin Path 是您的应用程序的管理安装点的路径（例如 C:\\OfficeXP），MSI File 是用于该应用程序的 .msi 数据库包（例如 Data1.msi），MSP File 是管理更新的名称（例如 SHAREDff.msp）。

    **注意：**可以在命令行后附加 **/qb+**，以使**“管理安装”**对话框和**“最终用户协议”**对话框不出现。

10. 在提供的对话框中单击**“下一步”** 。 在提供的对话框中不要更改您的 CD 密钥、安装位置或公司名。
11. 单击**“我接受许可协议条款”**，然后单击**“安装”**。

此时，您的管理安装点即更新。 接下来，您必须更新原先从该管理安装中安装的工作站。 为此，请查看“工作站部署”部分。 您从该管理安装点运行的任何新安装都将包括该更新。

**警告：**对于您在安装更新之前从此管理安装中安装的任何工作站，如果不为该工作站完成“工作站部署”部分中的步骤，这些工作站就无法使用此管理安装执行修补 Office、新增功能等操作。

**工作站部署信息**  

要将更新部署到客户机工作站，请单击“**开始**”，然后单击“**运行**”。 在**“打开”**框中键入以下命令：

msiexec /i Admin Path\\MSI File /qb REINSTALL=Feature List REINSTALLMODE=vomu

其中 Admin Path 是您的应用程序的管理安装点的路径（例如，C:\\OfficeXP），MSI File 是用于该应用程序的 MSI 数据库包（例如，Data1.msi），Feature List 是必须为更新重新安装的功能名称（区分大小写）的列表。 要安装所有功能，您可以使用 **REINSTALL=ALL**。

**注意：**Microsoft 知识库文章 [832332](http://support.microsoft.com/default.aspx?scid=kb;zh-cn;832332) 提供其他说明。 您还可以在 [Microsoft Office XP 资源工具箱 Web 站点](http://www.microsoft.com/office/ork/xp/)查找有关此更新的信息。 有关 [Microsoft Office XP 资源工具箱](http://go.microsoft.com/fwlink/?linkid=21747)的一般信息，请访问 TechNet。 Windows 安装程序文档也提供关于 Windows 安装程序支持的参数的其他信息。

**管理安装文件信息**  

此更新的英文版具有下表所列的文件属性（或更高版本）。 这些文件的日期和时间以协调世界时 (UTC) 列出。 当您查看文件信息时，它将转换为本地时间。 要了解 UTC 与本地时间之间的时差，请使用“控制面板”上的“日期/时间”工具中的**“时区”**选项卡。

Office XP：

`日期         时间   版本      大小       文件名--------------------------------------------------------07-May-2004  21:56  10.0.6714.0  9,796,288  Mso.dll`

**验证更新安装**  

-   **Microsoft Baseline Security Analyzer**  

    要验证受影响的系统上是否安装了安全更新，也许可以使用 Microsoft 基准安全分析器 (MBSA) 工具。使用此工具，管理员可以在本地和远程系统中扫描缺少的安全更新和常见的安全错误配置。 有关 MBSA 的详细信息，请访问 [Microsoft Baseline Security Analyzer 网站](http://go.microsoft.com/fwlink/?linkid=21134)。

-   **文件版本验证**  

    **注意：**由于 Microsoft Windows 有多个版本，因此以下步骤在您的计算机上可能会有所不同。 如果不同，请参阅产品文档来完成这些步骤。

    1.  单击**“开始”**，然后单击**“搜索”**。
    2.  在**“搜索结果”**窗格中，单击**“搜索助理”**下的**“所有文件和文件夹”**。
    3.  在**“完整或部分文件名”**框中，键入相应文件信息表中的一个文件名，然后单击**“搜索”**。
    4.  在文件列表中，用鼠标右键单击相应文件信息表中的一个文件名，然后单击**“属性”**。

        **注意：**取决于安装的操作系统或程序的版本，文件信息表中所列的某些文件可能并未安装。

    5.  在**“版本”**选项卡上，通过将计算机上安装的文件与相应文件信息表中记录的版本进行比较来确定该文件的版本。

        **注意：**在安装过程中，除文件版本以外的其他属性均可能会发生变化。 不支持通过将其他文件属性与文件信息表中的信息进行比较这种方法来验证更新安装。 另外，在某些情况下，在安装过程中还可能会重命名文件。 如果没有文件或版本信息，请使用另外一种方法来验证更新安装。

#### Project 2002（所有版本）

#### 先决条件和其他更新详细信息

**重要事项：**在您安装此更新之前，请确保符合以下要求：

-   必须安装 Microsoft Windows Installer 2.0。 Microsoft Windows Server 2003、Windows XP 和 Microsoft Windows 2000 Service Pack 3 (SP3) 都包含了 Windows 安装程序 2.0 或更高版本。 可以在以下链接，通过单独下载，获得 Windows 安装程序的最新版本：

    [Windows 95、Windows 98、Windows 98 SE 和 Windows Millennium Edition 的 Windows Installer 2.0](http://www.microsoft.com/downloads/release.asp?releaseid=32831)

    [Windows 2000 和 Windows NT 4.0 的 Windows Installer 2.0](http://www.microsoft.com/downloads/release.asp?releaseid=32832)

-   必须安装 Microsoft Project Standard 2002、Microsoft Project Standard Service Pack 1、Microsoft Project Professional 2002 或 Microsoft Project Professional 2002 Service Pack 1。 建议在安装此更新之前先安装 Microsoft Project 2002 Service Pack 1。 但是，此更新将会在尚未安装 Service Pack 1 的 Microsoft Project 2002 安装上成功安装。 有关如何安装 Project 2002 Service Pack 1 的其他信息，请参见 Microsoft 知识库文章 [830241](http://support.microsoft.com/default.aspx?scid=kb;zh-cn;830241)。 有关如何在尚未安装 Project 2002 Service Pack 1 的 Microsoft Project 2002 安装上安装此更新的其他信息，请参见 Microsoft 知识库文章 [831931](http://support.microsoft.com/default.aspx?scid=kb;zh-cn;831931)。

**注意：**虽然安全更新安装用户界面是英文界面，但是此更新的管理（全文件）版本包括有支持在受影响的产品的本地化版本上进行安装所必需的文件。

**包括在将来的 Service Pack 中：**  

此问题的修补程序将包含在以后的 Service Pack 中。

**重新启动要求**  

无需重新启动。

**删除信息**  

安装更新后，无法删除它。 要在安装更新前还原安装，您必须删除该应用程序，然后通过原始的 CD-ROM 重新安装它。

#### 自动化客户端安装信息

**Office Update Web 站点**  

Microsoft 建议您通过使用 [Office Update Web 站点](http://go.microsoft.com/fwlink/?linkid=21135)来安装 Project 2002 客户端更新。 Office Update Web 站点会检测您安装的特定程序，并提示您确切安装必须安装的更新，以确保所安装的程序彻底是最新的。

要让 Office Update Web 站点检测您必须在计算机上安装的更新，请访问 [Office Update Web 站点](http://go.microsoft.com/fwlink/?linkid=21135)，然后单击**“检查更新**”。 检测完成后，您会收到供您认可的建议更新列表。 单击“**开始安装**”以完成更新过程。

#### 手动客户端安装信息

有关如何手动安装此更新的详细信息，请查看以下部分。

**安装信息**  

此安全更新支持以下安装开关：

**/Q**   指定安静模式，或在提取文件时禁止显示提示。

**/Q:U**   指定用户安静模式，该模式向用户显示某些对话框。

**/Q:A**   指定管理员安静模式，该模式不向用户显示任何对话框。

/**T**:**&lt;full path&gt;**   指定用于提取文件的目标文件夹。

/**C** 提取文件，但不安装它们。 如果不指定 /**T**: 路径，系统将提示您提供一个目标文件夹。

**/C:&lt;Cmd&gt;** 覆盖作者定义的安装命令。 指定安装程序的 .inf 或 .exe 文件的路径和名称。

/**R:N** 安装后从不重新启动计算机。

**/R:I**   如果需要重新启动计算机，则提示用户重新启动，与 **/Q:A** 一起使用时除外。

/**R:A** 安装后始终重新启动计算机。

/**R:S** 安装后在不提示用户的情况下重新启动计算机。

**/N:V** 不进行版本检查，在任何以前的版本上安装程序。

**注意：**这些开关并不一定适用于所有更新。 如果某开关不可用，则表明该功能是正确安装更新所必需的。 此外，不支持使用 /N:V 开关，它可能会导致系统无法启动。 如果安装失败，您应该咨询您的支持专业人员以了解安装失败的原因。

有关受支持的安装开关的其他信息，请参见 Microsoft 知识库文章 [197147](http://support.microsoft.com/default.aspx?scid=kb;zh-cn;197147)。

**客户端部署信息**  

1.  [下载更新](http://www.microsoft.com/downloads/details.aspx?familyid=b3ebccea-b0e4-41c7-a6f4-413864d2ccf3&displaylang=en)。
2.  单击**“将该程序保存到磁盘”**，然后单击“**确定**”。
3.  单击“**保存**”。
4.  在 Windows 资源管理器中，找到包括已保存文件的文件夹，然后双击这个已保存的文件。
5.  如果系统提示您安装更新，则单击“**是**”。
6.  单击“**是**”接受许可协议。
7.  在系统提示时插入原始源 CD-ROM，然后单击**“确定”**。
8.  当您收到指示安装成功的消息时，单击“**确定**”。

**注意：**如果安全更新已经安装在计算机上，您会收到以下错误消息：**This update has already been applied or is included in an update that has already been applied（此更新已应用，或者包含在已应用的更新中）**。

**客户端安装文件信息**  

此更新的英文版具有下表所列的文件属性（或更高版本）。 这些文件的日期和时间以协调世界时 (UTC) 列出。 当您查看文件信息时，它将转换为本地时间。 要了解 UTC 与本地时间之间的时差，请使用“控制面板”上的“日期/时间”工具中的**“时区”**选项卡。

Project 2002：

`日期         时间   版本      大小       文件名--------------------------------------------------------07-May-2004  21:56  10.0.6714.0  9,796,288  Mso.dll`

**验证更新安装**  

-   **Microsoft Baseline Security Analyzer (MBSA)**  

    要验证受影响的系统上是否安装了安全更新，也许可以使用 Microsoft 基准安全分析器 (MBSA) 工具。使用此工具，管理员可以在本地和远程系统中扫描缺少的安全更新和常见的安全错误配置。 有关 MBSA 的详细信息，请访问 [Microsoft Baseline Security Analyzer 网站](http://go.microsoft.com/fwlink/?linkid=21134)。

-   **文件版本验证**  

    **注意：**由于 Microsoft Windows 有多个版本，因此以下步骤在您的计算机上可能会有所不同。 如果不同，请参阅产品文档来完成这些步骤。

    1.  单击**“开始”**，然后单击**“搜索”**。
    2.  在**“搜索结果”**窗格中，单击**“搜索助理”**下的**“所有文件和文件夹”**。
    3.  在**“完整或部分文件名”**框中，键入相应文件信息表中的一个文件名，然后单击**“搜索”**。
    4.  在文件列表中，用鼠标右键单击相应文件信息表中的一个文件名，然后单击**“属性”**。

        **注意：**取决于安装的操作系统或程序的版本，文件信息表中所列的某些文件可能并未安装。

    5.  在**“版本”**选项卡上，通过将计算机上安装的文件与相应文件信息表中记录的版本进行比较来确定该文件的版本。

        **注意：**在安装过程中，除文件版本以外的其他属性均可能会发生变化。 不支持通过将其他文件属性与文件信息表中的信息进行比较这种方法来验证更新安装。 另外，在某些情况下，在安装过程中还可能会重命名文件。 如果没有文件或版本信息，请使用另外一种方法来验证更新安装。

#### 管理安装信息

如果从服务器位置安装了应用程序，则服务器的管理员必须利用管理更新对服务器位置进行更新，并将该更新部署到您的计算机。

**安装信息**  

以下安装开关与管理安装有关，因为使用这些开关，管理员可以自定义从安全更新内提取文件的方式：

/**?** 显示命令行选项

**/Q**   指定安静模式，或在提取文件时禁止显示提示。

/**T**:**&lt;full path&gt;**   指定用于提取文件的目标文件夹。

/**C** 提取文件，但不安装它们。 如果不指定 /**T**: 路径，系统将提示您提供一个目标文件夹。

**/C:&lt;Cmd&gt;** 覆盖作者定义的安装命令。 指定安装程序的 .inf 或 .exe 文件的路径和名称。

有关受支持的安装开关的其他信息，请参见 Microsoft 知识库文章 [197147](http://support.microsoft.com/default.aspx?scid=kb;zh-cn;197147)。

**管理部署信息**  

要更新您的管理安装，请执行以下步骤：

1.  在 Windows 资源管理器中，在 C 区创建一个新文件夹，然后命名为 KB831931。
2.  [下载更新](http://www.microsoft.com/downloads/details.aspx?familyid=b3ebccea-b0e4-41c7-a6f4-413864d2ccf3&displaylang=en)。
3.  单击**“将该程序保存到磁盘 ”**来将 Project2002-KB831931-FullFile-ENU.exe 文件保存到 C:\\KB831931 文件夹。
4.  单击**“开始”**，单击**“运行”**，在**“打开”**框中键入 **cmd**，然后单击**“确定”**。 （如果使用 Windows 98、Windows 98 SE 或 Windows Millennium Edition，用 **command.com** 替代 **cmd**。）
5.  在命令提示符后，键入下列行，并在每个行之后按下 ENTER 键：

    cd\\kb831931

    Project2002-KB831931-FullFile-ENU.exe /c /t:c:\\kb831931

6.  单击“**是**”接受许可协议。
7.  在命令方式下，键入以下行，然后按 ENTER：

    exit

8.  如果您熟悉用于更新管理安装的过程，请单击“**开始**”，然后单击“**运行**”。 在“打开”框中键入以下命令

    msiexec /a Admin Path\\MSI File /p C:\\kb831931\\MSP File SHORTFILENAMES=TRUE

    其中 Admin Path 是您的应用程序的管理安装点的路径（例如 C:\\Project），MSI File 是用于该应用程序的 .msi 数据库包（例如 Prjproe.msi），MSP File 是管理更新的名称（例如 MSO.MSP）。

    **注意：**可以在命令行后附加 **/qb+**，以使**“管理安装”**对话框和**“最终用户协议”**对话框不出现。

9.  在提供的对话框中单击**“下一步”** 。 在提供的对话框中不要更改您的 CD 密钥、安装位置或公司名。
10. 单击**“我接受许可协议条款”**，然后单击**“安装”**。

此时，您的管理安装点即更新。 接下来，您必须更新原先从该管理安装中安装的工作站。 为此，请查看“工作站部署”部分。 您从该管理安装点运行的任何新安装都将包括该更新。

**警告：**对于您在安装更新之前从此管理安装中安装的任何工作站，如果不为该工作站完成“工作站部署”部分中的步骤，这些工作站就无法使用此管理安装执行修补 Office、新增功能等操作。

**工作站部署信息**  

要将更新部署到客户机工作站，请单击“**开始**”，然后单击“**运行**”。 在**“打开”**框中键入以下命令：

msiexec /i Admin Path\\MSI File /qb REINSTALL=Feature List REINSTALLMODE=vomu

其中 Admin Path 是您的应用程序的管理安装点的路径（例如，C:\\Project），MSI File 是用于该应用程序的 MSI 数据库包（例如，Prjproe.msi），Feature List 是必须为更新重新安装的功能名称（区分大小写）的列表。 要安装所有功能，您可以使用 **REINSTALL=ALL**。

**注意：**Microsoft 知识库文章 [831931](http://support.microsoft.com/default.aspx?scid=kb;zh-cn;831931) 提供其他说明。 有关 Microsoft Project 2002 的信息，可查询 [Microsoft Project 2002 资源工具箱](http://www.microsoft.com/resources/documentation/project/2002/all/reskit/en-us/default.mspx)。 有关 [Microsoft Office XP 资源工具箱](http://go.microsoft.com/fwlink/?linkid=21747)的一般信息，请访问 TechNet。 [Windows 安装程序文档](http://go.microsoft.com/fwlink/?linkid=21685)也提供关于 Windows 安装程序支持的参数的其他信息。

**管理安装文件信息**  

此更新的英文版具有下表所列的文件属性（或更高版本）。 这些文件的日期和时间以协调世界时 (UTC) 列出。 当您查看文件信息时，它将转换为本地时间。 要了解 UTC 与本地时间之间的时差，请使用“控制面板”上的“日期/时间”工具中的**“时区”**选项卡。

Project 2002：

`日期         时间   版本      尺寸       文件名--------------------------------------------------------07-May-2004  21:56  10.0.6714.0  9,796,288  Mso.dll`

**验证更新安装**  

-   **Microsoft Baseline Security Analyzer**  

    要验证受影响的系统上是否安装了安全更新，也许可以使用 Microsoft 基准安全分析器 (MBSA) 工具。使用此工具，管理员可以在本地和远程系统中扫描缺少的安全更新和常见的安全错误配置。 有关 MBSA 的详细信息，请访问 [Microsoft Baseline Security Analyzer 网站](http://go.microsoft.com/fwlink/?linkid=21134)。

-   **文件版本验证**  

    **注意：**由于 Microsoft Windows 有多个版本，因此以下步骤在您的计算机上可能会有所不同。 如果不同，请参阅产品文档来完成这些步骤。

    1.  单击**“开始”**，然后单击**“搜索”**。
    2.  在**“搜索结果”**窗格中，单击**“搜索助理”**下的**“所有文件和文件夹”**。
    3.  在**“完整或部分文件名”**框中，键入相应文件信息表中的一个文件名，然后单击**“搜索”**。
    4.  在文件列表中，用鼠标右键单击相应文件信息表中的一个文件名，然后单击**“属性”**。

        **注意：**取决于安装的操作系统或程序的版本，文件信息表中所列的某些文件可能并未安装。

    5.  在**“版本”**选项卡上，通过将计算机上安装的文件与相应文件信息表中记录的版本进行比较来确定该文件的版本。

        **注意：**在安装过程中，除文件版本以外的其他属性均可能会发生变化。 不支持通过将其他文件属性与文件信息表中的信息进行比较这种方法来验证更新安装。 另外，在某些情况下，在安装过程中还可能会重命名文件。 如果没有文件或版本信息，请使用另外一种方法来验证更新安装。

#### Visio 2002（所有版本）

#### 先决条件和其他更新详细信息

**重要事项：**在您安装此更新之前，请确保符合以下要求：

-   必须安装 Microsoft Windows Installer 2.0。 Microsoft Windows Server 2003、Windows XP 和 Microsoft Windows 2000 Service Pack 3 (SP3) 都包含了 Windows 安装程序 2.0 或更高版本。 可以在以下链接，通过单独下载，获得 Windows 安装程序的最新版本：

    [Windows 95、Windows 98、Windows 98 SE 和 Windows Millennium Edition 的 Windows Installer 2.0](http://www.microsoft.com/downloads/release.asp?releaseid=32831)

    [Windows 2000 和 Windows NT 4.0 的 Windows Installer 2.0](http://www.microsoft.com/downloads/release.asp?releaseid=32832)

-   必须安装 Microsoft Visio 2002 标准版（Service Pack 1 或 Service Pack 2）、Microsoft Visio 2002 专业版（Service Pack 1 或 Service Pack 2）、Microsoft Visio 2002 for Enterprise Architects（Service Pack 1 或 Service Pack 2）或 Microsoft Visio 2002 for Biztalk Server（Service Pack 1 或 Service Pack 2）。 在安装此更新前，请安装 Visio 2002 Service Pack 1 或 [Service Pack 2](http://www.microsoft.com/downloads/details.aspx?familyid=00b9dfe4-ed08-4328-b355-4bc63d6267b2&displaylang=en)。 有关如何安装 Visio 2002 Service Pack 2 的其他信息，请参阅 Microsoft 知识库文章 [830242](http://support.microsoft.com/default.aspx?scid=kb;zh-cn;830242)。 有关如何在尚未安装 Visio 2002 Service Pack 2 的 Microsoft Visio 2002 安装上安装此更新的其他信息，请参见 Microsoft 知识库文章 [831932](http://support.microsoft.com/default.aspx?scid=kb;zh-cn;831932)。

**注意：**虽然安全更新安装用户界面是英文界面，但是此更新的管理（全文件）版本包括有支持在受影响的产品的本地化版本上进行安装所必需的文件。

**包括在将来的 Service Pack 中：**  

此问题的修补程序将包含在以后的 Service Pack 中。

**重新启动要求**  

无需重新启动。

**删除信息**  

安装更新后，无法删除它。 要在安装更新前还原安装，您必须删除该应用程序，然后通过原始的 CD-ROM 重新安装它。

#### 自动化客户端安装信息

**Office Update Web 站点**  

Microsoft 建议您通过使用 [Office Update Web 站点](http://go.microsoft.com/fwlink/?linkid=21135)来安装 Visio 2002 客户端更新。 Office Update Web 站点会检测您安装的特定程序，并提示您确切安装必须安装的更新，以确保所安装的程序彻底是最新的。

要让 Office Update Web 站点检测您必须在计算机上安装的更新，请访问 [Office Update Web 站点](http://go.microsoft.com/fwlink/?linkid=21135)，**然后单击检查以进行更新**。 检测完成后，您会收到供您认可的建议更新列表。 单击“**开始安装**”以完成更新过程。

#### 手动客户端安装信息

有关如何手动安装此更新的详细信息，请查看以下部分。

**安装信息**  

此安全更新支持以下安装开关：

**/Q**   指定安静模式，或在提取文件时禁止显示提示。

**/Q:U**   指定用户安静模式，该模式向用户显示某些对话框。

**/Q:A**   指定管理员安静模式，该模式不向用户显示任何对话框。

/**T**:**&lt;full path&gt;**   指定用于提取文件的目标文件夹。

/**C** 提取文件，但不安装它们。 如果不指定 /**T**: 路径，系统将提示您提供一个目标文件夹。

**/C:&lt;Cmd&gt;** 覆盖作者定义的安装命令。 指定安装程序的 .inf 或 .exe 文件的路径和名称。

/**R:N** 安装后从不重新启动计算机。

**/R:I** 如果需要重新启动计算机，则提示用户重新启动，与 **/Q:A** 一起使用时除外。

/**R:A** 安装后始终重新启动计算机。

/**R:S** 安装后在不提示用户的情况下重新启动计算机。

**/N:V** 不进行版本检查，在任何以前的版本上安装程序。

**注意：**这些开关并不一定适用于所有更新。 如果某开关不可用，则表明该功能是正确安装更新所必需的。 此外，不支持使用 /N:V 开关，它可能会导致系统无法启动。 如果安装失败，您应该咨询您的支持专业人员以了解安装失败的原因。

有关受支持的安装开关的其他信息，请参见 Microsoft 知识库文章 [197147](http://support.microsoft.com/default.aspx?scid=kb;zh-cn;197147)。

**客户端部署信息**  

1.  [下载更新](http://www.microsoft.com/downloads/details.aspx?amp;displaylang=en&familyid=16c2dffd-7b73-43c4-ab0d-2b5efc80eb63&displaylang=en)
2.  单击**“将该程序保存到磁盘”**，然后单击“**确定**”。
3.  单击“**保存**”。
4.  在 Windows 资源管理器中，找到包括已保存文件的文件夹，然后双击这个已保存的文件。
5.  如果系统提示您安装更新，则单击“**是**”。
6.  单击“**是**”接受许可协议。
7.  在系统提示时插入原始源 CD-ROM，然后单击**“确定”**。
8.  当您收到指示安装成功的消息时，单击“**确定**”。

**注意：**如果安全更新已经安装在计算机上，您会收到以下错误消息：**This update has already been applied or is included in an update that has already been applied（此更新已应用，或者包含在已应用的更新中）**。

**客户端安装文件信息**  

此更新的英文版具有下表所列的文件属性（或更高版本）。 这些文件的日期和时间以协调世界时 (UTC) 列出。 当您查看文件信息时，它将转换为本地时间。 要了解 UTC 与本地时间之间的时差，请使用“控制面板”上的“日期/时间”工具中的**“时区”**选项卡。

Visio 2002：

`日期         时间   版本        大小       文件名---------------------------------------------------------02-Mar-2004  21:19  5.1.3102.1360  1,638,400  Gdiplus.dll07-May-2004  21:56  10.0.6714.0    9,796,288  Mso.dll`

**注意：**在将此安全更新安装到 Windows XP 或 Windows Server 2003 上时，只安装 Mso.dll 文件。 Visio 2002 在 Windows XP and Windows Server 2003 上使用 Gdiplus.dll 文件的操作系统版本。 如果您在 Windows XP 或 Windows Server 2003 上使用 Visio 2002，确保安装了安全更新的操作系统版本。 在其他操作系统上安装安全更新时，会同时安装 Gdiplus.dll 文件和 Mso.dll 文件。

**验证更新安装**  

-   **Microsoft Baseline Security Analyzer**  

    要验证受影响的系统上是否安装了安全更新，也许可以使用 Microsoft 基准安全分析器 (MBSA) 工具。使用此工具，管理员可以在本地和远程系统中扫描缺少的安全更新和常见的安全错误配置。 有关 MBSA 的详细信息，请访问 [Microsoft Baseline Security Analyzer 网站](http://go.microsoft.com/fwlink/?linkid=21134)。

-   **文件版本验证**  

    **注意：**由于 Microsoft Windows 有多个版本，因此以下步骤在您的计算机上可能会有所不同。 如果不同，请参阅产品文档来完成这些步骤。

    1.  单击**“开始”**，然后单击**“搜索”**。
    2.  在**“搜索结果”**窗格中，单击**“搜索助理”**下的**“所有文件和文件夹”**。
    3.  在**“完整或部分文件名”**框中，键入相应文件信息表中的一个文件名，然后单击**“搜索”**。
    4.  在文件列表中，用鼠标右键单击相应文件信息表中的一个文件名，然后单击**“属性”**。

        **注意：**取决于安装的操作系统或程序的版本，文件信息表中所列的某些文件可能并未安装。

    5.  在**“版本”**选项卡上，通过将计算机上安装的文件与相应文件信息表中记录的版本进行比较来确定该文件的版本。

        **注意：**在安装过程中，除文件版本以外的其他属性均可能会发生变化。 不支持通过将其他文件属性与文件信息表中的信息进行比较这种方法来验证更新安装。 另外，在某些情况下，在安装过程中还可能会重命名文件。 如果没有文件或版本信息，请使用另外一种方法来验证更新安装。

#### 管理安装信息

如果从服务器位置安装了应用程序，则服务器的管理员必须利用管理更新对服务器位置进行更新，并将该更新部署到您的计算机。

**安装信息**  

以下安装开关与管理安装有关，因为使用这些开关，管理员可以自定义从安全更新内提取文件的方式：

/**?** 显示命令行选项

**/Q**   指定安静模式，或在提取文件时禁止显示提示。

/**T**:**&lt;full path&gt;**   指定用于提取文件的目标文件夹。

/**C** 提取文件，但不安装它们。 如果不指定 /**T**: 路径，系统将提示您提供一个目标文件夹。

**/C:&lt;Cmd&gt;** 覆盖作者定义的安装命令。 指定安装程序的 .inf 或 .exe 文件的路径和名称。

有关受支持的安装开关的其他信息，请参见 Microsoft 知识库文章 [197147](http://support.microsoft.com/default.aspx?scid=kb;zh-cn;197147)。

**管理部署信息**  

要更新您的管理安装，请执行以下步骤：

1.  在 Windows 资源管理器中，在 C 盘创建一个新文件夹，然后命名为 KB831932。
2.  [下载更新](http://www.microsoft.com/downloads/details.aspx?familyid=16c2dffd-7b73-43c4-ab0d-2b5efc80eb63&displaylang=en)。
3.  单击**“将该程序保存到磁盘 ”**，将 Visio2002-KB831932-FullFile-ENU.exe 文件保存到 C:\\KB831932 文件夹中。
4.  单击**“开始”**，单击**“运行”**，在**“打开”**框中键入 **cmd**，然后单击**“确定”**。 （如果使用 Windows 98、Windows 98 SE 或 Windows Millennium Edition，用 **command.com** 替代 **cmd**。）
5.  在命令提示符后，键入下列行，并在每个行之后按下 ENTER 键：

    cd\\kb831932

    Visio2002-KB831932-FullFile-ENU.exe /c /t:c:\\kb831932

6.  单击“**是**”接受许可协议。
7.  在命令方式下，键入以下行，然后按 ENTER：

    exit

8.  如果您熟悉用于更新管理安装的过程，请单击“**开始**”，然后单击“**运行**”。 在“打开”框中键入以下命令

    msiexec /a Admin Path\\MSI File /p C:\\kb831932\\Visio2002-KB831932-FullFile.MSP

    其中 Admin Path 是您的应用程序的管理安装点的路径（例如 C:\\Visio），MSI File 是用于该应用程序的 .msi 数据库包（例如 Visio.msi），MSP File 是管理更新的名称（例如 Visio2002-KB831932-FullFile.MSP）。

    **注意：**可以在命令行后附加 **/qb+**，以使**“管理安装”**对话框和**“最终用户协议”**对话框不出现。

9.  在提供的对话框中单击**“下一步”** 。 在提供的对话框中不要更改您的 CD 密钥、安装位置或公司名。
10. 单击**“我接受许可协议条款”**，然后单击**“安装”**。

此时，您的管理安装点即更新。 接下来，您必须更新原先从该管理安装中安装的工作站。 为此，请查看“工作站部署”部分。 您从该管理安装点运行的任何新安装都将包括该更新。

**警告：**对于您在安装更新之前从此管理安装中安装的任何工作站，如果不为该工作站完成“工作站部署”部分中的步骤，这些工作站就无法使用此管理安装执行修补 Office、新增功能等操作。

**工作站部署信息**  

要将更新部署到客户机工作站，请单击“**开始**”，然后单击“**运行**”。 在**“打开”**框中键入以下命令：

msiexec /i Admin Path\\MSI File /qb REINSTALL=Feature List REINSTALLMODE=vomu

其中 Admin Path 是您的应用程序的管理安装点的路径（例如，C:\\Visiot），MSI File 是用于该应用程序的 MSI 数据库包（例如，Visio.msi），Feature List 是必须为更新重新安装的功能名称（区分大小写）的列表。 要安装所有功能，您可以使用 **REINSTALL=ALL**。

**注意：**Microsoft 知识库文章 [831932](http://support.microsoft.com/default.aspx?scid=kb;zh-cn;831932) 提供其他说明。 有关在企业环境中部署更新的信息也可以在 [Microsoft Office 资源工具箱](http://www.microsoft.com/resources/documentation/office/xp/all/reskit/en-us/default.mspx)或 [Microsoft Visio 2002 资源工具箱](http://www.microsoft.com/downloads/details.aspx?familyid=789f348a-1cf1-4794-9f45-43d1ad4eb219&displaylang=en)中找到。 [Windows 安装程序文档](http://go.microsoft.com/fwlink/?linkid=21685)也提供关于 Windows 安装程序支持的参数的其他信息。

**管理安装文件信息**  

此更新的英文版具有下表所列的文件属性（或更高版本）。 这些文件的日期和时间以协调世界时 (UTC) 列出。 当您查看文件信息时，它将转换为本地时间。 要了解 UTC 与本地时间之间的时差，请使用“控制面板”上的“日期/时间”工具中的**“时区”**选项卡。

Visio 2002：

`日期         时间   版本        大小       文件名----------------------------------------------------------02-Mar-2004  21:19  5.1.3102.1360  1,638,400  Gdiplus.dll07-May-2004  21:56  10.0.6714.0    9,796,288  Mso.dll`

**验证更新安装**  

-   **Microsoft Baseline Security Analyzer**  

    要验证受影响的系统上是否安装了安全更新，也许可以使用 Microsoft 基准安全分析器 (MBSA) 工具。使用此工具，管理员可以在本地和远程系统中扫描缺少的安全更新和常见的安全错误配置。 有关 MBSA 的详细信息，请访问 [Microsoft Baseline Security Analyzer 网站](http://go.microsoft.com/fwlink/?linkid=21134)。

-   **文件版本验证**  

    **注意：**由于 Microsoft Windows 有多个版本，因此以下步骤在您的计算机上可能会有所不同。 如果不同，请参阅产品文档来完成这些步骤。

    1.  单击**“开始”**，然后单击**“搜索”**。
    2.  在**“搜索结果”**窗格中，单击**“搜索助理”**下的**“所有文件和文件夹”**。
    3.  在**“完整或部分文件名”**框中，键入相应文件信息表中的一个文件名，然后单击**“搜索”**。
    4.  在文件列表中，用鼠标右键单击相应文件信息表中的一个文件名，然后单击**“属性”**。

        **注意：**取决于安装的操作系统或程序的版本，文件信息表中所列的某些文件可能并未安装。

    5.  在**“版本”**选项卡上，通过将计算机上安装的文件与相应文件信息表中记录的版本进行比较来确定该文件的版本。

        **注意：**在安装过程中，除文件版本以外的其他属性均可能会发生变化。 不支持通过将其他文件属性与文件信息表中的信息进行比较这种方法来验证更新安装。 另外，在某些情况下，在安装过程中还可能会重命名文件。 如果没有文件或版本信息，请使用另外一种方法来验证更新安装。

#### Office 2003（Office 2003 Service Pack 1 除外的所有版本）

#### 先决条件和其他更新详细信息

**重要事项：**在您安装此更新之前，请确保符合以下要求：

-   必须安装 Microsoft Windows Installer 2.0。 Microsoft Windows Server 2003、Windows XP 和 Microsoft Windows 2000 Service Pack 3 (SP3) 都包含了 Windows 安装程序 2.0 或更高版本。 要安装最新版本的 Windows 安装程序，请访问下列 Microsoft Web 站点之一。

    [Windows 95、Windows 98、Windows 98 SE 和 Windows Millennium Edition 的 Windows Installer 2.0](http://www.microsoft.com/downloads/release.asp?releaseid=32831)

    [Windows 2000 和 Windows NT 4.0 的 Windows Installer 2.0](http://www.microsoft.com/downloads/release.asp?releaseid=32832)

有关如何确定计算机上的 Office 2003 版本的其他信息，请参见 Microsoft 知识库文章 [821549](http://support.microsoft.com/default.aspx?scid=kb;%5bln%5d;821549)。

**注意：**虽然安全更新安装用户界面是英文界面，但是此更新的管理版本包括有支持在受影响的产品的本地化版本上进行安装所必需的文件。

**包括在将来的 Service Pack 中：**  

此问题的修补程序包含在 [Microsoft Office 2003 Service Pack 1](http://www.microsoft.com/downloads/details.aspx?familyid=9c51d3a6-7cb1-4f61-837e-5f938254fc47&displaylang=en) 中。

**重新启动要求**  

无需重新启动。

**删除信息**  

安装更新后，无法删除它。 要在安装更新前还原安装，您必须删除该应用程序，然后通过原始的 CD-ROM 重新安装它。

#### 自动化客户端安装信息

**Office Update Web 站点**  

Microsoft 建议您通过 [Office Update Web 站点](http://go.microsoft.com/fwlink/?linkid=21135)安装 [Microsoft Office 2003 Service Pack 1](http://www.microsoft.com/downloads/details.aspx?familyid=9c51d3a6-7cb1-4f61-837e-5f938254fc47&displaylang=en)。 Office Update Web 站点会检测您安装的特定程序，并提示您确切安装必须安装的更新，以确保所安装的程序彻底是最新的。

让 Office Update Web 站点检测您必须在计算机上安装的更新，请访问 [Office Update Web 站点](http://go.microsoft.com/fwlink/?linkid=21135)，然后单击“**检查更新**”。 检测完成后，您会收到供您认可的建议更新列表。 单击“**开始安装**”以完成更新过程。

#### 手动客户端安装信息

有关如何手动安装此更新的详细信息，请查看以下部分。

**安装信息**  

此安全更新支持以下安装开关：

**/Q**   指定安静模式，或在提取文件时禁止显示提示。

**/Q:U**   指定用户安静模式，该模式向用户显示某些对话框。

**/Q:A**   指定管理员安静模式，该模式不向用户显示任何对话框。

/**T**:**&lt;full path&gt;**   指定用于提取文件的目标文件夹。

/**C** 提取文件，但不安装它们。 如果不指定 /**T**: 路径，系统将提示您提供一个目标文件夹。

**/C:&lt;Cmd&gt;** 覆盖作者定义的安装命令。 指定安装程序的 .inf 或 .exe 文件的路径和名称。

/**R:N** 安装后从不重新启动计算机。

**/R:I**   如果需要重新启动计算机，则提示用户重新启动，与 **/Q:A** 一起使用时除外。

/**R:A** 安装后始终重新启动计算机。

/**R:S** 安装后在不提示用户的情况下重新启动计算机。

**/N:V** 不进行版本检查，在任何以前的版本上安装程序。

**注意：**这些开关并不一定适用于所有更新。 如果某开关不可用，则表明该功能是正确安装更新所必需的。 此外，不支持使用 /N:V 开关，它可能会导致系统无法启动。 如果安装失败，您应该咨询您的支持专业人员以了解安装失败的原因。

有关受支持的安装开关的其他信息，请参见 Microsoft 知识库文章 [197147](http://support.microsoft.com/default.aspx?scid=kb;zh-cn;197147)。

**客户端部署信息**  

1.  [下载此安全更新的客户端版本](http://download.microsoft.com/download/7/f/c/7fc52236-a81d-4e26-b6b3-06e2133f6541/office2003-kb838905-client-enu.exe)。
2.  单击**“将该程序保存到磁盘”**，然后单击“**确定**”。
3.  单击“**保存**”。
4.  在 Windows 资源管理器中，找到包括已保存文件的文件夹，然后双击这个已保存的文件。
5.  如果系统提示您安装更新，则单击“**是**”。
6.  单击“**是**”接受许可协议。
7.  在系统提示时插入原始源 CD-ROM，然后单击**“确定”**。
8.  当您收到指示安装成功的消息时，单击“**确定**”。

**注意：**如果安全更新已经安装在计算机上，您会收到以下错误消息：**This update has already been applied or is included in an update that has already been applied（此更新已应用，或者包含在已应用的更新中）**。

**客户端安装文件信息**  

此更新的英文版具有下表所列的文件属性（或更高版本）。 这些文件的日期和时间以协调世界时 (UTC) 列出。 当您查看文件信息时，它将转换为本地时间。 要了解 UTC 与本地时间之间的时差，请使用“控制面板”上的“日期/时间”工具中的**“时区”**选项卡。

Office 2003：

`日期         时间   版本     大小       文件名--------------------------------------------------------28-Feb-2004  19:16  6.0.3264.0  1,773,568  gdiplus.dll`

**验证更新安装**  

-   **Microsoft Baseline Security Analyzer**  

    要验证受影响的系统上是否安装了安全更新，也许可以使用 Microsoft 基准安全分析器 (MBSA) 工具。使用此工具，管理员可以在本地和远程系统中扫描缺少的安全更新和常见的安全错误配置。 有关 MBSA 的详细信息，请访问 [Microsoft Baseline Security Analyzer 网站](http://go.microsoft.com/fwlink/?linkid=21134)。

-   **文件版本验证**  

    **注意：**由于 Microsoft Windows 有多个版本，因此以下步骤在您的计算机上可能会有所不同。 如果不同，请参阅产品文档来完成这些步骤。

    1.  单击**“开始”**，然后单击**“搜索”**。
    2.  在**“搜索结果”**窗格中，单击**“搜索助理”**下的**“所有文件和文件夹”**。
    3.  在**“完整或部分文件名”**框中，键入相应文件信息表中的一个文件名，然后单击**“搜索”**。
    4.  在文件列表中，用鼠标右键单击相应文件信息表中的一个文件名，然后单击**“属性”**。

        **注意：**取决于安装的操作系统或程序的版本，文件信息表中所列的某些文件可能并未安装。

    5.  在**“版本”**选项卡上，通过将计算机上安装的文件与相应文件信息表中记录的版本进行比较来确定该文件的版本。

        **注意：**在安装过程中，除文件版本以外的其他属性均可能会发生变化。 不支持通过将其他文件属性与文件信息表中的信息进行比较这种方法来验证更新安装。 另外，在某些情况下，在安装过程中还可能会重命名文件。 如果没有文件或版本信息，请使用另外一种方法来验证更新安装。

#### 管理安装信息

如果从服务器位置安装了应用程序，则服务器的管理员必须利用管理更新对服务器位置进行更新，并将该更新部署到您的计算机。

**安装信息**  

以下安装开关与管理安装有关，因为使用这些开关，管理员可以自定义从安全更新内提取文件的方式：

/**?** 显示命令行选项

**/Q**   指定安静模式，或在提取文件时禁止显示提示。

/**T**:**&lt;full path&gt;**   指定用于提取文件的目标文件夹。

/**C** 提取文件，但不安装它们。 如果不指定 /**T**: 路径，系统将提示您提供一个目标文件夹。

**/C:&lt;Cmd&gt;** 覆盖作者定义的安装命令。 指定安装程序的 .inf 或 .exe 文件的路径和名称。

有关受支持的安装开关的其他信息，请参见 Microsoft 知识库文章 [197147](http://support.microsoft.com/default.aspx?scid=kb;zh-cn;197147)。

**管理部署信息**  

要更新您的管理安装，请执行以下步骤：

1.  [下载此安全更新的管理版本。](http://download.microsoft.com/download/7/f/c/7fc52236-a81d-4e26-b6b3-06e2133f6541/office2003-kb838905-fullfile-enu.exe)
2.  单击**“将该程序保存到磁盘”**，然后单击“**确定**”。
3.  单击“**保存**”。
4.  在 Windows 资源管理器中，找到包括已保存文件的文件夹，然后双击这个已保存的文件。
5.  如果系统提示您安装更新，则单击“**是**”。
6.  单击“**是**”接受许可协议。
7.  在**“请键入放置提取文件的位置”**框中，键入 c:\\adminUpdate，然后单击**“确定”**。
8.  当系统提示您创建该文件夹时，单击**“是”**。
9.  如果您熟悉用于更新管理安装的过程，请单击“**开始**”，然后单击“**运行**”。 在“打开”框中键入以下命令

    msiexec /a Admin Path\\MSI File /p C:\\adminUpdate\\MSP File SHORTFILENAMES=TRUE

    其中 Admin Path 是您的应用程序的管理安装点的路径（例如 C:\\Office2003），MSI File 是用于该应用程序的 .msi 数据库包（例如 Data1.msi），MSP File 是管理更新的名称（例如 SHAREDff.msp）。

    **注意：**可以在命令行后附加 **/qb+**，以使**“管理安装”**对话框和**“最终用户协议”**对话框不出现。

10. 在提供的对话框中单击**“下一步”** 。 在提供的对话框中不要更改您的 CD 密钥、安装位置或公司名。
11. 单击**“我接受许可协议条款”**，然后单击**“安装”**。

此时，您的管理安装点即更新。 接下来，您必须更新原先从该管理安装中安装的工作站。 为此，请查看“工作站部署”部分。 您从该管理安装点运行的任何新安装都将包括该更新。

**警告：**对于您在安装更新之前从此管理安装中安装的任何工作站，如果不为该工作站完成“工作站部署”部分中的步骤，这些工作站就无法使用此管理安装执行修补 Office、新增功能等操作。

**工作站部署信息**  

要将更新部署到客户机工作站，请单击“**开始**”，然后单击“**运行**”。 在**“打开”**框中键入以下命令：

msiexec /i Admin Path\\MSI File /qb REINSTALL=Feature List REINSTALLMODE=vomu /qb

其中 Admin Path 是您的应用程序的管理安装点的路径（例如，C:\\Office2003），MSI File 是用于该应用程序的 MSI 数据库包（例如，Data1.msi），Feature List 是必须为更新重新安装的功能名称（区分大小写）的列表。 要安装所有功能，您可以使用 **REINSTALL=ALL**。

**注意：**Microsoft 知识库文章 [838905](http://support.microsoft.com/default.aspx?scid=kb;zh-cn;838905) 提供其他说明。 [Windows 安装程序文档](http://go.microsoft.com/fwlink/?linkid=21685)也提供关于 Windows 安装程序支持的参数的其他信息。

**管理安装文件信息**  

此更新的英文版具有下表所列的文件属性（或更高版本）。 这些文件的日期和时间以协调世界时 (UTC) 列出。 当您查看文件信息时，它将转换为本地时间。 要了解 UTC 与本地时间之间的时差，请使用“控制面板”上的“日期/时间”工具中的**“时区”**选项卡。

Office 2003：

`日期         时间   版本     大小       文件名--------------------------------------------------------28-Feb-2004  19:16  6.0.3264.0  1,773,568  gdiplus.dll`

**验证更新安装**  

-   **Microsoft Baseline Security Analyzer**  

    要验证受影响的系统上是否安装了安全更新，也许可以使用 Microsoft 基准安全分析器 (MBSA) 工具。使用此工具，管理员可以在本地和远程系统中扫描缺少的安全更新和常见的安全错误配置。 有关 MBSA 的详细信息，请访问 [Microsoft Baseline Security Analyzer 网站](http://go.microsoft.com/fwlink/?linkid=21134)。

-   **文件版本验证**  

    **注意：**由于 Microsoft Windows 有多个版本，因此以下步骤在您的计算机上可能会有所不同。 如果不同，请参阅产品文档来完成这些步骤。

    1.  单击**“开始”**，然后单击**“搜索”**。
    2.  在**“搜索结果”**窗格中，单击**“搜索助理”**下的**“所有文件和文件夹”**。
    3.  在**“完整或部分文件名”**框中，键入相应文件信息表中的一个文件名，然后单击**“搜索”**。
    4.  在文件列表中，用鼠标右键单击相应文件信息表中的一个文件名，然后单击**“属性”**。

        **注意：**取决于安装的操作系统或程序的版本，文件信息表中所列的某些文件可能并未安装。

    5.  在**“版本”**选项卡上，通过将计算机上安装的文件与相应文件信息表中记录的版本进行比较来确定该文件的版本。

        **注意：**在安装过程中，除文件版本以外的其他属性均可能会发生变化。 不支持通过将其他文件属性与文件信息表中的信息进行比较这种方法来验证更新安装。 另外，在某些情况下，在安装过程中还可能会重命名文件。 如果没有文件或版本信息，请使用另外一种方法来验证更新安装。

#### Project 2003（Project 2003 Service Pack 1 除外的所有版本）

#### 先决条件和其他更新详细信息

**重要事项：**在您安装此更新之前，请确保符合以下要求：

-   必须安装 Microsoft Windows Installer 2.0。 Microsoft Windows Server 2003、Windows XP 和 Microsoft Windows 2000 Service Pack 3 (SP3) 都包含了 Windows 安装程序 2.0 或更高版本。 要安装最新版本的 Windows 安装程序，请访问下列 Microsoft Web 站点之一。

    [Windows 95、Windows 98、Windows 98 SE 和 Windows Millennium 的 Windows Installer 2.0](http://www.microsoft.com/downloads/release.asp?releaseid=32831)

    [Windows 2000 和 Windows NT 4.0 的 Windows Installer 2.0](http://www.microsoft.com/downloads/release.asp?releaseid=32832)

-   必须安装 Microsoft Project Standard 2003 或 Microsoft Project Professional 2003。

**注意：**虽然安全更新安装用户界面是英文界面，但是此更新的管理版本包括有支持在受影响的产品的本地化版本上进行安装所必需的文件。

**包括在将来的 Service Pack 中：**  

此问题的修补程序包含在 [Microsoft Project 2003 Service Pack 1](http://www.microsoft.com/downloads/details.aspx?familyid=1b04c073-e58f-4f42-b76d-6b565a45cdc3&displaylang=en) 中。

**重新启动要求**  

无需重新启动。

**删除信息**  

安装更新后，无法删除它。 要在安装更新前还原安装，您必须删除该应用程序，然后通过原始的 CD-ROM 重新安装它。

#### 自动化客户端安装信息

**Office Update Web 站点**  

Microsoft 建议您通过 [Office Update Web 站点](http://go.microsoft.com/fwlink/?linkid=21135)安装 [Microsoft Project 2003 Service Pack 1](http://www.microsoft.com/downloads/details.aspx?familyid=1b04c073-e58f-4f42-b76d-6b565a45cdc3&displaylang=en)。 Office Update Web 站点会检测您安装的特定程序，并提示您确切安装必须安装的更新，以确保所安装的程序彻底是最新的。

让 Office Update Web 站点检测您必须在计算机上安装的更新，请访问 [Office Update Web 站点](http://go.microsoft.com/fwlink/?linkid=21135)，然后单击“**检查更新**”。 检测完成后，您会收到供您认可的建议更新列表。 单击“**开始安装**”以完成更新过程。

#### 手动客户端安装信息

有关如何手动安装此更新的详细信息，请查看以下部分。

**安装信息**  

此安全更新支持以下安装开关：

**/Q**   指定安静模式，或在提取文件时禁止显示提示。

**/Q:U**   指定用户安静模式，该模式向用户显示某些对话框。

**/Q:A**   指定管理员安静模式，该模式不向用户显示任何对话框。

/**T**:**&lt;full path&gt;**   指定用于提取文件的目标文件夹。

/**C** 提取文件，但不安装它们。 如果不指定 /**T**: 路径，系统将提示您提供一个目标文件夹。

**/C:&lt;Cmd&gt;** 覆盖作者定义的安装命令。 指定安装程序的 .inf 或 .exe 文件的路径和名称。

/**R:N** 安装后从不重新启动计算机。

**/R:I**   如果需要重新启动计算机，则提示用户重新启动，与 **/Q:A** 一起使用时除外。

/**R:A** 安装后始终重新启动计算机。

/**R:S** 安装后在不提示用户的情况下重新启动计算机。

**/N:V** 不进行版本检查，在任何以前的版本上安装程序。

**注意：**这些开关并不一定适用于所有更新。 如果某开关不可用，则表明该功能是正确安装更新所必需的。 此外，不支持使用 /N:V 开关，它可能会导致系统无法启动。 如果安装失败，您应该咨询您的支持专业人员以了解安装失败的原因。

有关受支持的安装开关的其他信息，请参见 Microsoft 知识库文章 [197147](http://support.microsoft.com/default.aspx?scid=kb;zh-cn;197147)。

**客户端部署信息**  

1.  [下载更新](http://download.microsoft.com/download/9/3/3/93319163-1298-4ad4-a0a1-743c8e0a58db/project2003-kb838344-fullfile-enu.exe)。
2.  单击**“将该程序保存到磁盘”**，然后单击“**确定**”。
3.  单击“**保存**”。
4.  在 Windows 资源管理器中，找到包括已保存文件的文件夹，然后双击这个已保存的文件。
5.  如果系统提示您安装更新，则单击“**是**”。
6.  单击“**是**”接受许可协议。
7.  在系统提示时插入原始源 CD-ROM，然后单击**“确定”**。
8.  当您收到指示安装成功的消息时，单击“**确定**”。

**注意：**如果安全更新已经安装在计算机上，您会收到以下错误消息：**This update has already been applied or is included in an update that has already been applied（此更新已应用，或者包含在已应用的更新中）**。

**客户端安装文件信息**  

此更新的英文版具有下表所列的文件属性（或更高版本）。

Project 2003：

`日期         时间   版本     大小       文件名--------------------------------------------------------28-Feb-2004  19:16  6.0.3264.0  1,773,568  gdiplus.dll`

**验证更新安装**  

-   **Microsoft Baseline Security Analyzer**  

    要验证受影响的系统上是否安装了安全更新，也许可以使用 Microsoft 基准安全分析器 (MBSA) 工具。使用此工具，管理员可以在本地和远程系统中扫描缺少的安全更新和常见的安全错误配置。 有关 MBSA 的详细信息，请访问 [Microsoft Baseline Security Analyzer 网站](http://go.microsoft.com/fwlink/?linkid=21134)。

-   **文件版本验证**  

    **注意：**由于 Microsoft Windows 有多个版本，因此以下步骤在您的计算机上可能会有所不同。 如果不同，请参阅产品文档来完成这些步骤。

    1.  单击**“开始”**，然后单击**“搜索”**。
    2.  在**“搜索结果”**窗格中，单击**“搜索助理”**下的**“所有文件和文件夹”**。
    3.  在**“完整或部分文件名”**框中，键入相应文件信息表中的一个文件名，然后单击**“搜索”**。
    4.  在文件列表中，用鼠标右键单击相应文件信息表中的一个文件名，然后单击**“属性”**。

        **注意：**取决于安装的操作系统或程序的版本，文件信息表中所列的某些文件可能并未安装。

    5.  在**“版本”**选项卡上，通过将计算机上安装的文件与相应文件信息表中记录的版本进行比较来确定该文件的版本。

        **注意：**在安装过程中，除文件版本以外的其他属性均可能会发生变化。 不支持通过将其他文件属性与文件信息表中的信息进行比较这种方法来验证更新安装。 另外，在某些情况下，在安装过程中还可能会重命名文件。 如果没有文件或版本信息，请使用另外一种方法来验证更新安装。

#### 管理安装信息

如果从服务器位置安装了应用程序，则服务器的管理员必须利用管理更新对服务器位置进行更新，并将该更新部署到您的计算机。

**安装信息**  

以下安装开关与管理安装有关，因为使用这些开关，管理员可以自定义从安全更新内提取文件的方式：

/**?** 显示命令行选项

**/Q**   指定安静模式，或在提取文件时禁止显示提示。

/**T**:**&lt;full path&gt;**   指定用于提取文件的目标文件夹。

/**C** 提取文件，但不安装它们。 如果不指定 /**T**: 路径，系统将提示您提供一个目标文件夹。

**/C:&lt;Cmd&gt;** 覆盖作者定义的安装命令。 指定安装程序的 .inf 或 .exe 文件的路径和名称。

有关受支持的安装开关的其他信息，请参见 Microsoft 知识库文章 [197147](http://support.microsoft.com/default.aspx?scid=kb;zh-cn;197147)。

**管理部署信息**  

要更新您的管理安装，请执行以下步骤：

1.  在 Windows 资源管理器中，在 C 区创建一个新文件夹，然后命名为 KB838344。
2.  [下载更新](http://download.microsoft.com/download/9/3/3/93319163-1298-4ad4-a0a1-743c8e0a58db/project2003-kb838344-fullfile-enu.exe)。
3.  单击**“将该程序保存到磁盘 ”**，将 Project2003-kb838344-fullfile-enu.exe 文件保存到 C:\\KB838344 文件夹。
4.  单击**“开始”**，单击**“运行”**，在**“打开”**框中键入 **cmd**，然后单击**“确定”**。 （如果使用 Windows 98、Windows 98 SE 或 Windows Millennium Edition，用 **command.com** 替代 **cmd**。）
5.  在命令提示符后，键入下列行，并在每个行之后按下 ENTER 键：

    cd\\kb838344

    Project2003-kb838344-FullFile-ENU.exe /c /t:c:\\kb838344

6.  单击 **Yes**（是）接受许可协议。
7.  在命令方式下，键入以下行，然后按 ENTER：

    exit

8.  如果您熟悉用于更新管理安装的过程，请单击“**开始**”，然后单击“**运行**”。 在“打开”框中键入以下命令

    msiexec /a Admin Path\\MSI File /p C:\\kb838344\\MSP File SHORTFILENAMES=TRUE

    其中 Admin Path 是您的应用程序的管理安装点的路径（例如 C:\\Project），MSI File 是用于该应用程序的 .msi 数据库包（例如 Prjproe.msi），MSP File 是管理更新的名称（例如 MSO.MSP）。

    **注意：**可以在命令行后附加 **/qb+**，以使**“管理安装”**对话框和**“最终用户协议”**对话框不出现。

9.  在提供的对话框中单击**“下一步”** 。 在提供的对话框中不要更改您的 CD 密钥、安装位置或公司名。
10. 单击**“我接受许可协议条款”**，然后单击**“安装”**。

此时，您的管理安装点即更新。 接下来，您必须更新原先从该管理安装中安装的工作站。 为此，请查看“工作站部署”部分。 您从该管理安装点运行的任何新安装都将包括该更新。

**警告：**对于您在安装更新之前原先从该管理安装中安装的任何工作站，如果不为该工作站完成“工作站部署”部分中的步骤，这些工作站就无法利用该管理安装执行修补 Office、新增功能等操作。

**工作站部署信息**  

要将更新部署到客户机工作站，请单击“**开始**”，然后单击“**运行**”。 在**“打开”**框中键入以下命令：

msiexec /i Admin Path\\MSI File /qb REINSTALL=Feature List REINSTALLMODE=vomu

其中 Admin Path 是您的应用程序的管理安装点的路径（例如，C:\\Project），MSI File 是用于该应用程序的 MSI 数据库包（例如，Prjproe.msi），Feature List 是必须为更新重新安装的功能名称（区分大小写）的列表。 要安装所有功能，您可以使用 **REINSTALL=ALL**。

**注意：**Microsoft 知识库文章 [838344](http://support.microsoft.com/default.aspx?scid=kb;zh-cn;838344) 提供其他说明。 [Windows 安装程序文档](http://go.microsoft.com/fwlink/?linkid=21685)也提供关于 Windows 安装程序支持的参数的其他信息。

**管理安装文件信息**  

此更新的英文版具有下表所列的文件属性（或更高版本）。

Project 2003：

`日期         时间   版本     大小       文件名--------------------------------------------------------28-Feb-2004  19:16  6.0.3264.0  1,773,568  gdiplus.dll`

**验证更新安装**  

-   **Microsoft Baseline Security Analyzer**  

    要验证受影响的系统上是否安装了安全更新，也许可以使用 Microsoft 基准安全分析器 (MBSA) 工具。使用此工具，管理员可以在本地和远程系统中扫描缺少的安全更新和常见的安全错误配置。 有关 MBSA 的详细信息，请访问 [Microsoft Baseline Security Analyzer 网站](http://go.microsoft.com/fwlink/?linkid=21134)。

-   **文件版本验证**  

    **注意：**由于 Microsoft Windows 有多个版本，因此以下步骤在您的计算机上可能会有所不同。 如果不同，请参阅产品文档来完成这些步骤。

    1.  单击**“开始”**，然后单击**“搜索”**。
    2.  在**“搜索结果”**窗格中，单击**“搜索助理”**下的**“所有文件和文件夹”**。
    3.  在**“完整或部分文件名”**框中，键入相应文件信息表中的一个文件名，然后单击**“搜索”**。
    4.  在文件列表中，用鼠标右键单击相应文件信息表中的一个文件名，然后单击**“属性”**。

        **注意：**取决于安装的操作系统或程序的版本，文件信息表中所列的某些文件可能并未安装。

    5.  在**“版本”**选项卡上，通过将计算机上安装的文件与相应文件信息表中记录的版本进行比较来确定该文件的版本。

        **注意：**在安装过程中，除文件版本以外的其他属性均可能会发生变化。 不支持通过将其他文件属性与文件信息表中的信息进行比较这种方法来验证更新安装。 另外，在某些情况下，在安装过程中还可能会重命名文件。 如果没有文件或版本信息，请使用另外一种方法来验证更新安装。

#### Visio 2003（Visio 2003 Service Pack 1 除外的所有版本）

#### 先决条件和其他更新详细信息

**重要事项：**在您安装此更新之前，请确保符合以下要求：

-   必须安装 Microsoft Windows Installer 2.0。 Microsoft Windows Server 2003、Windows XP 和 Microsoft Windows 2000 Service Pack 3 (SP3) 都包含了 Windows 安装程序 2.0 或更高版本。 要安装最新版本的 Windows 安装程序，请访问下列 Microsoft Web 站点之一。

    [Windows 95、Windows 98、Windows 98 SE 和 Windows Millennium 的 Windows Installer 2.0](http://www.microsoft.com/downloads/release.asp?releaseid=32831)

    [Windows 2000 和 Windows NT 4.0 的 Windows Installer 2.0](http://www.microsoft.com/downloads/release.asp?releaseid=32832)

-   必须安装 Microsoft Visio 2003 标准版或 Microsoft Visio 2003 专业版

**注意：**虽然安全更新安装用户界面是英文界面，但是此更新的管理版本包括有支持在受影响的产品的本地化版本上进行安装所必需的文件。

**包括在将来的 Service Pack 中：**  

这个问题的修补程序包括在 [Microsoft Visio 2003 Service Pack 1](http://www.microsoft.com/downloads/details.aspx?familyid=afca0578-e1fb-4540-b0cc-ff83def61cc6&displaylang=en) 中。

**重新启动要求**  

无需重新启动。

**删除信息**  

安装更新后，无法删除它。 要在安装更新前还原安装，您必须删除该应用程序，然后通过原始的 CD-ROM 重新安装它。

#### 自动化客户端安装信息

**Office Update Web 站点**  

Microsoft 建议您通过 [Office Update Web 站点](http://go.microsoft.com/fwlink/?linkid=21135)安装 Microsoft Visio 2003 [Service Pack 1](http://www.microsoft.com/downloads/details.aspx?familyid=afca0578-e1fb-4540-b0cc-ff83def61cc6&displaylang=en)。 Office Update Web 站点会检测您安装的特定程序，并提示您确切安装必须安装的更新，以确保所安装的程序彻底是最新的。

让 Office Update Web 站点检测您必须在计算机上安装的更新，请访问 [Office Update Web 站点](http://go.microsoft.com/fwlink/?linkid=21135)，然后单击“**检查更新**”。 检测完成后，您会收到供您认可的建议更新列表。 单击“**开始安装**”以完成更新过程。

#### 手动客户端安装信息

有关如何手动安装此更新的详细信息，请查看以下部分。

**安装信息**  

此安全更新支持以下安装开关：

**/Q**   指定安静模式，或在提取文件时禁止显示提示。

**/Q:U**   指定用户安静模式，该模式向用户显示某些对话框。

**/Q:A**   指定管理员安静模式，该模式不向用户显示任何对话框。

/**T**:**&lt;full path&gt;**   指定用于提取文件的目标文件夹。

/**C** 提取文件，但不安装它们。 如果不指定 /**T**: 路径，系统将提示您提供一个目标文件夹。

**/C:&lt;Cmd&gt;** 覆盖作者定义的安装命令。 指定安装程序的 .inf 或 .exe 文件的路径和名称。

/**R:N** 安装后从不重新启动计算机。

**/R:I**   如果需要重新启动计算机，则提示用户重新启动，与 **/Q:A** 一起使用时除外。

/**R:A** 安装后始终重新启动计算机。

/**R:S** 安装后在不提示用户的情况下重新启动计算机。

**/N:V** 不进行版本检查，在任何以前的版本上安装程序。

**注意：**这些开关并不一定适用于所有更新。 如果某开关不可用，则表明该功能是正确安装更新所必需的。 此外，不支持使用 /N:V 开关，它可能会导致系统无法启动。 如果安装失败，您应该咨询您的支持专业人员以了解安装失败的原因。

有关受支持的安装开关的其他信息，请参见 Microsoft 知识库文章 [197147](http://support.microsoft.com/default.aspx?scid=kb;zh-cn;197147)。

**客户端部署信息**  

1.  [下载更新](http://download.microsoft.com/download/1/6/9/16937bf3-8711-4bf4-9fa0-6924d0260806/visio2003-kb838345-fullfile-enu.exe)。
2.  单击**“将该程序保存到磁盘”**，然后单击“**确定**”。
3.  单击“**保存**”。
4.  在 Windows 资源管理器中，找到包括已保存文件的文件夹，然后双击这个已保存的文件。
5.  如果系统提示您安装更新，则单击“**是**”。
6.  单击“**是**”接受许可协议。
7.  在系统提示时插入原始源 CD-ROM，然后单击**“确定”**。
8.  当您收到指示安装成功的消息时，单击“**确定**”。

**注意：**如果安全更新已经安装在计算机上，您会收到以下错误消息：**This update has already been applied or is included in an update that has already been applied（此更新已应用，或者包含在已应用的更新中）**。

**客户端安装文件信息**  

此更新的英文版具有下表所列的文件属性（或更高版本）。 这些文件的日期和时间以协调世界时 (UTC) 列出。 当您查看文件信息时，它将转换为本地时间。 要了解 UTC 与本地时间之间的时差，请使用“控制面板”上的“日期/时间”工具中的**“时区”**选项卡。

Visio 2003：

`日期         时间   版本     大小       文件名--------------------------------------------------------28-Feb-2004  19:16  6.0.3264.0  1,773,568  gdiplus.dll`

**验证更新安装**  

-   **Microsoft Baseline Security Analyzer**  

    要验证受影响的系统上是否安装了安全更新，也许可以使用 Microsoft 基准安全分析器 (MBSA) 工具。使用此工具，管理员可以在本地和远程系统中扫描缺少的安全更新和常见的安全错误配置。 有关 MBSA 的详细信息，请访问 [Microsoft Baseline Security Analyzer 网站](http://go.microsoft.com/fwlink/?linkid=21134)。

-   **文件版本验证**  

    **注意：**由于 Microsoft Windows 有多个版本，因此以下步骤在您的计算机上可能会有所不同。 如果不同，请参阅产品文档来完成这些步骤。

    1.  单击**“开始”**，然后单击**“搜索”**。
    2.  在**“搜索结果”**窗格中，单击**“搜索助理”**下的**“所有文件和文件夹”**。
    3.  在**“完整或部分文件名”**框中，键入相应文件信息表中的一个文件名，然后单击**“搜索”**。
    4.  在文件列表中，用鼠标右键单击相应文件信息表中的一个文件名，然后单击**“属性”**。

        **注意：**取决于安装的操作系统或程序的版本，文件信息表中所列的某些文件可能并未安装。

    5.  在**“版本”**选项卡上，通过将计算机上安装的文件与相应文件信息表中记录的版本进行比较来确定该文件的版本。

        **注意：**在安装过程中，除文件版本以外的其他属性均可能会发生变化。 不支持通过将其他文件属性与文件信息表中的信息进行比较这种方法来验证更新安装。 另外，在某些情况下，在安装过程中还可能会重命名文件。 如果没有文件或版本信息，请使用另外一种方法来验证更新安装。

#### 管理安装信息

如果从服务器位置安装了应用程序，则服务器的管理员必须利用管理更新对服务器位置进行更新，并将该更新部署到您的计算机。

**安装信息**  

以下安装开关与管理安装有关，因为使用这些开关，管理员可以自定义从安全更新内提取文件的方式：

/**?** 显示命令行选项

**/Q**   指定安静模式，或在提取文件时禁止显示提示。

/**T**:**&lt;full path&gt;**   指定用于提取文件的目标文件夹。

/**C** 提取文件，但不安装它们。 如果不指定 /**T**: 路径，系统将提示您提供一个目标文件夹。

**/C:&lt;Cmd&gt;** 覆盖作者定义的安装命令。 指定安装程序的 .inf 或 .exe 文件的路径和名称。

有关受支持的安装开关的其他信息，请参见 Microsoft 知识库文章 [197147](http://support.microsoft.com/default.aspx?scid=kb;zh-cn;197147)。

**管理部署信息**  

要更新您的管理安装，请执行以下步骤：

1.  在 Windows 资源管理器中，在 C 区创建一个新文件夹，然后命名为 KB838345。
2.  [下载更新](http://download.microsoft.com/download/1/6/9/16937bf3-8711-4bf4-9fa0-6924d0260806/visio2003-kb838345-fullfile-enu.exe)2
3.  单击**“将该程序保存到磁盘 ”**来将 Visio2003-KB838345-FullFile-ENU.exe 文件保存到 C:\\KB838345 文件夹。
4.  单击**“开始”**，单击**“运行”**，在**“打开”**框中键入 **cmd**，然后单击**“确定”**。 （如果使用 Windows 98、Windows 98 SE 或 Windows Millennium Edition，用 **command.com** 替代 **cmd**。）
5.  在命令提示符后，键入下列行，并在每个行之后按下 ENTER 键：

    cd\\kb838345

    Visio2003-KB838345-FullFile-ENU.exe /c /t:c:\\kb838345

6.  单击“**是**”接受许可协议。
7.  在命令方式下，键入以下行，然后按 ENTER：

    exit

8.  如果您熟悉用于更新管理安装的过程，请单击“**开始**”，然后单击“**运行**”。 在“打开”框中键入以下命令

    msiexec /a Admin Path\\MSI File /p C:\\kb838345\\Visio2003-KB838345-FullFile.MSP SHORTFILENAMES=TRUE

    其中 Admin Path 是您的应用程序的管理安装点的路径（例如 C:\\Visio），MSI File 是用于该应用程序的 .msi 数据库包（例如 Visio.msi），MSP File 是管理更新的名称（例如 Visio2003-KB838345-FullFile.MSP）。

    **注意：**可以在命令行后附加 **/qb+**，以使**“管理安装”**对话框和**“最终用户协议”**对话框不出现。

9.  在提供的对话框中单击**“下一步”** 。 在提供的对话框中不要更改您的 CD 密钥、安装位置或公司名。
10. 单击**“我接受许可协议条款”**，然后单击**“安装”**。

此时，您的管理安装点即更新。 接下来，您必须更新原先从该管理安装中安装的工作站。 为此，请查看“工作站部署”部分。 您从该管理安装点运行的任何新安装都将包括该更新。

**警告：**对于您在安装更新之前从此管理安装中安装的任何工作站，如果不为该工作站完成“工作站部署”部分中的步骤，这些工作站就无法使用此管理安装执行修补 Office、新增功能等操作。

**工作站部署信息**  

要将更新部署到客户机工作站，请单击“**开始**”，然后单击“**运行**”。 在**“打开”**框中键入以下命令：

msiexec /i Admin Path\\MSI File /qb REINSTALL=Feature List REINSTALLMODE=vomu

其中 Admin Path 是您的应用程序的管理安装点的路径（例如，C:\\Visiot），MSI File 是用于该应用程序的 MSI 数据库包（例如，Visio.msi），Feature List 是必须为更新重新安装的功能名称（区分大小写）的列表。 要安装所有功能，您可以使用 **REINSTALL=ALL**。

**注意：**Microsoft 知识库文章 [838345](http://support.microsoft.com/default.aspx?scid=kb;zh-cn;838345) 提供其他说明。 [Windows 安装程序文档](http://go.microsoft.com/fwlink/?linkid=21685)也提供关于 Windows 安装程序支持的参数的其他信息。

**管理安装文件信息**  

此更新的英文版具有下表所列的文件属性（或更高版本）。 这些文件的日期和时间以协调世界时 (UTC) 列出。 当您查看文件信息时，它将转换为本地时间。 要了解 UTC 与本地时间之间的时差，请使用“控制面板”上的“日期/时间”工具中的**“时区”**选项卡。

Visio 2003：

`日期         时间   版本         大小       文件名--------------------------------------------------------28-Feb-2004  19:16  6.0.3264.0      1,773,568  gdiplus.dll`

**验证更新安装**  

-   **Microsoft Baseline Security Analyzer**  

    要验证受影响的系统上是否安装了安全更新，也许可以使用 Microsoft 基准安全分析器 (MBSA) 工具。使用此工具，管理员可以在本地和远程系统中扫描缺少的安全更新和常见的安全错误配置。 有关 MBSA 的详细信息，请访问 [Microsoft Baseline Security Analyzer 网站](http://go.microsoft.com/fwlink/?linkid=21134)。

-   **文件版本验证**  

    **注意：**由于 Microsoft Windows 有多个版本，因此以下步骤在您的计算机上可能会有所不同。 如果不同，请参阅产品文档来完成这些步骤。

    1.  单击**“开始”**，然后单击**“搜索”**。
    2.  在**“搜索结果”**窗格中，单击**“搜索助理”**下的**“所有文件和文件夹”**。
    3.  在**“完整或部分文件名”**框中，键入相应文件信息表中的一个文件名，然后单击**“搜索”**。
    4.  在文件列表中，用鼠标右键单击相应文件信息表中的一个文件名，然后单击**“属性”**。

        **注意：**取决于安装的操作系统或程序的版本，文件信息表中所列的某些文件可能并未安装。

    5.  在**“版本”**选项卡上，通过将计算机上安装的文件与相应文件信息表中记录的版本进行比较来确定该文件的版本。

        **注意：**在安装过程中，除文件版本以外的其他属性均可能会发生变化。 不支持通过将其他文件属性与文件信息表中的信息进行比较这种方法来验证更新安装。 另外，在某些情况下，在安装过程中还可能会重命名文件。 如果没有文件或版本信息，请使用另外一种方法来验证更新安装。

#### Visual Studio .NET 2002（包括 Visual Basic .NET Standard 2002、Visual C\# .NET Standard 2002 和 Visual C++ .NET Standard 2002）

**先决条件**  
此安全更新要求以上列出的产品的发行版本。

注意：当这些程序安装在 Windows XP 或 Windows Server 2003 上时，它们使用容易受攻击的组件的操作系统版本。 如果您在 Windows XP、Windows XP Service Pack 1 或 Windows Server 2003 上使用这些程序，确保安装了安全更新的操作系统版本。 如果在其他操作系统上使用这些程序，确保为这些程序安装更新。

但如果使用这些程序来创建分发 Gdiplus.dll 文件的一个版本的应用程序，则必须安装此安全更新，即使使用 Windows XP 或 Windows Server 2003。 在此更新安装在这些操作系统上时，仅安装 Gdiplus.msm 文件。 此文件用来创建分发一个 Gdiplus.dll 文件副本的应用程序。 应用程序开发人员可以使用更新的 Gdiplus.msm 文件来重建应用程序，以使用 Gdiplus.dll 文件的更新版本。

**包含在将来的 Service Pack 中：**  
此问题的更新将包含在 Visual Studio .NET 2002 Service Pack 1 中。

**安装信息**  

此安全更新支持以下安装开关：

**/?** 显示这些信息

**/I** 安装（默认操作）

**/u** 卸载（如果已经安装）

**/q** 安静模式

**/l:logfile** 生成日志文件

**/ld** 日志包详细信息

**/lp** 日志影响的产品

**/lf** 日志包含的文件

**/xp\[:path\]** 提取 MSP

**部署信息**  

要在没有任何用户干预的情况下安装此安全更新，请在命令提示符下使用以下命令行：

**VS7.0-KB830348-X86.exe /q**  

**重新启动要求**  

此安全更新不需要重新启动。

**删除信息**  

安装更新后，无法删除它。 要在安装更新前还原安装，您必须删除该应用程序，然后重新安装它。

**文件信息**  

此更新的英文版具有下表所列的文件属性（或更高版本）。 这些文件的日期和时间以协调世界时 (UTC) 列出。 当您查看文件信息时，它将转换为本地时间。 要了解 UTC 与本地时间之间的时差，请使用“控制面板”上的“日期/时间”工具中的**“时区”**选项卡。

Visual Studio .NET 2002：

`日期          时间    版本        大小       文件名-------------------------------------------------------------------20-Feb-2004   01-32                    866,816  gdiplus.msm15-Mar-2004   21:14   5.1.3102.1355  1,638,400   gdiplus.dll`

**验证更新安装**  

-   **文件版本验证**  

    **注意：**由于 Microsoft Windows 有多个版本，因此以下步骤在您的计算机上可能会有所不同。 如果不同，请参阅产品文档来完成这些步骤。

    1.  单击**“开始”**，然后单击**“搜索”**。
    2.  在**“搜索结果”**窗格中，单击**“搜索助理”**下的**“所有文件和文件夹”**。
    3.  在**“完整或部分文件名”**框中，键入相应文件信息表中的一个文件名，然后单击**“搜索”**。
    4.  在文件列表中，用鼠标右键单击相应文件信息表中的一个文件名，然后单击**“属性”**。

        **注意：**取决于安装的操作系统或程序的版本，文件信息表中所列的某些文件可能并未安装。

    5.  在**“版本”**选项卡上，通过将计算机上安装的文件与相应文件信息表中记录的版本进行比较来确定该文件的版本。

        **注意：**在安装过程中，除文件版本以外的其他属性均可能会发生变化。 不支持通过将其他文件属性与文件信息表中的信息进行比较这种方法来验证更新安装。 另外，在某些情况下，在安装过程中还可能会重命名文件。 如果没有文件或版本信息，请使用另外一种方法来验证更新安装。

-   **注册表项验证**  

    也可以通过查看以下注册表项，检查此安全更新已安装的文件：

    HKEY\_LOCAL\_MACHINE\\SOFTWARE\\Microsoft\\Active Setup\\Installed Components\\{6639C3A4-741F-47A1-97BB-F3BD1CEFB313}

    HKEY\_LOCAL\_MACHINE\\SOFTWARE\\Microsoft\\Updates\\Visual Studio\\7.0\\M8303481025

#### Visual Studio .NET 2003（包括 Visual Basic .NET Standard 2003、Visual C\# .NET Standard 2003、Visual C++ .NET Standard 2003 和 Visual J\# .NET Standard 2003）

**先决条件**  
此安全更新要求以上列出的产品的发行版本。

**包含在将来的 Service Pack 中：**  
此问题的更新将包含在 Visual Studio .NET 2003 Service Pack 1 中。

注意：当这些程序安装在 Windows XP 或 Windows Server 2003 上时，它们使用容易受攻击的组件的操作系统版本。 如果您在 Windows XP、Windows XP Service Pack 1 或 Windows Server 2003 上使用这些程序，确保安装了安全更新的操作系统版本。 如果在其他操作系统上使用这些程序，确保为这些程序安装更新。

但如果使用这些程序来创建分发 Gdiplus.dll 文件的一个版本的应用程序，则必须安装此安全更新，即使使用 Windows XP 或 Windows Server 2003。 在此更新安装在这些操作系统上时，仅安装 Gdiplus.msm 文件。 此文件用来创建分发一个 Gdiplus.dll 文件副本的应用程序。 应用程序开发人员可以使用更新的 Gdiplus.msm 文件来重建应用程序，以使用 Gdiplus.dll 文件的更新版本。

**安装信息**  

此安全更新支持以下安装开关：

**/?** 显示这些信息

**/I** 安装（默认操作）

**/u** 卸载（如果已经安装）

**/q** 安静模式

**/l:logfile** 生成日志文件

**/ld** 日志包详细信息

**/lp** 日志影响的产品

**/lf** 日志包含的文件

**/xp\[:path\]** 提取 MSP

**部署信息**  

要在没有任何用户干预的情况下安装此安全更新，请在命令提示符下使用以下命令行：

**VS7.1-KB830348-X86.exe /q**  

**重新启动要求**  

此安全更新不需要重新启动。

**删除信息**  

安装更新后，无法删除它。 要在安装更新前还原安装，您必须删除该应用程序，然后重新安装它。

**文件信息**  

此更新的英文版具有下表所列的文件属性（或更高版本）。 这些文件的日期和时间以协调世界时 (UTC) 列出。 当您查看文件信息时，它将转换为本地时间。 要了解 UTC 与本地时间之间的时差，请使用“控制面板”上的“日期/时间”工具中的**“时区”**选项卡。

Visual Studio .NET 2003:

`日期          时间   版本         大小        文件名-------------------------------------------------------------------19-Mar-2004   17:19                    866,816   gdiplus.msm27-Feb-2004   05:33   5.1.3102.1355  1,638,400   gdiplus.dll`

**验证更新安装**  

-   **文件版本验证**  

    **注意：**由于 Microsoft Windows 有多个版本，因此以下步骤在您的计算机上可能会有所不同。 如果不同，请参阅产品文档来完成这些步骤。

    1.  单击**“开始”**，然后单击**“搜索”**。
    2.  在**“搜索结果”**窗格中，单击**“搜索助理”**下的**“所有文件和文件夹”**。
    3.  在**“完整或部分文件名”**框中，键入相应文件信息表中的一个文件名，然后单击**“搜索”**。
    4.  在文件列表中，用鼠标右键单击相应文件信息表中的一个文件名，然后单击**“属性”**。

        **注意：**取决于安装的操作系统或程序的版本，文件信息表中所列的某些文件可能并未安装。

    5.  在**“版本”**选项卡上，通过将计算机上安装的文件与相应文件信息表中记录的版本进行比较来确定该文件的版本。

        **注意：**在安装过程中，除文件版本以外的其他属性均可能会发生变化。 不支持通过将其他文件属性与文件信息表中的信息进行比较这种方法来验证更新安装。 另外，在某些情况下，在安装过程中还可能会重命名文件。 如果没有文件或版本信息，请使用另外一种方法来验证更新安装。

-   **注册表项验证**  

    也可以通过查看以下注册表项，检查此安全更新已安装的文件：

    HKEY\_LOCAL\_MACHINE\\SOFTWARE\\Microsoft\\Active Setup\\Installed Components\\{BBDEF0B4-0C24-4812-80C6-9207B26285E8}

    HKEY\_LOCAL\_MACHINE\\SOFTWARE\\Microsoft\\Updates\\Visual Studio\\7.0\\M8303481025

#### Microsoft .NET Framework 版本 1.0 Service Pack 2（包括 Microsoft .NET Framework 版本 1.0 SDK Service Pack 2）

#### Microsoft .NET Framework 版本 1.0 Service Pack 3

**先决条件**  
此安全更新需要一个 Microsoft .NET Framework 或 Microsoft .NET Framework 版本 1.0 SDK 的已发布版本。

Windows 的以下版本需要此更新：

-   Microsoft Windows 98
-   Microsoft Windows 98 Second Edition
-   Microsoft Windows Millennium Edition
-   Microsoft Windows NT Server 4.0 Service Pack 6a
-   Microsoft Windows NT Server 4.0 Terminal Server Edition, Service Pack 6
-   Microsoft Windows 2000 Service Pack 3 和 Microsoft Windows 2000 Service Pack 4

**注意：**如果在 Windows XP 或 Windows Sever 2003 上使用这些程序，则不需要此更新。 当这些程序安装在 Windows XP 或 Windows Server 2003 上时，它们使用容易受攻击的组件的操作系统版本。 如果您在 Windows XP 或 Windows Server 2003 上使用这些程序，确保安装了安全更新的操作系统版本。 如果在其他操作系统上使用这些程序，确保为这些程序安装更新。

**包含在将来的 Service Pack 中：**  
此问题的更新包含在 [Microsoft .NET Framework 版本 1.0 Service Pack 3](http://www.microsoft.com/downloads/details.aspx?familyid=6978d761-4a92-4106-a9bc-83e78d4abc5b&displaylang=en) 中。

**安装信息**  

此安全更新支持以下安装开关：

**/?** 显示这些信息

**/I** 安装（默认操作）

**/u** 卸载（如果已经安装）

**/q** 安静模式

**/l:logfile** 生成日志文件

**/ld** 日志包详细信息

**/lp** 日志影响的产品

**/lf** 日志包含的文件

**/xp\[:path\]** 提取 MSP

**部署信息**  

要在没有任何用户干预的情况下安装此安全更新，请在命令提示符下使用以下命令行：

**NDP1.0sp3-KB867461-X86-Enu.exe**  

有关如何使用软件更新服务部署此安全更新的详细信息，请访问 [Software Update Services 网站](http://go.microsoft.com/fwlink/?linkid=21125)。

**重新启动要求**  

此安全更新不需要重新启动。

**删除信息**  

安装更新后，无法删除它。 要在安装更新前还原安装，您必须删除该应用程序，然后重新安装它。

**文件信息**  

此更新的英文版具有下表所列的文件属性（或更高版本）。 这些文件的日期和时间以协调世界时 (UTC) 列出。 当您查看文件信息时，它将转换为本地时间。 要了解 UTC 与本地时间之间的时差，请使用“控制面板”上的“日期/时间”工具中的**“时区”**选项卡。

Microsoft .NET Framework 版本 1.0 Service Pack 2 和 Microsoft .NET Framework 版本 1.0 SDK Service Pack 2：

`日期         时间   版本          大小     文件名-------------------------------------------------------------Updated installed file for verification:04-May-2004  11:53  5.1.3102.1360   1,645,320   gdiplus.dll`

**验证更新安装**  

-   **文件版本验证**  

    **注意：**由于 Microsoft Windows 有多个版本，因此以下步骤在您的计算机上可能会有所不同。 如果不同，请参阅产品文档来完成这些步骤。

    1.  单击**“开始”**，然后单击**“搜索”**。
    2.  在**“搜索结果”**窗格中，单击**“搜索助理”**下的**“所有文件和文件夹”**。
    3.  在**“完整或部分文件名”**框中，键入相应文件信息表中的一个文件名，然后单击**“搜索”**。
    4.  在文件列表中，用鼠标右键单击相应文件信息表中的一个文件名，然后单击**“属性”**。

        **注意：**取决于安装的操作系统或程序的版本，文件信息表中所列的某些文件可能并未安装。

    5.  在**“版本”**选项卡上，通过将计算机上安装的文件与相应文件信息表中记录的版本进行比较来确定该文件的版本。

        **注意：**在安装过程中，除文件版本以外的其他属性均可能会发生变化。 不支持通过将其他文件属性与文件信息表中的信息进行比较这种方法来验证更新安装。 另外，在某些情况下，在安装过程中还可能会重命名文件。 如果没有文件或版本信息，请使用另外一种方法来验证更新安装。

-   **注册表项验证**  

    也可以通过查看以下注册表项，检查此安全更新已安装的文件：

    HKEY\_LOCAL\_MACHINE\\SOFTWARE\\Microsoft\\Updates\\.NETFramework\\1.0\\S867461

#### Microsoft .NET Framework 版本 1.0 Service Pack 2 单机版安全更新

**先决条件**  
此安全更新要求 Microsoft .NET Framework 版本 1.0 Service Pack 2 或 Microsoft .NET Framework 1.0 SDK Service Pack 2。 此安全更新将不会安装，并且已经安装 Microsoft .NET Framework 版本 1.0 Service Pack 3 的系统上无需此更新。

Windows 的以下版本需要此更新：

-   Microsoft Windows 98
-   Microsoft Windows 98 Second Edition
-   Microsoft Windows Millennium Edition
-   Microsoft Windows NT Server 4.0 Service Pack 6a
-   Microsoft Windows NT Server 4.0 Terminal Server Edition, Service Pack 6
-   Microsoft Windows 2000 Service Pack 3 和 Microsoft Windows 2000 Service Pack 4

**注意：**如果在 Windows XP 或 Windows Sever 2003 上使用这些程序，则不需要此更新。 当这些程序安装在 Windows XP 或 Windows Server 2003 上时，它们使用容易受攻击的组件的操作系统版本。 如果您在 Windows XP 或 Windows Server 2003 上使用这些程序，确保安装了安全更新的操作系统版本。 如果在其他操作系统上使用这些程序，确保为这些程序安装更新。 此外，如果您已安装 Microsoft .NET Framework 版本 1.0 Service Pack 3，则无此安全更新。

**包含在将来的 Service Pack 中：**  
此问题的更新包含在 [Microsoft .NET Framework 版本 1.0 Service Pack 3](http://www.microsoft.com/downloads/details.aspx?familyid=6978d761-4a92-4106-a9bc-83e78d4abc5b&displaylang=en) 中。

**安装信息**  

此安全更新支持以下安装开关：

**/?** 显示这些信息

**/I** 安装（默认操作）

**/q** 安静模式

**/l:logfile** 生成日志文件

**/ld** 日志包详细信息

**/lp** 日志影响的产品

**/lf** 日志包含的文件

**/xp\[:path\]** 提取 MSP

**部署信息**  

要在没有任何用户干预的情况下安装此安全更新，请在命令提示符下使用以下命令行：

**NDP1.0sp2-KB830348-X86-Enu.exe** **/q**  

**重新启动要求**  

此安全更新不需要重新启动。

**删除信息**  

安装更新后，无法删除它。 要在安装更新前还原安装，您必须删除该应用程序，然后重新安装它。

**文件信息**  

此更新的英文版具有下表所列的文件属性（或更高版本）。 这些文件的日期和时间以协调世界时 (UTC) 列出。 当您查看文件信息时，它将转换为本地时间。 要了解 UTC 与本地时间之间的时差，请使用“控制面板”上的“日期/时间”工具中的**“时区”**选项卡。

Microsoft .NET Framework 版本 1.0 Service Pack 2 和 Microsoft .NET Framework 版本 1.0 SDK Service Pack 2：

`日期         时间   版本         大小        文件名------------------------------------------------------------04-May-2004  18:53  5.1.3102.1360   1,645,320   gdiplus.dll`

**验证更新安装**  

-   **文件版本验证**  

    **注意：**由于 Microsoft Windows 有多个版本，因此以下步骤在您的计算机上可能会有所不同。 如果不同，请参阅产品文档来完成这些步骤。

    1.  单击**“开始”**，然后单击**“搜索”**。
    2.  在**“搜索结果”**窗格中，单击**“搜索助理”**下的**“所有文件和文件夹”**。
    3.  在**“完整或部分文件名”**框中，键入相应文件信息表中的一个文件名，然后单击**“搜索”**。
    4.  在文件列表中，用鼠标右键单击相应文件信息表中的一个文件名，然后单击**“属性”**。
    5.  在**“版本”**选项卡上，通过将计算机上安装的文件与相应文件信息表中记录的版本进行比较来确定该文件的版本。

        **注意：**在安装过程中，除文件版本以外的其他属性均可能会发生变化。 不支持通过将其他文件属性与文件信息表中的信息进行比较这种方法来验证更新安装。 另外，在某些情况下，在安装过程中还可能会重命名文件。 如果没有文件或版本信息，请使用另外一种方法来验证更新安装。

-   **注册表项验证**  

    也可以通过查看以下注册表项，检查此安全更新已安装的文件。 各种语言的注册表项各不相同：

    **ENU:** HKEY\_LOCAL\_MACHINE\\SOFTWARE\\Microsoft\\Active Setup\\Installed Components\\{752FCCBC-8F52-415A-95DE-A4209712935E}

    -   **ESN:** HKEY\_LOCAL\_MACHINE\\SOFTWARE\\Microsoft\\Active Setup\\Installed Components\\{6F9E6C5C-1B99-470A-9B31-8040DD9465B2}
    -   **ITA:** HKEY\_LOCAL\_MACHINE\\SOFTWARE\\Microsoft\\Active Setup\\Installed Components\\{941D3326-4694-4509-AA11-89FDC9A5FD2A}
    -   **CHS:** HKEY\_LOCAL\_MACHINE\\SOFTWARE\\Microsoft\\Active Setup\\Installed Components\\{48C0C360-F79D-4CC6-BE45-F6B9FC96765E}
    -   **CHT:** HKEY\_LOCAL\_MACHINE\\SOFTWARE\\Microsoft\\Active Setup\\Installed Components\\{B79B6035-CD85-4FA7-B3F0-A60D178FFD09}
    -   **DEU:** HKEY\_LOCAL\_MACHINE\\SOFTWARE\\Microsoft\\Active Setup\\Installed Components\\{088368DE-42AB-4CFC-B096-484CF2886084}
    -   **FRA:** HKEY\_LOCAL\_MACHINE\\SOFTWARE\\Microsoft\\Active Setup\\Installed Components\\{8E8C1A84-DB41-444C-BA4B-B45B73EED4DB}
    -   **JPN**: HKEY\_LOCAL\_MACHINE\\SOFTWARE\\Microsoft\\Active Setup\\Installed Components\\{147CFA12-C64E-41A8-93F6-AC3DE076C9BC}
    -   **KOR:** HKEY\_LOCAL\_MACHINE\\SOFTWARE\\Microsoft\\Active Setup\\Installed Components\\{1FC6CE15-DE07-4C91-AFF8-D8249D46684A}

#### Microsoft .NET Framework 版本 1.1

#### Microsoft .NET Framework 版本 1.1 Service Pack 1

**先决条件**  
此安全更新要求 Microsoft .NET Framework 版本 1.1 的已发行版本。

Windows 的以下版本需要此更新：

-   Microsoft Windows 98
-   Microsoft Windows 98 Second Edition
-   Microsoft Windows Millennium Edition
-   Microsoft Windows NT Server 4.0 Service Pack 6a
-   Microsoft Windows NT Server 4.0 Terminal Server Edition, Service Pack 6
-   Microsoft Windows 2000 Service Pack 3 和 Microsoft Windows 2000 Service Pack 4

**注意：**如果在 Windows XP 或 Windows Sever 2003 上使用这些程序，则不需要此更新。 当此程序安装在 Windows XP 或 Windows Server 2003 上时，它使用容易受攻击的组件的操作系统版本。 如果您在 Windows XP、Windows XP Service Pack 1 或 Windows Server 2003 上使用这些程序，确保安装了安全更新的操作系统版本。 如果在其他操作系统上使用此程序，确保为此程序安装更新。

**包含在将来的 Service Pack 中：**  
此问题的更新包含在 Microsoft .NET Framework 版本 1.1 Service Pack 1. 中。

**安装信息**  

此安全更新支持以下安装开关：

**/?** 显示这些信息

**/I** 安装（默认操作）

**/u** 卸载（如果已经安装）

**/q** 安静模式

**/l:logfile** 生成日志文件

**/ld** 日志包详细信息

**/lp** 日志影响的产品

**/lf** 日志包含的文件

**/xp\[:path\]** 提取 MSP

**部署信息**  

要在没有任何用户干预的情况下安装此安全更新，请在命令提示符下使用以下命令行：

**NDP1.1sp1-KB867460-X86.exe /q**  

有关如何使用软件更新服务部署此安全更新的详细信息，请访问 [Software Update Services 网站](http://go.microsoft.com/fwlink/?linkid=21125)。

**重新启动要求**  

此安全更新不需要重新启动。

**删除信息**  

安装更新后，无法删除它。 要在安装更新前还原安装，您必须删除该应用程序，然后重新安装它。

**文件信息**  

此更新的英文版具有下表所列的文件属性（或更高版本）。 这些文件的日期和时间以协调世界时 (UTC) 列出。 当您查看文件信息时，它将转换为本地时间。 要了解 UTC 与本地时间之间的时差，请使用“控制面板”上的“日期/时间”工具中的**“时区”**选项卡。

Microsoft .NET Framework 版本 1.1

`日期         时间   版本          大小     文件名-------------------------------------------------------------Updated installed file for verification:04-May-2004  11:53  5.1.3102.1360   1,645,320   gdiplus.dll`

**验证更新安装**  

-   **文件版本验证**  

    **注意：**由于 Microsoft Windows 有多个版本，因此以下步骤在您的计算机上可能会有所不同。 如果不同，请参阅产品文档来完成这些步骤。

    1.  单击**“开始”**，然后单击**“搜索”**。
    2.  在**“搜索结果”**窗格中，单击**“搜索助理”**下的**“所有文件和文件夹”**。
    3.  在**“完整或部分文件名”**框中，键入相应文件信息表中的一个文件名，然后单击**“搜索”**。
    4.  在文件列表中，用鼠标右键单击相应文件信息表中的一个文件名，然后单击**“属性”**。

        **注意：**取决于安装的操作系统或程序的版本，文件信息表中所列的某些文件可能并未安装。

    5.  在**“版本”**选项卡上，通过将计算机上安装的文件与相应文件信息表中记录的版本进行比较来确定该文件的版本。

        **注意：**在安装过程中，除文件版本以外的其他属性均可能会发生变化。 不支持通过将其他文件属性与文件信息表中的信息进行比较这种方法来验证更新安装。 另外，在某些情况下，在安装过程中还可能会重命名文件。 如果没有文件或版本信息，请使用另外一种方法来验证更新安装。

-   **注册表项验证**  

    也可以通过查看以下注册表项，检查此安全更新已安装的文件：

    HKEY\_LOCAL\_MACHINE\\SOFTWARE\\Microsoft\\Updates\\.NETFramework\\1.1\\S867460

#### Microsoft .NET Framework 版本 1.1 单机版安全更新

**先决条件**  
此安全更新要求 Microsoft .NET Framework 版本 1.1 的已发行版本。 此安全更新将不会安装，并且已经安装 Microsoft .NET Framework 版本 1.1 Service Pack 1. 的系统上无需此更新。

Windows 的以下版本需要此更新：

-   Microsoft Windows 98
-   Microsoft Windows 98 Second Edition
-   Microsoft Windows Millennium Edition
-   Microsoft Windows NT Server 4.0 Service Pack 6a
-   Microsoft Windows NT Server 4.0 Terminal Server Edition, Service Pack 6
-   Microsoft Windows 2000 Service Pack 3 和 Microsoft Windows 2000 Service Pack 4

**注意：**如果在 Windows XP 或 Windows Sever 2003 上使用这些程序，则不需要此更新。 当此程序安装在 Windows XP 或 Windows Server 2003 上时，它使用容易受攻击的组件的操作系统版本。 如果您在 Windows XP、Windows XP Service Pack 1 或 Windows Server 2003 上使用这些程序，确保安装了安全更新的操作系统版本。 如果在其他操作系统上使用此程序，确保为此程序安装更新。 此外，如果您已安装 Microsoft .NET Framework 版本 1.1 Service Pack 1，则无此安全更新。

**包含在将来的 Service Pack 中：**  
此问题的更新包含在 Microsoft .NET Framework 版本 1.1 Service Pack 1. 中。

**安装信息**  

此安全更新支持以下安装开关：

**/?** 显示这些信息

**/I** 安装（默认操作）

**/q** 安静模式

**/l:logfile** 生成日志文件

**/ld** 日志包详细信息

**/lp** 日志影响的产品

**/lf** 日志包含的文件

**/xp\[:path\]** 提取 MSP

**部署信息**  

要在没有任何用户干预的情况下安装此安全更新，请在命令提示符下使用以下命令行：

**NDP1.1-KB830348-X86.exe /q**  

**重新启动要求**  

此安全更新不需要重新启动。

**删除信息**  

安装更新后，无法删除它。 要在安装更新前还原安装，您必须删除该应用程序，然后重新安装它。

**文件信息**  

此更新的英文版具有下表所列的文件属性（或更高版本）。 这些文件的日期和时间以协调世界时 (UTC) 列出。 当您查看文件信息时，它将转换为本地时间。 要了解 UTC 与本地时间之间的时差，请使用“控制面板”上的“日期/时间”工具中的**“时区”**选项卡。

Microsoft .NET Framework 版本 1.1

`日期         时间   版本         大小        文件名称------------------------------------------------------------12-Oct-2004  15:57  5.1.3102.1360   1,645,320   gdiplus.dll`

**验证更新安装**  

-   **文件版本验证**  

    **注意：**由于 Microsoft Windows 有多个版本，因此以下步骤在您的计算机上可能会有所不同。 如果不同，请参阅产品文档来完成这些步骤。

    1.  单击**“开始”**，然后单击**“搜索”**。
    2.  在**“搜索结果”**窗格中，单击**“搜索助理”**下的**“所有文件和文件夹”**。
    3.  在**“完整或部分文件名”**框中，键入相应文件信息表中的一个文件名，然后单击**“搜索”**。
    4.  在文件列表中，用鼠标右键单击相应文件信息表中的一个文件名，然后单击**“属性”**。
    5.  在**“版本”**选项卡上，通过将计算机上安装的文件与相应文件信息表中记录的版本进行比较来确定该文件的版本。

        **注意：**在安装过程中，除文件版本以外的其他属性均可能会发生变化。 不支持通过将其他文件属性与文件信息表中的信息进行比较这种方法来验证更新安装。 另外，在某些情况下，在安装过程中还可能会重命名文件。 如果没有文件或版本信息，请使用另外一种方法来验证更新安装。

-   **注册表项验证**  

    也可以通过查看以下注册表项，检查此安全更新已安装的文件：

    HKEY\_LOCAL\_MACHINE\\SOFTWARE\\Microsoft\\Active Setup\\Installed Components\\{738B5D5A-253B-4F2D-BA88-E81508DE71E3}

#### Picture It! （版本 2002、版本 7.0 和版本 9）、Microsoft Greetings 2002、Digital Image Pro（版本 2002、版本 7.0 和版本 9）、Digital Image Suite（版本 2002、版本 7.0 和版本 9）。

#### 先决条件

**重要事项：**在您安装此更新之前，请确保符合以下要求：

-   必须安装以下产品之一：

    -   Greetings 2002
    -   Picture It! Express 2002
    -   Picture It! Photo 2002
    -   Picture It! Photo Premium 2002
    -   Picture It! Publishing 2002
    -   Picture It! Publishing Platinum 2002
    -   Picture It! Express 版本 7.0
    -   Picture It! Express 版本 7.0
    -   Picture It! Express 版本 7.0
    -   Picture It! Digital Image Pro 版本 7.0
    -   Picture It! Photo Premium 版本 9
    -   Picture It! Express 版本 9
    -   Picture It! Library）
    -   Digital Image Pro 版本 9
    -   Digital Image Suite 版本 9
    -   Digital Image Library

    **MSN 用户注意：**MSN 9 分发 Picture It! Express 版本 9 和 Picture It! 库。 在安装 MSN 9 时，您可以选择安装这些程序。 如果已安装 MSN 9， 只有安装了 Picture It! Express 版本 9 或 Picture It! Library 时， 才需要安装 Picture It! 版本 9 更新。

-   必须安装 Microsoft Windows Installer 版本 1.1 或更高版本。 Microsoft Windows 2000 和更高版本包括相应版本的安装程序。 可以在以下链接，通过单独下载，获得 Windows 安装程序的最新版本：

    [Windows 95、Windows 98、Windows 98 SE 和 Windows Millennium Edition 的 Windows Installer 2.0](http://www.microsoft.com/downloads/release.asp?releaseid=32831)

    [Windows 2000 和 Windows NT 4.0 的 Windows Installer 2.0](http://www.microsoft.com/downloads/release.asp?releaseid=32832)

Windows 的以下版本需要此更新：

-   Microsoft Windows 98
-   Microsoft Windows 98 Second Edition
-   Microsoft Windows Millennium Edition
-   Microsoft Windows NT Server 4.0 Service Pack 6a
-   Microsoft Windows NT Server 4.0 Terminal Server Edition, Service Pack 6
-   Microsoft Windows 2000 Service Pack 3 和 Microsoft Windows 2000 Service Pack 4

**注意：**如果在 Windows XP 或 Windows Sever 2003 上使用这些程序，则不需要此更新。 当这些程序安装在 Windows XP 或 Windows Server 2003 上时，它们使用容易受攻击的组件的操作系统版本。 如果您在 Windows XP、Windows XP Service Pack 1 或 Windows Server 2003 上使用这些程序，确保安装了安全更新的操作系统版本。 如果在以上列出的操作系统上使用这些程序，确保为这些程序安装更新。

**安装信息**  

此安全更新支持以下安装开关：

**/Q**   指定安静模式，或在提取文件时禁止显示提示。

**/Q:U**   指定用户安静模式，该模式向用户显示某些对话框。

**/Q:A**   指定管理员安静模式，该模式不向用户显示任何对话框。

/**T**:**&lt;full path&gt;**   指定用于提取文件的目标文件夹。

/**C** 提取文件，但不安装它们。 如果不指定 /**T**: 路径，系统将提示您提供一个目标文件夹。

**/C:&lt;Cmd&gt;** 覆盖作者定义的安装命令。 指定安装程序的 .inf 或 .exe 文件的路径和名称。

/**R:N** 安装后从不重新启动计算机。

**/R:I**   如果需要重新启动计算机，则提示用户重新启动，与 **/Q:A** 一起使用时除外。

/**R:A** 安装后始终重新启动计算机。

/**R:S** 安装后在不提示用户的情况下重新启动计算机。

**/N:V** 不进行版本检查，在任何以前的版本上安装程序。

**注意：**这些开关并不一定适用于所有更新。 如果某开关不可用，则表明该功能是正确安装更新所必需的。 此外，不支持使用 /N:V 开关，它可能会导致系统无法启动。 如果安装失败，您应该咨询您的支持专业人员以了解安装失败的原因。

有关受支持的安装开关的其他信息，请参见 Microsoft 知识库文章 [197147](http://support.microsoft.com/default.aspx?scid=kb;zh-cn;197147)。

**部署信息**  

例如，要安装更新，以命令提示符后使用以下命令。

版本 2002 产品的用户使用：

**gdiplus\_6.exe**  

版本 7.0 产品的用户使用：

**gdiplus\_7.exe**  

版本 9 产品的用户使用：

**gdiplus\_9.exe**  

**重新启动要求**  

无需重新启动。

**删除信息**  

安装更新后，无法删除它。 要在安装更新前还原安装，您必须删除该应用程序，然后通过原始的 CD-ROM 重新安装它。

**文件信息**  

此更新的英文版具有下表所列的文件属性（或更高版本）。 这些文件的日期和时间以协调世界时 (UTC) 列出。 当您查看文件信息时，它将转换为本地时间。 要了解 UTC 与本地时间之间的时差，请使用“控制面板”上的“日期/时间”工具中的**“时区”**选项卡。

Greetings 2002，Picture It! Express 2002，Picture It! Photo 2002，Picture It! Photo Premium 2002，Picture It! Publishing 2002，Picture It! Publishing Platinum 2002

`日期         时间   版本         大小       文件名------------------------------------------------------------18-Aug-2001  05:43  6.0.2600.0         91,136  Advpack.dll27-Feb-2004  04:33  5.1.3102.1355   1,638,400  Gdiplus.dll06-Jun-2000  23:43  4.71.704.0          2,272  W95inf16.dll06-Jun-2000  23:43  4.71.16.0           4,608  W95inf32.dll`

Picture It! Express 版本 7.0，Picture It! Photo 版本 7.0，Picture It! Photo Premium 版本 7.0 和 Picture It! Digital Image Pro 版本 7.0

`日期         时间   版本         大小       文件名------------------------------------------------------------18-Aug-2001  05:43  6.0.2600.0         91,136  Advpack.dll27-Feb-2004  04:33  5.1.3102.1355   1,638,400  Gdiplus.dll06-Jun-2000  23:43  4.71.704.0          2,272  W95inf16.dll06-Jun-2000  23:43  4.71.16.0           4,608  W95inf32.dll`

Picture It! Photo Premium 版本 9，Picture It! Express 版本 9，Picture It! Library，Digital Image Pro 版本 9，Digital Image Suite 版本 9 和 Digital Image Library

`日期         时间   版本         大小       文件名称-------------------------------------------------------18-Aug-2001  05:43  6.0.2600.0         91,136  Advpack.dll27-Feb-2004  04:33  5.1.3102.1355   1,638,400  Gdiplus.dll06-Jun-2000  23:43  4.71.704.0          2,272  W95inf16.dll06-Jun-2000  23:43  4.71.16.0           4,608  W95inf32.dll`

**验证更新安装**  

-   **文件版本验证**  

    **注意：**由于 Microsoft Windows 有多个版本，因此以下步骤在您的计算机上可能会有所不同。 如果不同，请参阅产品文档来完成这些步骤。

    1.  单击**“开始”**，然后单击**“搜索”**。
    2.  在**“搜索结果”**窗格中，单击**“搜索助理”**下的**“所有文件和文件夹”**。
    3.  在**“完整或部分文件名”**框中，键入相应文件信息表中的一个文件名，然后单击**“搜索”**。
    4.  在文件列表中，用鼠标右键单击相应文件信息表中的一个文件名，然后单击**“属性”**。

        **注意：**取决于安装的操作系统或程序的版本，文件信息表中所列的某些文件可能并未安装。

    5.  在**“版本”**选项卡上，通过将计算机上安装的文件与相应文件信息表中记录的版本进行比较来确定该文件的版本。

        **注意：**在安装过程中，除文件版本以外的其他属性均可能会发生变化。 不支持通过将其他文件属性与文件信息表中的信息进行比较这种方法来验证更新安装。 另外，在某些情况下，在安装过程中还可能会重命名文件。 如果没有文件或版本信息，请使用另外一种方法来验证更新安装。

#### Microsoft Producer for Microsoft Office PowerPoint（所有版本）

#### 先决条件

**重要事项：**在您安装此更新之前，请确保符合以下要求：

-   必须安装以下产品之一：
    -   Microsoft Producer for Microsoft Office PowerPoint 2002 (Producer 1.1)
    -   Microsoft Producer for Microsoft Office PowerPoint 2003

Windows 的以下版本需要此更新：

-   Microsoft Windows 2000 Service Pack 3 和 Microsoft Windows 2000 Service Pack 4

**注意：**如果在 Windows XP 上使用这些程序，则不需要此更新。 当这些程序安装在 Windows XP 或 Windows XP Service Pack 1 上时，它们使用容易受攻击的组件的操作系统版本。 如果您在 Windows XP 或 Windows XP Service Pack 1 上使用这些程序，确保安装了安全更新的操作系统版本。 如果在 Windows 2000 上使用这些程序，确保为这些程序安装更新。 这些程序不受 Windows Server 2003 支持。 但是当它们 Windows Server 2003 上时，它们使用容易受攻击的组件的操作系统版本。 如果在 Windows Server 2003 上使用这些程序，确保安装 Windows Server 2003 安全更新。

**安装信息**  

此安全更新支持以下安装开关：

**/Q**   指定安静模式，或在提取文件时禁止显示提示。

**/Q:U**   指定用户安静模式，该模式向用户显示某些对话框。

**/Q:A**   指定管理员安静模式，该模式不向用户显示任何对话框。

/**T**:**&lt;full path&gt;**   指定用于提取文件的目标文件夹。

/**C** 提取文件，但不安装它们。 如果不指定 /**T**: 路径，系统将提示您提供一个目标文件夹。

**/C:&lt;Cmd&gt;** 覆盖作者定义的安装命令。 指定安装程序的 .inf 或 .exe 文件的路径和名称。

/**R:N** 安装后从不重新启动计算机。

**/R:I**   如果需要重新启动计算机，则提示用户重新启动，与 **/Q:A** 一起使用时除外。

/**R:A** 安装后始终重新启动计算机。

/**R:S** 安装后在不提示用户的情况下重新启动计算机。

**/N:V** 不进行版本检查，在任何以前的版本上安装程序。

**注意：**这些开关并不一定适用于所有更新。 如果某开关不可用，则表明该功能是正确安装更新所必需的。 此外，不支持使用 /N:V 开关，它可能会导致系统无法启动。 如果安装失败，您应该咨询您的支持专业人员以了解安装失败的原因。

有关受支持的安装开关的其他信息，请参见 Microsoft 知识库文章 [197147](http://support.microsoft.com/default.aspx?scid=kb;zh-cn;197147)。

**部署信息**  

例如，要安装更新，以命令提示符后使用以下命令。

**Setup.exe**  

**重新启动要求**  

在某些情况下，此更新不需要重新启动。 安装程序停止所需的服务，应用此更新，然后重新启动这些服务。 但是，如果需要的服务由于任何原因而无法停止或所需的文件正在使用，则此更新将需要重新启动。 如果发生这种情况，会显示一条消息建议您重新启动。

**删除信息**  

要删除此更新，请使用“控制面板”中的“添加/删除程序”工具。

**文件信息**  

此更新的英文版具有下表所列的文件属性（或更高版本）。 这些文件的日期和时间以协调世界时 (UTC) 列出。 当您查看文件信息时，它将转换为本地时间。 要了解 UTC 与本地时间之间的时差，请使用“控制面板”上的“日期/时间”工具中的**“时区”**选项卡。

Microsoft Producer for Microsoft Office PowerPoint 2002 (Producer 1.1) 和 Microsoft Producer for Microsoft Office PowerPoint 2003：

`包内容：日期         时间   版本          大小     文件名-------------------------------------------------------------25-Apr-2003  17:26  12.0.2600.1     1,707,856  Instmsia.exe25-Apr-2003  17:26  12.0.2600.0     1,821,008  Instmsiw.exe19-May-2004  21:53                 49,754,624  Prod2.msi25-Jun-2003  21:01  1.0.0.1            77,824  Setup.exeUpdated installed file for verification:02-Mar-2004  21:19  5.1.3102.1360   1,638,400  Gdiplus.dll`

**注意：**由于更新的大小，没有列出所有文件。

**验证更新安装**  

-   **文件版本验证**  

    **注意：**由于 Microsoft Windows 有多个版本，因此以下步骤在您的计算机上可能会有所不同。 如果不同，请参阅产品文档来完成这些步骤。

    1.  单击**“开始”**，然后单击**“搜索”**。
    2.  在**“搜索结果”**窗格中，单击**“搜索助理”**下的**“所有文件和文件夹”**。
    3.  在**“完整或部分文件名”**框中，键入相应文件信息表中的一个文件名，然后单击**“搜索”**。
    4.  在文件列表中，用鼠标右键单击相应文件信息表中的一个文件名，然后单击**“属性”**。

        **注意：**取决于安装的操作系统或程序的版本，文件信息表中所列的某些文件可能并未安装。

    5.  在**“版本”**选项卡上，通过将计算机上安装的文件与相应文件信息表中记录的版本进行比较来确定该文件的版本。

        **注意：**在安装过程中，除文件版本以外的其他属性均可能会发生变化。 不支持通过将其他文件属性与文件信息表中的信息进行比较这种方法来验证更新安装。 另外，在某些情况下，在安装过程中还可能会重命名文件。 如果没有文件或版本信息，请使用另外一种方法来验证更新安装。

#### Platform SDK 可重新分发的版本：GDI+

#### 先决条件

**重要事项：**在您安装此更新之前，请确保符合以下要求：

-   仅在使用 Platform SDK 且在自定义应用程序中重新分发 Gdiplus.dll 时，才需要此更新。

**安装信息**  

此安全更新支持以下安装开关：

**/Q**   指定安静模式，或在提取文件时禁止显示提示。

**/Q:U**   指定用户安静模式，该模式向用户显示某些对话框。

**/Q:A**   指定管理员安静模式，该模式不向用户显示任何对话框。

/**T**:**&lt;full path&gt;**   指定用于提取文件的目标文件夹。

/**C** 提取文件，但不安装它们。 如果不指定 /**T**: 路径，系统将提示您提供一个目标文件夹。

**/C:&lt;Cmd&gt;** 覆盖作者定义的安装命令。 指定安装程序的 .inf 或 .exe 文件的路径和名称。

/**R:N** 安装后从不重新启动计算机。

**/R:I**   如果需要重新启动计算机，则提示用户重新启动，与 **/Q:A** 一起使用时除外。

/**R:A** 安装后始终重新启动计算机。

/**R:S** 安装后在不提示用户的情况下重新启动计算机。

**/N:V** 不进行版本检查，在任何以前的版本上安装程序。

**注意：**这些开关并不一定适用于所有更新。 如果某开关不可用，则表明该功能是正确安装更新所必需的。 此外，不支持使用 /N:V 开关，它可能会导致系统无法启动。 如果安装失败，您应该咨询您的支持专业人员以了解安装失败的原因。

有关受支持的安装开关的其他信息，请参见 Microsoft 知识库文章 [197147](http://support.microsoft.com/default.aspx?scid=kb;zh-cn;197147)。

**部署信息**  

例如，要安装更新，以命令提示符后使用以下命令。

**gdiplus\_dnld.exe**  

**重新启动要求**  

此更新不需要重新启动。

**删除信息**  

要删除此更新，请删除安装的文件。

**文件信息**  

此更新的英文版具有下表所列的文件属性（或更高版本）。 这些文件的日期和时间以协调世界时 (UTC) 列出。 当您查看文件信息时，它将转换为本地时间。 要了解 UTC 与本地时间之间的时差，请使用“控制面板”上的“日期/时间”工具中的**“时区”**选项卡。

Platform SDK 可重新分发的版本：GDI+

`日期         时间   版本            大小    文件名--------------------------------------------------------04-May-2004  18:53  5.1.3102.1360   1,645,320  Gdiplus.dll`

**验证更新安装**  

-   **文件版本验证**  

    **注意：**由于 Microsoft Windows 有多个版本，因此以下步骤在您的计算机上可能会有所不同。 如果不同，请参阅产品文档来完成这些步骤。

    1.  单击**“开始”**，然后单击**“搜索”**。
    2.  在**“搜索结果”**窗格中，单击**“搜索助理”**下的**“所有文件和文件夹”**。
    3.  在**“完整或部分文件名”**框中，键入相应文件信息表中的一个文件名，然后单击**“搜索”**。
    4.  在文件列表中，用鼠标右键单击相应文件信息表中的一个文件名，然后单击**“属性”**。

        **注意：**取决于安装的操作系统或程序的版本，文件信息表中所列的某些文件可能并未安装。

    5.  在**“版本”**选项卡上，通过将计算机上安装的文件与相应文件信息表中记录的版本进行比较来确定该文件的版本。

        **注意：**在安装过程中，除文件版本以外的其他属性均可能会发生变化。 不支持通过将其他文件属性与文件信息表中的信息进行比较这种方法来验证更新安装。 另外，在某些情况下，在安装过程中还可能会重命名文件。 如果没有文件或版本信息，请使用另外一种方法来验证更新安装。

#### Internet Explorer 6 Service Pack 1 for Windows 2000 SP3、Windows 2000 SP4、Windows NT 4.0 SP6a、Windows Millennium Edition、Windows 98 和 Windows 98 Second Edition

#### 先决条件

Microsoft 已对此公告中列出的 Windows 版本和 Internet Explorer 版本进行了测试，以便评估它们是否受这些漏洞影响，并确认此公告描述的更新解决了这些漏洞。

要安装此更新的 Internet Explorer 6 Service Pack 1(SP1) 6 版本，必须运行以下某个 Windows 版本：

-   Microsoft Windows 98
-   Microsoft Windows 98 Second Edition (SE)
-   Microsoft Windows Millennium Edition
-   Microsoft Windows NT Server 4.0 Service Pack 6a
-   Microsoft Windows NT Server 4.0 Terminal Server Edition Service Pack 6
-   Microsoft Windows 2000 Service Pack 3 和 Microsoft Windows 2000 Service Pack 4

**注意：**不再支持本文中未列出的 Windows 版本和 Internet Explorer 版本，或者这些版本不会受到影响。 Microsoft 建议您升级到受支持的 Windows 和 Internet Explorer 版本，然后再应用相应的更新。

**注意：**如果在 Windows XP 或 Windows Sever 2003 上使用这些程序，则不需要此更新。 当此程序安装在 Windows XP、Windows XP Service Pack 1 或 Windows Server 2003 上时，它使用容易受攻击的组件的操作系统版本。 如果您在 Windows XP、Windows XP Service Pack 1 或 Windows Server 2003 上使用此程序，确保安装了安全更新的操作系统版本。 如果在其他操作系统上使用此程序，确保为此程序安装更新。 Windows XP Service Pack 2 包括 Internet Explorer 6 Service Pack 2 并且不容易受到此问题攻击。

有关 Windows 组件的技术支持生命周期的详细信息，请参阅 [Microsoft 产品技术支持生命周期网站](http://go.microsoft.com/fwlink/?linkid=21742)。

有关如何获得 Internet Explorer 6 的最新 Service Pack 的详细信息，请参见 Microsoft 知识库文章 [328548](http://support.microsoft.com/default.aspx?scid=kb;zh-cn;328548)。

**安装信息**  

此安全更新支持以下安装开关：

**/Q**   指定安静模式，或在提取文件时禁止显示提示。

**/Q:U**   指定用户安静模式，该模式向用户显示某些对话框。

**/Q:A**   指定管理员安静模式，该模式不向用户显示任何对话框。

/**T**:**&lt;full path&gt;**   指定用于提取文件的目标文件夹。

/**C** 提取文件，但不安装它们。 如果不指定 /**T**: 路径，系统将提示您提供一个目标文件夹。

**/C:&lt;Cmd&gt;** 覆盖作者定义的安装命令。 指定安装程序的 .inf 或 .exe 文件的路径和名称。

/**R:N** 安装后从不重新启动计算机。

**/R:I**   如果需要重新启动计算机，则提示用户重新启动，与 **/Q:A** 一起使用时除外。

/**R:A** 安装后始终重新启动计算机。

/**R:S** 安装后在不提示用户的情况下重新启动计算机。

**/N:V** 不进行版本检查，在任何以前的版本上安装程序。

**注意：**这些开关并不一定适用于所有更新。 如果某开关不可用，则表明该功能是正确安装更新所必需的。 此外，不支持使用 /N:V 开关，它可能会导致系统无法启动。 如果安装失败，您应该咨询您的支持专业人员以了解安装失败的原因。

有关受支持的安装开关的其他信息，请参见 Microsoft 知识库文章 [197147](http://support.microsoft.com/default.aspx?scid=kb;zh-cn;197147)。

**部署信息**  

例如，要在没有任何用户干预的情况下安装更新并且不强制重新启动系统，请在命令提示符处使用以下命令：

**IE6.0sp1-KB833989-x86-ENU.exe /q:a /r:n**  

有关如何使用软件更新服务部署此安全更新的信息，请访问[软件更新服务网站](http://go.microsoft.com/fwlink/?linkid=21125)。

**重新启动要求**  

在某些情况下，在应用此更新后，您并不需要重新启动系统。 不过，如果所需的文件正在使用，则必须在应用此更新后重新启动系统。 如果出现这种情况，则会显示一条消息建议您重新启动系统。 对于此更新的任何版本，在重新启动系统后不必使用管理员登录。

**删除信息**  

要删除此更新，请使用“控制面板”中的“添加/删除程序”工具。 单击**“Microsoft VGX 833989”**，然后单击**“更改/删除”**或单击**“添加/删除”**）。

系统管理员可以使用 Ieuninst.exe 实用工具删除此更新。 此安全更新将 Ieuninst.exe 实用工具安装在 %Windir% 文件夹中。 此实用工具支持以下安装开关：

/**?**：显示支持的开关列表

/**z**：安装完成后不重新启动。

/**q**：使用安静模式（没有用户交互）

例如，要以安静模式删除此更新，请使用以下命令：

**c:\\windows\\ieuninst /q c:\\windows\\inf\\q833989.inf**  

**注意：**此命令假定 Windows 安装在 C:\\Windows 文件夹中。

**文件信息**  

此更新的英文版具有下表所列的文件属性（或更高版本）。 这些文件的日期和时间以协调世界时 (UTC) 列出。 当您查看文件信息时，它将转换为本地时间。 要了解 UTC 与本地时间之间的时差，请使用“控制面板”上的“日期/时间”工具中的**“时区”**选项卡。

`日期         时间   版本         大小       文件名称--------------------------------------------------------11-Mar-2004  01:09  6.0.2800.1411   2,283,008  Vgx.dll`

**验证更新安装**  

-   **Microsoft Baseline Security Analyzer**  

    要验证受影响的系统上是否安装了安全更新，也许可以使用 Microsoft 基准安全分析器 (MBSA) 工具。使用此工具，管理员可以在本地和远程系统中扫描缺少的安全更新和常见的安全错误配置。 有关 MBSA 的详细信息，请访问 [Microsoft Baseline Security Analyzer 网站](http://go.microsoft.com/fwlink/?linkid=21134)。

-   **文件版本验证**  

    **注意：**由于 Microsoft Windows 有多个版本，因此以下步骤在您的计算机上可能会有所不同。 如果不同，请参阅产品文档来完成这些步骤。

    1.  单击**“开始”**，然后单击**“搜索”**。
    2.  在**“搜索结果”**窗格中，单击**“搜索助理”**下的**“所有文件和文件夹”**。
    3.  在**“完整或部分文件名”**框中，键入相应文件信息表中的一个文件名，然后单击**“搜索”**。
    4.  在文件列表中，用鼠标右键单击相应文件信息表中的一个文件名，然后单击**“属性”**。

        **注意：**取决于安装的操作系统或程序的版本，文件信息表中所列的某些文件可能并未安装。

    5.  在**“版本”**选项卡上，通过将计算机上安装的文件与相应文件信息表中记录的版本进行比较来确定该文件的版本。

        **注意：**在安装过程中，除文件版本以外的其他属性均可能会发生变化。 不支持通过将其他文件属性与文件信息表中的信息进行比较这种方法来验证更新安装。 另外，在某些情况下，在安装过程中还可能会重命名文件。 如果没有文件或版本信息，请使用另外一种方法来验证更新安装。

-   **注册表项验证**  

    也可以通过查看以下注册表项，检查此安全更新已安装的文件：

    **HKEY\_LOCAL\_MACHINE\\SOFTWARE\\Microsoft\\Active Setup\\Installed Components\\{dc0d5f50-5f0b-46bf-8683-93ac61c67001}**  

    **注意：**确认在此注册表项中显示数据值为 1 的 **IsInstalled** DWORD 值。

-   **程序版本验证**  

    确认在**“关于 Internet 浏览器”**对话框的**“更新版本”**字段中列出**“Q833989”**。

#### 适用于基于 Windows 2000 系统的 Microsoft Windows Journal Viewer

**先决条件**  

**重要事项：**在您安装此更新之前，请确保符合以下要求：

-   必须安装 Windows Journal Viewer。
-   使用 Microsoft Windows 2000 Service Pack 3 或 Microsoft Windows 2000 Service Pack 4

**注意：**如果在 Windows XP 上使用这些程序，则不需要此更新。 当此程序安装在 Windows XP 或 Windows Windows XP Service Pack 1 上时，它使用容易受攻击的组件的操作系统版本。 如果您在 Windows XP 或 Windows XP Service Pack 1 上使用此程序，确保安装了安全更新的操作系统版本。 如果您在 Windows 2000 上使用的是此程序，确保为此程序安装更新。 此程序在 Windows Server 2003 上不受支持。 但是，如果它安装在 Windows Server 2003 上，它还是会使用含有容易受到攻击的组件的操作系统版本。 如果在 Windows Server 2003 上使用此程序，确保安装 Windows Server 2003 安全更新。

**安装信息**  

此安全更新支持以下安装开关：

**/Q**   指定安静模式，或在提取文件时禁止显示提示。

**/Q:U**   指定用户安静模式，该模式向用户显示某些对话框。

**/Q:A**   指定管理员安静模式，该模式不向用户显示任何对话框。

/**T**:**&lt;full path&gt;**   指定用于提取文件的目标文件夹。

/**C** 提取文件，但不安装它们。 如果不指定 /**T**: 路径，系统将提示您提供一个目标文件夹。

**/C:&lt;Cmd&gt;** 覆盖作者定义的安装命令。 指定安装程序的 .inf 或 .exe 文件的路径和名称。

/**R:N** 安装后从不重新启动计算机。

**/R:I**   如果需要重新启动计算机，则提示用户重新启动，与 **/Q:A** 一起使用时除外。

/**R:A** 安装后始终重新启动计算机。

/**R:S** 安装后在不提示用户的情况下重新启动计算机。

**/N:V** 不进行版本检查，在任何以前的版本上安装程序。

**注意：**这些开关并不一定适用于所有更新。 如果某开关不可用，则表明该功能是正确安装更新所必需的。 此外，不支持使用 /N:V 开关，它可能会导致系统无法启动。 如果安装失败，您应该咨询您的支持专业人员以了解安装失败的原因。

有关受支持的安装开关的其他信息，请参见 Microsoft 知识库文章 [197147](http://support.microsoft.com/default.aspx?scid=kb;zh-cn;197147)。

**部署信息**  

例如，要安装更新，以命令提示符后使用以下命令。

**JournalViewer1.5\_KB886179\_ENU.exe**  

**重新启动要求**  

除非在安装时必须更新的文件处于使用状态，否则此更新不需要重新启动。 如果发生这种情况，会显示一条消息建议您重新启动。

**删除信息**  

无法卸载此更新。

**文件信息**  

此更新的英文版具有下表所列的文件属性（或更高版本）。 这些文件的日期和时间以协调世界时 (UTC) 列出。 当您查看文件信息时，它将转换为本地时间。 要了解 UTC 与本地时间之间的时差，请使用“控制面板”上的“日期/时间”工具中的**“时区”**选项卡。

Windows Journal Viewer：

`日期         时间   版本          大小     文件名-------------------------------------------------------------02-Mar-2004  21:19  5.1.3102.1360   1,638,400  Gdiplus.dll`

**验证更新安装**  

-   **文件版本验证**  

    **注意：**由于 Microsoft Windows 有多个版本，因此以下步骤在您的计算机上可能会有所不同。 如果不同，请参阅产品文档来完成这些步骤。

    1.  单击**“开始”**，然后单击**“搜索”**。
    2.  在**“搜索结果”**窗格中，单击**“搜索助理”**下的**“所有文件和文件夹”**。
    3.  在**“完整或部分文件名”**框中，键入相应文件信息表中的一个文件名，然后单击**“搜索”**。
    4.  在文件列表中，用鼠标右键单击相应文件信息表中的一个文件名，然后单击**“属性”**。

        **注意：**取决于安装的操作系统或程序的版本，文件信息表中所列的某些文件可能并未安装。

    5.  在**“版本”**选项卡上，通过将计算机上安装的文件与相应文件信息表中记录的版本进行比较来确定该文件的版本。

        **注意：**在安装过程中，除文件版本以外的其他属性均可能会发生变化。 不支持通过将其他文件属性与文件信息表中的信息进行比较这种方法来验证更新安装。 另外，在某些情况下，在安装过程中还可能会重命名文件。 如果没有文件或版本信息，请使用另外一种方法来验证更新安装。

-   **注册表项验证**  

    也可以通过检查是否存在以下注册表项，验证此安全更新是否已安装：

    **HKEY\_LOCAL\_MACHINE\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Uninstall\\{43DCF766-6838-4F9A-8C91-D92DA586DFA7}**  

#### Microsoft Visual FoxPro 8.0

**先决条件**  
此安全更新需要已发布的 Visual FoxPro 8.0 版本。

**注意：**当此程序安装在 Windows XP 或 Windows Server 2003 上时，它使用容易受攻击的组件的操作系统版本。 如果您在 Windows XP、Windows XP Service Pack 1 或 Windows Server 2003 上使用此程序，确保安装了安全更新的操作系统版本。 如果在其他操作系统上使用此程序，确保为此程序安装更新。

但如果使用此程序来创建分发 Gdiplus.dll 文件的一个版本的应用程序，则必须安装此安全更新，即使使用 Windows XP 或 Windows Server 2003。 安装此更新时，**Vfp\_gdiplus.msm** 文件已安装。 此文件用来创建分发一个 Gdiplus.dll 文件副本的应用程序。 应用程序开发人员可以使用更新的 **Vfp\_gdiplus.msm** 文件来重建应用程序，以使用 Gdiplus.dll 文件的更新版本。

**包含在将来的版本中：**  
针对此问题的更新将包含在 Visual FoxPro 9.0。

**安装信息**  

此安全更新支持以下安装开关：

**/?**                      显示命令行选项

**/v**                     Msi 命令行参数

**/s /v/qn**         无提示安装

**/p**                      密码模式

**/a**                      管理安装

**/j**                      广告模式

**/x**                      卸载模式

**/f**                      修复模式

**/ua**                    安装 Windows 9x MSI Engine

**/uw**                    安装 Windows NT MSI Engine

**/b**                      本地缓存安装

**/w**                      等待

**注意：**有关支持的安装交换机的更多信息，请参见以下 [Web 站点](http://www.microsoft.com/technet/prodtechnol/windows2000serv/maintain/featusability/winmsi.mspx)。

**部署信息**  

要在没有任何用户干预的情况下安装此安全更新，请在命令提示符下使用以下命令行：

**VFP8-KB887684-X86.exe /s/v/qn**  

**注意：/v** 和 **/qn** 参数之间无空格。 无提示安装要求此格式。

**重新启动要求**  

此安全更新不需要重新启动。

**删除信息**  

安装更新后，无法删除它。 要在安装更新前还原安装，您必须删除该应用程序，然后重新安装它。 但是，控制面板“添加或删除程序”会显示此安全更新可被删除。 选择此选项将仅删除控制面板的“添加和删除程序”项，而不会删除已安装的文件。

**文件信息**  

此更新的英文版具有下表所列的文件属性（或更高版本）。 这些文件的日期和时间以协调世界时 (UTC) 列出。 当您查看文件信息时，它将转换为本地时间。 要了解 UTC 与本地时间之间的时差，请使用“控制面板”上的“日期/时间”工具中的**“时区”**选项卡。

Visual FoxPro 8.0:

`日期          时间   版本        大小       文件名---------------------------------------------------------------28-Sep-2004   16:44                   870,400  vfp_gdiplus.msm04-May-2004   18:53  5.1.3102.1360  1,645,320  gdiplus.dll`

**验证更新安装**  

-   **文件版本验证**  

    **注意：**由于 Microsoft Windows 有多个版本，因此以下步骤在您的计算机上可能会有所不同。 如果不同，请参阅产品文档来完成这些步骤。

    1.  单击**“开始”**，然后单击**“搜索”**。
    2.  在**“搜索结果”**窗格中，单击**“搜索助理”**下的**“所有文件和文件夹”**。
    3.  在**“完整或部分文件名”**框中，键入相应文件信息表中的一个文件名，然后单击**“搜索”**。
    4.  在文件列表中，用鼠标右键单击相应文件信息表中的一个文件名，然后单击**“属性”**。

        **注意：**取决于安装的操作系统或程序的版本，文件信息表中所列的某些文件可能并未安装。

    5.  在**“版本”**选项卡上，通过将计算机上安装的文件与相应文件信息表中记录的版本进行比较来确定该文件的版本。

        **注意：**在安装过程中，除文件版本以外的其他属性均可能会发生变化。 不支持通过将其他文件属性与文件信息表中的信息进行比较这种方法来验证更新安装。 另外，在某些情况下，在安装过程中还可能会重命名文件。 如果没有文件或版本信息，请使用另外一种方法来验证更新安装。

-   **注册表项验证**  

    也可以通过查看以下注册表项，检查此安全更新已安装的文件：

    HKEY\_LOCAL\_MACHINE\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Uninstall\\{3DD480E3-106D-453B-8623-20F8101E7274}

#### Microsoft Visual FoxPro 8.0 Runtime Library

**先决条件**  
此安全更新需要已发布的 Visual FoxPro 8.0 版本。 分发包括含有漏洞的 gdiplus.dll 文件副本的自定义 Visual FoxPro 8.0 运行时应用程序的开发人员应评估是否需要部署针对 Microsoft Visual FoxPro 8.0 Runtime Library 的安全更新。 此安全更新可由开发人员分发给拥有自定义 Visual FoxPro 8.0 运行时应用程序的客户。

**注意：**在 Windows XP 或 Windows Server 2003 上安装这些类型的 Visual FoxPro 8.0 应用程序时，它们通常使用的是含有漏洞组件的操作系统版本。 如果您在 Windows XP、Windows XP Service Pack 1 或 Windows Server 2003 上使用这些类型的程序，确保安装了安全更新的操作系统版本。 如果在其他操作系统上使用这些类型的程序，确保安装此更新。

**包含在将来的版本中：**  
针对此问题的更新将包含在 Visual FoxPro 9.0。

**安装信息**  

此安全更新支持以下安装开关：

**/?**                      显示命令行选项

**/v**                     Msi 命令行参数

**/s /v/qn**         无提示安装

**/p**                      密码模式

**/a**                      管理安装

**/j**                      广告模式

**/x**                      卸载模式

**/f**                      修复模式

**/ua**                    安装 Windows 9x MSI Engine

**/uw**                    安装 Windows NT MSI Engine

**/b**                      本地缓存安装

**/w**                      等待

**注意：**有关支持的安装交换机的更多信息，请参见以下 [Web 站点](http://www.microsoft.com/technet/prodtechnol/windows2000serv/maintain/featusability/winmsi.mspx)。

**部署信息**  

要在没有任何用户干预的情况下安装此安全更新，请在命令提示符下使用以下命令行：

**VFP8-KB887685-X86.exe /s/v/qn**  

**注意：/v** 和 **/qn** 参数之间无空格。 无提示安装要求此格式。

**重新启动要求**  

此安全更新不需要重新启动。

**删除信息**  

安装更新后，无法删除它。 要在安装更新前还原安装，您必须删除该应用程序，然后重新安装它。 但是，控制面板“添加或删除程序”会显示此安全更新可被删除。 选择此选项将仅删除控制面板的“添加和删除程序”项，而不会删除已安装的文件。

**文件信息**  

此更新的英文版具有下表所列的文件属性（或更高版本）。 这些文件的日期和时间以协调世界时 (UTC) 列出。 当您查看文件信息时，它将转换为本地时间。 要了解 UTC 与本地时间之间的时差，请使用“控制面板”上的“日期/时间”工具中的**“时区”**选项卡。

Visual FoxPro 8.0:

`日期          时间   版本        大小       文件名----------------------------------------------------------04-May-2004   18:53  5.1.3102.1360  1,645,320  gdiplus.dll`

**验证更新安装**  

-   **文件版本验证**  

    **注意：**由于 Microsoft Windows 有多个版本，因此以下步骤在您的计算机上可能会有所不同。 如果不同，请参阅产品文档来完成这些步骤。

    1.  单击**“开始”**，然后单击**“搜索”**。
    2.  在**“搜索结果”**窗格中，单击**“搜索助理”**下的**“所有文件和文件夹”**。
    3.  在**“完整或部分文件名”**框中，键入相应文件信息表中的一个文件名，然后单击**“搜索”**。
    4.  在文件列表中，用鼠标右键单击相应文件信息表中的一个文件名，然后单击**“属性”**。

        **注意：**取决于安装的操作系统或程序的版本，文件信息表中所列的某些文件可能并未安装。

    5.  在**“版本”**选项卡上，通过将计算机上安装的文件与相应文件信息表中记录的版本进行比较来确定该文件的版本。

        **注意：**在安装过程中，除文件版本以外的其他属性均可能会发生变化。 不支持通过将其他文件属性与文件信息表中的信息进行比较这种方法来验证更新安装。 另外，在某些情况下，在安装过程中还可能会重命名文件。 如果没有文件或版本信息，请使用另外一种方法来验证更新安装。

-   **注册表项验证**  

    也可以通过查看以下注册表项，检查此安全更新已安装的文件：

    HKEY\_LOCAL\_MACHINE\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Uninstall\\{0BD1F5EF-CC01-482D-8132-BB680DB892A3}

### 其他信息

**鸣谢**  

Microsoft [感谢](http://go.microsoft.com/fwlink/?linkid=21127)下列人员或组织与我们一起致力于保护客户的利益：

-   [Nick DeBaggis](https://technet.microsoft.com/zh-CN/mailto:ndebaggis@verizon.net)，他报告了 JPEG 漏洞 (CAN-2004-0200)。

**获取其他安全更新：**  

可从以下位置获得针对其他安全问题的更新：

-   可以从 [Microsoft 下载中心](http://www.microsoft.com/downloads/search.aspx?displaylang=zh-cn)获得安全更新：通过搜索关键字“安全修补程序”，可以非常方便地找到这些更新。
-   可从 [Windows Update Web 站点](http://v4.windowsupdate.microsoft.com/zhcn/default.asp)获得有关用户平台的更新。

**支持：**  

-   美国和加拿大的用户可拨打电话 1-866-PCSAFETY，从 [Microsoft 产品支持服务](http://go.microsoft.com/fwlink/?linkid=21131)获得技术支持。与安全更新有关的电话支持服务是免费的。
-   其他国家（或地区）的用户可从当地的 Microsoft 分公司获得支持。与安全更新有关的支持服务不收取任何费用。有关如何就支持问题与 Microsoft 取得联系方面的详细信息，请访问[国际支持 Web 站点](http://go.microsoft.com/fwlink/?linkid=21155)。

**安全性资源：**  

-   [Microsoft TechNet 安全性](http://www.microsoft.com/china/technet/security/default.asp)Web 站点提供了有关 Microsoft 产品安全性的详细信息。
-   [Microsoft 软件更新服务](http://go.microsoft.com/fwlink/?linkid=21133)
-   [Microsoft 基准安全分析器](http://www.microsoft.com/china/technet/security/tools/mbsahome.mspx) (MBSA)
-   [Windows Update](http://go.microsoft.com/fwlink/?linkid=21130)
-   Windows Update 目录：有关 Windows Update 目录的详细信息，请参见 Microsoft 知识库文章 [323166](http://support.microsoft.com/default.aspx?scid=kb;zh-cn;323166)。
-   [Office Update](http://go.microsoft.com/fwlink/?linkid=21135)

**软件更新服务：**  

通过使用 Microsoft 软件更新服务 (SUS)，管理员可以在基于 Windows 2000 和 Windows Server 2003 的服务器以及运行 Windows 2000 Professional 或 Windows XP Professional 的台式机系统上快速而可靠地部署最新的重要更新和安全更新。

有关如何使用软件更新服务部署此安全更新的详细信息，请访问[软件更新服务 Web 站点](http://go.microsoft.com/fwlink/?linkid=21133)。

**Systems Management Server：**  

Microsoft Systems Management Server (SMS) 提供了一个用于管理更新且可高度配置的企业解决方案。通过使用 SMS，管理员可以确定需要安全更新且基于 Windows 的系统，并在整个企业中以可控制的方式执行这些更新的部署，而只对最终用户造成最低程度的干扰。有关管理员如何使用 SMS 2003 来部署安全更新的详细信息，请参见 [SMS 2003 安全修补程序管理 Web 站点](http://www.microsoft.com/china/smserver/evaluation/capabilities/patch.asp)。SMS 2.0 用户还可以使用[软件更新服务功能包](http://www.microsoft.com/china/smserver/downloads/20/default.asp)帮助部署安全更新。有关 SMS 的信息，请访问 [SMS Web 站点](http://www.microsoft.com/china/smserver/default.asp)。

**注意：**SMS 使用 Microsoft 基准安全分析器和 Microsoft Office 检测工具，提供对安全公告更新检测和部署的广泛支持。这些工具可能检测不到某些软件更新。在这些情况下，管理员可以使用 SMS 的清单功能将更新部署到特定系统上。有关这一过程的详细信息，请参见以下 [Web 站点](http://www.microsoft.com/technet/prodtechnol/sms/sms2003/patchupdate.mspx)。某些安全更新在重新启动系统后可能需要管理权限。管理员可以使用提升权限部署工具（在 [**SMS 2003 管理功能包**](http://www.microsoft.com/china/smserver/downloads/2003/adminpack.asp)和 [**SMS 2.0 管理功能包**](http://www.microsoft.com/smserver/downloads/20/featurepacks/adminpack/)中提供）来安装这些更新。

**免责声明：**  

Microsoft 知识库中的信息“按原样”提供，没有任何形式的担保。Microsoft 不作任何明示或暗示保证，包括对适销性和针对特定目的的适用性的保证。Microsoft Corporation 或其供应商不对任何损害（包括直接的、间接的、偶然的、必然的损害，商业利润损失，或特殊损害）承担任何责任，即使 Microsoft Corporation 或其供应商事先已被告知有可能发生此类损害。有些州不允许排除或限制必然或偶然损害的赔偿责任，因此上述限制可能不适用。

**修订：**  

-   V1.0（2004 年 9 月 14 日）：已发布公告
-   V1.1（2004 年 9 月 15 日）：已更新“受影响的和不受影响的软件”部分。 Office XP Service Pack 2 受到影响且已澄清。 .NET Framework 1.1 SDK 和 MS Works（所有版本）未受到影响且已添加到“不受影响的软件”部分。 此外，还更新了 FAQ 以提供有关此问题的其他信息。
-   V1.2（2004 年 9 月 21 日）：已更新“受影响的和不受影响的软件”部分。 关于 Office XP、Visio 2002、Project 2002、.NET Framework 1.0 和 .NET Framework 1.1 的已更新的“安全更新信息”部分。 此外，还更新了 FAQ 以提供有关此问题的其他信息。
-   V2.0（2004 年 10 月 12 日）：更新公告以通知使用 Windows XP Service Pack 2 的 Office XP、Visio 2002 和 Project 2002 的客户已发布修订后的安全更新。 Microsoft 知识库文章 [833987](http://support.microsoft.com/default.aspx?scid=kb;zh-cn;833987) 介绍了当前已知的客户在安装这些安全更新时可能遇到的问题。 这篇文章还介绍了这些问题的建议解决办法。 Microsoft 还发布了 MS04-028 Enterprise Update Scanning 工具以帮助客户检测和部署所需的更新。 有关 MS04-028 Enterprise Update Scanning 工具的详细信息，请参见 Microsoft 知识库文章 [886988](http://support.microsoft.com/default.aspx?id=886988)。 我们还发布了已安装 Windows Journal Viewer 的基于 Windows 2000 的系统的更新。 公告也已经用新的 FAQ 进行更新，解决了关于 Visio 2002 Viewer、Visio 2003 Viewer 和 PowerPoint 2003 Viewer 程序的问题。
-   V3.0（2004 年 12 月 14 日）：公告已经更新，通知现已发布其他安全更新。 现已提供单机版的 Microsoft .NET Framework 版本 1.0 Service Pack 2 和 Microsoft .NET Framework 版本 1.1。 针对 Microsoft Visual FoxPro 8.0 和 Microsoft Visual FoxPro 8.0 Runtime 的安全更新现也已提供。 公告已经更新为反映包含受影响文件的更新版本的 Windows Messenger 5.1 发布情况。 MS04-028 Enterprise Update Scanning 工具现已更新为检测并部署其他安全更新。

*Built at 2014-04-18T01:50:00Z-07:00*
