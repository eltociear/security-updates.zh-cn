---
TOCTitle: 'MS07-017'
Title: 'Microsoft 安全公告 MS07-017 - 严重'
ms:assetid: 'ms07-017'
ms:contentKeyID: 61236875
ms:mtpsurl: 'https://technet.microsoft.com/zh-CN/library/ms07-017(v=Security.10)'
---



Microsoft 安全公告 MS07-017 - 严重
==================================

GDI 中的漏洞可能允许远程执行代码 (925902)
-----------------------------------------

发布时间: 2007年4月3日 | 更新时间: 2008年12月9日

**版本:** 1.1

#### 摘要

**本文的目标读者：** 使用 Microsoft Windows 的客户

**漏洞的影响：** 远程执行代码

**最高严重等级：** 严重

**建议：** 客户应立即应用此更新

**安全更新替代：** 此公告替代以前的安全更新。 有关详细信息，请参阅本公告的“常见问题 (FAQ)”部分。

**注意事项：** [Microsoft 知识库文章 925902](http://support.microsoft.com/kb/925902) 介绍了客户在安装此安全更新时可能遇到的当前已知问题。 本文还介绍了这些问题的建议解决办法。 有关详细信息，请参阅 [Microsoft Knowledge Base Article 925902](http://support.microsoft.com/kb/925902)

**测试过的软件和安全更新下载位置：**

**受影响的软件：**

-   Microsoft Windows 2000 Service Pack 4 — [下载此更新](http://www.microsoft.com/downloads/details.aspx?familyid=92f20599-3e7b-4217-91e6-fdcfb4c56856)
-   Microsoft Windows XP Service Pack 2 - [下载此更新](http://www.microsoft.com/downloads/details.aspx?familyid=f82ea184-945f-4b78-9463-10ac20a75020)
-   Microsoft Windows XP Professional x64 Edition 和 Microsoft Windows XP Professional x64 Edition Service Pack 2 — [下载此更新](http://www.microsoft.com/downloads/details.aspx?familyid=ea5e1b87-4db5-4b1a-891e-29c6bd6c0184)
-   Microsoft Windows Server 2003、Microsoft Windows Server 2003 Service Pack 1 和 Microsoft Windows Server 2003 Service Pack 2 — [下载此更新](http://www.microsoft.com/downloads/details.aspx?familyid=9f73a782-deaf-46e0-b3e0-79042ff39979)
-   Microsoft Windows Server 2003（用于基于 Itanium 的系统）、Microsoft Windows Server 2003 SP1（用于基于 Itanium 的系统）以及 Microsoft Windows Server 2003 SP2（用于基于 Itanium 的系统）- [下载此更新](http://www.microsoft.com/downloads/details.aspx?familyid=7ba63879-4fc7-4a5c-b9b5-f98c5cdc6840)
-   Microsoft Windows Server 2003 x64 Edition 和 Microsoft Windows Server 2003 x64 Edition Service Pack 2 - [下载此更新](http://www.microsoft.com/downloads/details.aspx?familyid=3276dd11-4e2f-4183-a542-82ac3c6d9754)
-   Windows Vista — [下载此更新](http://www.microsoft.com/downloads/details.aspx?familyid=d8b0e65c-5b41-46eb-92df-0b062cfcdeec)
-   Windows Vista x64 Edition — [下载此更新](http://www.microsoft.com/downloads/details.aspx?familyid=fb0ff2b5-05fe-4158-b4b7-da0d7f82c04b)

已对此列表中的软件进行了测试，以确定是否这些版本会受到影响。 其他版本的支持生命周期已结束或者不受影响。 要确定产品和版本的技术支持生命周期，请访问 [Microsoft 产品技术支持生命周期网站](http://go.microsoft.com/fwlink/?linkid=21742)。

### 一般信息

摘要
----


**摘要：**

此更新解决了许多公开披露和秘密报告的新发现漏洞以及通过内部调查发现的附加问题。 本公告的“漏洞详细资料”部分中的小节对每个漏洞进行了说明。

成功利用最严重的漏洞的攻击者可以完全控制受影响的系统。 攻击者可随后安装程序；查看、更改或删除数据；或者创建拥有完全用户权限的新帐户。


**注意** Windows 动态光标远程执行代码漏洞 - [CVE-2007-0038](http://www.cve.mitre.org/cgi-bin/cvename.cgi?name=cve-2007-0038) 当前正被利用，之前曾在 [Microsoft 安全通报 935423](http://technet.microsoft.com/security/advisory/935423) 中论述过该漏洞。

**严重等级和漏洞标识：**

| 漏洞标识符                                                                                                          | 漏洞的影响   | Windows 2000 Service Pack 4 | Windows XP Service Pack 2 | Windows Server 2003、Windows Server 2003 Service Pack 1 和 Windows Server 2003 Service Pack 2 | Windows Vista |
|---------------------------------------------------------------------------------------------------------------------|--------------|-----------------------------|---------------------------|-----------------------------------------------------------------------------------------------|---------------|
| GDI 本地特权提升漏洞 - [CVE-2006-5758](http://www.cve.mitre.org/cgi-bin/cvename.cgi?name=cve-2006-5758)             | 特权提升     | 重要                        | 重要                      | 不受影响                                                                                      | 不受影响      |
| WMF 拒绝服务漏洞 [CVE-2007-1211](http://www.cve.mitre.org/cgi-bin/cvename.cgi?name=cve-2007-1211)                   | 拒绝服务     | 中等                        | 中等                      | 中等                                                                                          | 不受影响      |
| EMF 特权提升漏洞 [CVE-2007-1212](http://www.cve.mitre.org/cgi-bin/cvename.cgi?name=cve-2007-1212)                   | 特权提升     | 重要                        | 重要                      | 重要                                                                                          | 重要          |
| GDI 无效的窗口大小特权提升漏洞 [CVE-2006-5586](http://www.cve.mitre.org/cgi-bin/cvename.cgi?name=cve-2006-5586)     | 特权提升     | 重要                        | 重要                      | 不受影响                                                                                      | 不受影响      |
| Windows 动态光标远程执行代码漏洞 - [CVE-2007-0038](http://www.cve.mitre.org/cgi-bin/cvename.cgi?name=cve-2007-0038) | 远程执行代码 | 严重                        | 严重                      | 严重                                                                                          | 严重          |
| GDI 不正确的参数本地特权提升漏洞 - [CVE-2007-1215](http://www.cve.mitre.org/cgi-bin/cvename.cgi?name=cve-2007-1215) | 特权提升     | 重要                        | 重要                      | 重要                                                                                          | 重要          |
| 字体光栅器漏洞 - [CVE-2007-1213](http://www.cve.mitre.org/cgi-bin/cvename.cgi?name=cve-2007-1213)                   | 特权提升     | 重要                        | 不受影响                  | 不受影响                                                                                      | 不受影响      |
| **所有漏洞的综合严重程度**                                                                                          |         | **严重**                    | **严重**                  | **严重**                                                                                      | **严重**      |

此[评估](http://go.microsoft.com/fwlink/?linkid=21140)是基于以下几点作出的：受此漏洞影响的系统类型，它们的典型部署模式，以及利用此漏洞会对它们产生什么影响。


**注意** 非 x86 操作系统版本与 x86 操作系统版本的严重等级按以下方式对应：

-   Windows XP Professional x64 Edition 和 Windows XP Professional x64 Edition Service Pack 2 的严重等级与 Windows XP Service Pack 2 的严重等级相同。
-   Windows Server 2003 SP1（用于基于 Itanium 的系统）的严重等级与 Windows Server 2003 Service Pack 1 的严重等级相同。
-   Windows Server 2003 SP2（用于基于 Itanium 的系统）的严重等级与 Windows Server 2003 Service Pack 1 的严重等级相同。
-   Windows Server 2003 x64 Edition 的严重等级与 Windows Server 2003 Service Pack 1 的严重等级相同。
-   Windows Server 2003 x64 Edition Service Pack 2 的严重等级与 Windows Server 2003 Service Pack 2 的严重等级相同。
-   Windows Vista x64 Edition 的严重等级与 Windows Vista 的严重等级相同。

与此安全更新相关的常见问题 (FAQ)
--------------------------------


**为什么在 2008 年 12 月 9 日修订此公告？**  
修订此公告是为了告知现在提供 Windows Server 2003 更新程序包的更新版本。 对该更新进行修订是为了解决与更新的稳定性和预期目标系统的安全性均无关的次要问题。 成功地应用了此更新的客户不必采取任何行动。 没有安装以前的更新的 Windows Server 2003 客户现在将被提供修订的更新。 此公告在其他 Windows 操作系统上的适用性没有变化。

**此更新为何消除了多个已报告的安全漏洞？**  
此更新之所以包含对某些漏洞的支持，是因为解决这些问题所需的修改位于相关的文件中。 用户只需安装此更新就可以了，而不用安装多个几乎相同的更新。

**此版本替代哪些更新？**  
此安全更新取代以前的一个安全更新。 下表列出了相应的安全公告 ID 和受影响的操作系统。

| 公告 ID                                                                 | Windows 2000 Service Pack 4 | Windows XP Service Pack 2 | Windows Server 2003 | Windows Server 2003 Service Pack 1 和 Windows Server 2003 Service Pack 2 | Windows Vista |
|-------------------------------------------------------------------------|-----------------------------|---------------------------|---------------------|--------------------------------------------------------------------------|---------------|
| [**MS06-001**](http://technet.microsoft.com/security/bulletin/ms06-001) | 已替代                      | 已替代                    | 已替代              | 已替代                                                                   | 不适用        |
| **MS05-053**                                                            | 已替代                      | 已替代                    | 已替代              | 已替代                                                                   | 不适用        |
| **MS05-002**                                                            | 未取代                      | 不适用                    | 已替代              | 不适用                                                                   | 不适用        |

**我正在使用本安全公告中讨论的软件的较旧版本；我该怎么办？**  
已对本公告中提及的支持软件进行了测试，以确定这些版本是否会受到影响。 其他版本的支持生命周期已结束。 要确定产品和版本的技术支持生命周期，请访问 [Microsoft 产品技术支持生命周期网站](http://go.microsoft.com/fwlink/?linkid=21742)。

使用该软件的较旧版本的客户应优先考虑迁移到受支持的版本，以防止可能会受到新出现漏洞的影响。 有关 Windows 产品生命周期的详细信息，请访问以下 [Microsoft 产品技术支持生命周期网站](http://go.microsoft.com/fwlink/?linkid=21742)。 有关这些操作系统版本的延长安全更新支持周期的详细信息，请访问 [Microsoft 产品支持服务网站](http://go.microsoft.com/fwlink/?linkid=33328)。

如果用户需要获得较旧软件的定制支持，则必须与其 Microsoft 客服小组代表、其技术客户经理或适当的 Microsoft 合作伙伴代表联系以了解定制支持选项。 没有联合合同、优先支持合同或授权合同的客户可与其当地的 Microsoft 销售分支机构联系。 有关联系信息，请访问 [Microsoft Worldwide Information 网站](http://go.microsoft.com/fwlink/?linkid=33329)，选择所在国家/地区，然后单击“**Go**”以查看电话号码列表。 在拨打电话时，请找当地的“企业技术咨询支持服务”销售经理进行洽谈。 有关详细信息，请参阅 [Windows 操作系统产品支持生命周期常见问题](http://go.microsoft.com/fwlink/?linkid=33330)。

**可否使用 Microsoft Baseline Security Analyzer (MBSA) 确定是否需要此更新?**
下表提供此安全更新的 MBSA 检测摘要。

| 产品                                                                                                                                              | MBSA 1.2.1 | MBSA 2.0.1                            |
|---------------------------------------------------------------------------------------------------------------------------------------------------|------------|---------------------------------------|
| Microsoft Windows 2000 Service Pack 4                                                                                                             | 是         | 是                                    |
| Microsoft Windows XP Service Pack 2                                                                                                               | 是         | 是                                    |
| Microsoft Windows XP Professional x64 Edition 和 Microsoft Windows XP Professional x64 Edition Service Pack 2                                     | 否         | 是                                    |
| Microsoft Windows Server 2003 Service Pack 1 和 Microsoft Windows Server 2003 Service Pack 2                                                      | 是         | 是                                    |
| Microsoft Windows Server 2003 Service Pack 2（用于基于 Itanium 的系统）和 Microsoft Windows Server 2003 Service Pack 2（用于基于 Itanium 的系统） | 否         | 是                                    |
| Microsoft Windows Server 2003 x64 Edition 和 Microsoft Windows Server 2003 x64 Edition Service Pack 2                                             | 否         | 是                                    |
| Windows Vista                                                                                                                                     | 否         | 请参阅下列 **WindowsVista 备注** |
| Windows Vista x64 Edition                                                                                                                         | 否         | 请参阅下列 **WindowsVista 备注** |

有关 MBSA 的详细信息，请访问 [MBSA 网站](http://go.microsoft.com/fwlink/?linkid=21134)。 有关 Microsoft Update 和 MBSA 2.0 当前不检测的软件的详细信息，请参阅 [Microsoft 知识库文章 895660](http://support.microsoft.com/kb/895660)。

**关于 Windows备注** MBSA 2.0.1 在 Windows Vista 上不受支持，但是支持对运行 Windows Vista 的计算机执行远程扫描。 有关 Windows Vista 的 MBSA 支持的其他信息，请访问 [MBSA 网站](http://go.microsoft.com/fwlink/?linkid=21134)。 请参阅 [Microsoft 知识库文章 931943](http://support.microsoft.com/kb/931943)： Windows Vista 的 Microsoft Baseline Security Analyzer (MBSA) 支持。

有关详细信息，请参阅 [Microsoft 知识库文章 910723](http://support.microsoft.com/kb/910723)： 每月检测和部署指南文章的摘要列表。

**可否使用 Systems Management Server (SMS) 确定是否需要此更新？**  
下表提供此安全更新的 SMS 检测摘要。

| 产品                                                                                                                                                                                                          | SMS 2.0 | SMS 2003 |
|---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|---------|----------|
| Microsoft Windows 2000 Service Pack 4                                                                                                                                                                         | 是      | 是       |
| Microsoft Windows XP Service Pack 2                                                                                                                                                                           | 是      | 是       |
| Microsoft Windows XP Professional x64 Edition 和 Microsoft Windows XP Professional x64 Edition Service Pack 2                                                                                                 | 否      | 是       |
| Microsoft Windows Server 2003、Microsoft Windows Server 2003 Service Pack 1 和 Microsoft Windows Server 2003 Service Pack 2                                                                                   | 是      | 是       |
| Microsoft Windows Server 2003（用于基于 Itanium 的系统）、Microsoft Windows Server 2003 Service Pack 1（用于基于 Itanium 的系统）以及 Microsoft Windows Server 2003 Service Pack 2（用于基于 Itanium 的系统） | 否      | 是       |
| Microsoft Windows Server 2003 x64 Edition 和 Microsoft Windows Server 2003 x64 Edition Service Pack 2                                                                                                         | 否      | 是       |

SMS 2.0 和 SMS 2003 Software Update Services (SUS) 功能包可以使用 MBSA 1.2.1 进行检测，因此具有本公告前面所列的与 MBSA 1.2.1 不检测的程序有关的相同限制。

有关 SMS 的详细信息，请访问 [SMS 网站](http://go.microsoft.com/fwlink/?linkid=21158)。

有关详细信息，请参阅 [Microsoft 知识库文章 910723](http://support.microsoft.com/kb/910723)： 每月检测和部署指南文章的摘要列表。

漏洞详细资料
------------


#### GDI 本地特权提升漏洞 - CVE-2006-5758：

图形呈现引擎由于启动应用程序的方式而存在一个特权提升漏洞。 已登录的用户可通过利用此漏洞完全控制系统。

#### GDI 本地特权提升漏洞 (CVE-2006-5758) 的缓解因素：

-   攻击者必须能够本地登录才能利用此漏洞。 匿名用户无法利用此漏洞，也无法以远程方式利用此漏洞。

#### GDI 本地特权提升漏洞 (CVE-2006-5758) 的变通办法：

我们并未发现此漏洞的任何变通办法。

#### GDI 本地特权提升漏洞 (CVE-2006-5758) 的常见问题：

**此漏洞的影响范围有多大？**  
这是一个权限提升漏洞。 成功利用此漏洞的攻击者可以完全控制受影响的系统。 攻击者可随后安装程序；查看、更改或删除数据；或者创建拥有完全用户权限的新帐户。 要尝试利用此漏洞，攻击者必须能够本地登录到系统并运行程序。

**造成漏洞的原因是什么？**  
此漏洞是由于当 Windows 图形呈现引擎处理 WMF 和 EMF 文件类型时不正确地处理了为 Windows 内核保留的内存导致的。

**攻击者可能利用此漏洞执行什么操作？**  
成功利用此漏洞的攻击者可以完全控制受影响的系统。

**攻击者如何利用此漏洞？**  
要利用此漏洞，攻击者必须先登录到系统。 然后，攻击者可能执行作为常规用户运行的程序来利用此漏洞，并完全控制受影响的系统。

**受此漏洞威胁最大的系统有哪些？**  
工作站受此漏洞的威胁最大。 如果管理员允许用户登录服务器并运行程序，服务器可能面临更大风险。 不过，最佳做法是不要授予这样的权限。

**是否可以通过 Internet 利用此漏洞？**  
否。 攻击者必须能够登录到作为攻击目标的特定系统。 攻击者无法利用此漏洞远程加载和运行程序。

**此更新有什么作用？**  
此更新通过修改创建句柄的方式来消除此漏洞。

**发布此安全公告时，此漏洞是否已公开披露？**  
是。 在通过可靠的披露渠道提供初始报告的同时，后来相同的安全研究人员公开披露了该漏洞。 已为此漏洞分配了常见漏洞和披露号码 [CVE-2006-5758](http://www.cve.mitre.org/cgi-bin/cvename.cgi?name=cve-2006-5758)。大型安全社区还将它命名为 GDI 内核本地特权提升漏洞。 此安全公告解决了公开披露的漏洞以及通过内部调查发现的其他问题。

**在发布此安全公告时，Microsoft 是否收到任何有关此漏洞已被利用的报告？**  
否。 在最初发布此安全公告时，Microsoft 看到了公开发布的概念证明代码示例，但未收到任何表明此漏洞已被公开用于攻击客户的信息。

**应用此安全更新是否有助于防止客户运行已公开发布的试图利用此漏洞的代码？**  
是。 此安全更新将消除可能使用已发布的概念证明代码利用的漏洞。 已为解决的漏洞分配了常见漏洞和披露号码 [CVE-2006-5758](http://www.cve.mitre.org/cgi-bin/cvename.cgi?name=cve-2006-5758)。

#### WMF 拒绝服务漏洞 - CVE-2007-1211：

Windows 呈现 Windows 图元文件 (WMF) 图像格式文件时存在一个拒绝服务漏洞。 成功利用此漏洞的攻击者可能导致受影响的系统停止响应和重新启动。

#### WMF 拒绝服务漏洞 (CVE-2007-1211) 的缓解因素：

-   在基于 Web 的攻击中，攻击者必须拥有一个网站，并在上面放置用来利用此漏洞的网页。 攻击者无法强迫用户访问特制的网站。 相反，攻击者必须诱使用户访问该网站，所采用的方式通常是让用户单击指向攻击者网站的链接。 在用户单击此链接后，将会提示他们执行几项操作。 只有在用户执行这些操作之后才会遭到攻击。
-   攻击者通过诱使用户打开特制的文件或查看包含特制图像的文件夹，以利用此漏洞。 攻击者无法强制用户打开特制的文件，而可能通过预览电子邮件消息使其打开。

#### WMF 拒绝服务漏洞 (CVE-2007-1211) 的变通办法：

Microsoft 已测试以下变通办法。 尽管这些变通办法不能从根本上消除此漏洞，但它们有助于阻止已知的攻击媒介。 如果某种变通办法导致功能下降，下一节中将进行说明 **。**

-   **如果您使用的是 Outlook 2002 Service Pack 3 或更高版本，或者使用的是 Outlook Express 6 SP1 或更高版本，请用纯文本格式阅读电子邮件，以帮助保护自己免受来自 HTML 电子邮件攻击媒介的攻击。**

    使用 Microsoft Outlook 2002 Service Pack 3 和 Microsoft Outlook Express 6 Service Pack 1 或更高版本的客户可以启用此设置，并查看未经过数字签名的电子邮件或者未加密的电子邮件。

    带数字签名的电子邮件或加密的电子邮件不受此设置的影响，可以用其原始格式阅读。 有关在 Outlook 2002 中如何启用此设置的详细信息，请参阅 [Microsoft 知识库文章 307594](http://support.microsoft.com/kb/307594)。

    有关在 Outlook Express 6 中如何启用此设置的详细信息，请参阅 [Microsoft 知识库文章 291387](http://support.microsoft.com/kb/291387)。

**变通办法的影响：** 用纯文本格式查看的电子邮件中不会包含图片、特殊字体、动画或其他丰富内容。 此外：

-   这些更改适用于预览窗格和打开的邮件。
-   图片变成了附件，因此不会丢失。
-   由于存储区中的邮件仍然是 RTF 格式或 HTML 格式，因此对象模型（自定义代码解决方案）可能不按预期方式运行。

#### WMF 拒绝服务漏洞 (CVE-2007-1211) 的常见问题：

**此漏洞的影响范围有多大？**  
这是一个拒绝服务漏洞。 利用此漏洞的攻击者可能会导致受影响系统停止响应和自动重新启动。 注意，虽然攻击者无法利用拒绝服务漏洞来执行代码或提升权限，但此漏洞可能导致受影响的程序停止接受请求。

**造成漏洞的原因是什么？**  
该漏洞是由于尝试读取包含无效内存引用的数据值导致的。

**什么是 Windows 图元文件 (WMF) 图像格式？**  
WMF 图像格式是一种 16 位图元文件格式，其中可以同时包含矢量信息和位图信息。 它非常适合 Windows 操作系统。

有关图像类型和格式的详细信息，请参阅 [Microsoft 知识库文章 320314](http://support.microsoft.com/kb/320314)。有关这些文件格式的其他信息，请访问 [MSDN 技术资源库网站](http://msdn.microsoft.com/library/default.asp?url=/library/en-us/gdicpp/gdiplus/aboutgdiplus/imagesbitmapsandmetafiles/metafiles.asp)。

**攻击者可能利用此漏洞执行什么操作？**  
成功利用此漏洞的攻击者可能导致受影响的系统停止响应和重新启动。

**哪些人可能会利用此漏洞？**  
在基于 Web 的攻击中，攻击者必须拥有一个网站，其中包含用来试图利用此漏洞的网页。 攻击者无法强迫用户访问特制的网站。 相反，攻击者必须劝诱用户访问该网站，通常是让用户单击通向攻击者站点的链接。 它还可能使用横幅广告或其他方式显示特制的 Web 内容，以便将 Web 内容传递至受影响的系统。

**攻击者如何利用此漏洞？**  
攻击者可能在受影响的系统上，通过诱使用户打开特制文件或查看包含特制图像的文件夹来利用此漏洞。 攻击者无法强制用户打开特制的文件，而可能通过预览电子邮件消息使其打开。

**受此漏洞威胁最大的系统有哪些？**  
工作站和终端服务器受到的威胁最大。 当没有足够管理权限的用户被授予登录到服务器并运行程序或浏览 Internet 的权限时，服务器会更有危险。 不过，最佳做法是不要授予这样的权限。

**我当前是在 Windows Server 2003 上运行 Internet Explorer，这是否可以减轻此漏洞的影响？**  
是。 默认情况下，Windows Server 2003 上的 Internet Explorer 在一种称为“增强安全配置”的受限模式下运行。 此模式会将 Internet 区域的安全级别设置为“高”。 此缓解因素适用于未被添加到 Internet Explorer“受信任的站点”区域的网站。

**什么是 Internet Explorer 增强安全配置？**  
Internet Explorer [增强安全配置](http://msdn.microsoft.com/library/default.asp?url=/workshop/security/szone/overview/esc_changes.asp)是一组预先配置的 Internet Explorer 设置，可以降低用户或管理员在服务器上下载并运行特制 Web 内容的可能性。 Internet Explorer 增强安全配置通过修改许多与安全有关的设置降低此风险。 这些设置包括“**Internet 选项**”对话框中的“**安全**”和“**高级**”选项卡设置。 一些重要的修改包括：

-   将 Internet 区域的安全级别设置为“**高**”。 这种设置将禁用脚本、ActiveX 控件、Microsoft Java 虚拟机 (MSJVM) 和文件下载。
-   禁止自动检测 Intranet 站点。 此设置将本地 Intranet 区域中未显式列出的所有 Intranet 网站和所有通用命名约定 (UNC) 路径都分配给 Internet 区域。
-   禁用了即需即装和非 Microsoft 浏览器扩展。 此设置禁止网页自动安装组件，并禁止运行非 Microsoft 扩展。
-   禁用多媒体内容。 此设置禁止播放音乐、动画和视频剪辑。

有关 Internet Explorer 增强安全配置的详细信息，请参阅下列[网站](http://www.microsoft.com/downloads/details.aspx?familyid=d41b036c-e2e1-4960-99bb-9757f7e9e31b)上的指南《管理 Internet Explorer 增强安全配置》。

**此更新有什么作用？**  
此更新通过修改受影响的操作系统在特定情况下检查消息输入的方式来消除此漏洞。

**发布此安全公告时，此漏洞是否已公开披露？**  
否。 Microsoft 通过可靠的披露渠道了解到有关此漏洞的信息。

#### EMF 特权提升漏洞 CVE-2007-1212：

呈现增强型图元文件 (EMF) 图像格式文件时存在一个特权提升漏洞。 在受影响的系统上呈现 EMF 图像的任何程序都可能容易受到此攻击。 成功利用此漏洞的攻击者可以完全控制受影响的系统。

#### EMF 特权提升漏洞 (CVE-2007-1212) 的缓解因素：

我们并未发现此漏洞的任何缓解因素。

#### EMF 特权提升漏洞 (CVE-2007-1212) 的变通办法：

我们并未发现此漏洞的任何变通办法 **。**

#### EMF 特权提升漏洞 (CVE-2007-1212) 的常见问题：

**此漏洞的影响范围有多大？**  
这是一个权限提升漏洞。 成功利用此漏洞的攻击者可以完全控制受影响的系统。 攻击者可随后安装程序；查看、更改或删除数据；或者创建拥有完全用户权限的新帐户。 要尝试利用此漏洞，攻击者必须能够本地登录到系统并运行程序。

**造成漏洞的原因是什么？**  
当呈现增强型图元文件 (EMF) 图像格式文件时 GDI 中未经检查的缓冲区。

**什么是增强型图元文件 (EMF) 图像格式？**  
EMF 图像格式是一个 32 位格式，其中可以同时包含矢量信息和位图信息。

有关图像类型和格式的详细信息，请参阅 [Microsoft 知识库文章 320314](http://support.microsoft.com/kb/320314)。有关这些文件格式的其他信息，请访问 [MSDN 技术资源库网站](http://msdn.microsoft.com/library/default.asp?url=/library/en-us/gdicpp/gdiplus/aboutgdiplus/imagesbitmapsandmetafiles/metafiles.asp)。

**攻击者可能利用此漏洞执行什么操作？**  
成功利用此漏洞的攻击者可以完全控制受影响的系统。

**攻击者如何利用此漏洞？**  
要利用此漏洞，攻击者必须先登录到系统。 然后，攻击者可能执行作为常规用户运行的程序来利用此漏洞，并完全控制受影响的系统。

**受此漏洞威胁最大的系统有哪些？**  
工作站受此漏洞的威胁最大。 如果管理员允许用户登录服务器并运行程序，服务器可能面临更大风险。 不过，最佳做法是不要授予这样的权限。

**是否可以通过 Internet 利用此漏洞？**  
否。 攻击者必须能够登录到作为攻击目标的特定系统。 攻击者无法利用此漏洞远程加载和运行程序。

**此更新有什么作用？**  
此更新通过修改受影响的操作系统版本在将消息传递到分配的缓冲区之前验证消息长度的方式来消除此漏洞。

**发布此安全公告时，此漏洞是否已公开披露？**  
否。 Microsoft 通过可靠的披露渠道了解到有关此漏洞的信息。

#### GDI 无效的窗口大小特权提升漏洞 - CVE-2006-5586：

图形呈现引擎由于呈现分层的应用程序窗口的方式而存在一个特权提升漏洞。 已登录的用户可通过利用此漏洞完全控制系统。

#### GDI 无效的窗口大小特权提升漏洞 (CVE-2006-5586) 的缓解因素：

攻击者必须能够本地登录才能利用此漏洞。 匿名用户无法利用此漏洞，也无法以远程方式利用此漏洞。

#### GDI 无效的窗口大小特权提升漏洞 (CVE-2006-5586) 的变通办法：

我们并未发现此漏洞的任何变通办法。

#### GDI 无效的窗口大小特权提升漏洞 (CVE-2006-5586) 的常见问题：

**此漏洞的影响范围有多大？**  
这是一个权限提升漏洞。 成功利用此漏洞的攻击者可以完全控制受影响的系统。 攻击者可随后安装程序；查看、更改或删除数据；或者创建拥有完全用户权限的新帐户。 要尝试利用此漏洞，攻击者必须能够本地登录到系统并运行程序。

**造成漏洞的原因是什么？**  
该漏洞是由于处理无效的应用程序窗口大小造成的。

**什么是图形设备接口 (GDI)？**  
Microsoft Windows 图形设备接口 (GDI) 允许应用程序在视频显示和打印机上使用图形和格式化文本。 基于 Windows 的应用程序不直接访问图形硬件。 而是 GDI 代表应用程序与设备驱动程序进行交互。 有关 GDI 的详细信息，请访问下列 MSDN 文章。

**攻击者可能利用此漏洞执行什么操作？**  
成功利用此漏洞的攻击者可以完全控制受影响的系统。

**攻击者如何利用此漏洞？**  
攻击者可能试图通过创建特制的应用程序并在受影响的系统上执行该程序来利用此漏洞。 应用程序可能创建一系列传递无效参数的分层窗口。 这样做，未经授权的攻击者可以完全控制受影响的系统。

**受此漏洞威胁最大的系统有哪些？**  
工作站受此漏洞的威胁最大。 如果管理员允许用户登录服务器并运行程序，服务器可能面临更大风险。 不过，最佳做法是不要授予这样的权限。

**是否可以通过 Internet 利用此漏洞？**  
否。 攻击者必须能够登录到作为攻击目标的特定系统。 攻击者无法利用此漏洞远程加载和运行程序。

**此更新有什么作用？**  
此更新通过修改在将数据传递到分配的缓冲区之前验证应用程序窗口大小的方式来消除此漏洞

**发布此安全公告时，此漏洞是否已公开披露？**  
在最初发布此安全公告时，Microsoft 未收到任何表明此漏洞已公开披露的信息。

**在发布此安全公告时，Microsoft 是否收到任何有关此漏洞已被利用的报告？**  
否。 在最初发布此安全公告时，Microsoft 未收到任何表明此漏洞已被公开用于攻击客户的信息，也没有看到任何发布的概念代码证明示例。

#### Windows 动态光标远程执行代码漏洞 - CVE-2007-0038：

Windows 处理光标、动态光标和图标格式的方式中存在远程执行代码漏洞。 攻击者可以通过构建恶意的光标或图标文件来利用此漏洞，如果用户访问了恶意网站或查看了特制的电子邮件，此漏洞就可能允许远程执行代码。 成功利用此漏洞的攻击者可以完全控制受影响的系统。

#### Windows 动态光标远程执行代码漏洞 (CVE-2007-0038) 的缓解因素：

-   如果客户在 Windows Vista 上使用 Windows Internet Explorer 7，则由于 Internet Explorer 的保护模式，他们可以免遭当前已知的基于 Web 的攻击。 有关 Internet Explorer 保护模式的详细信息，请参阅下列 [Windows 网站](http://www.microsoft.com/windows/products/windowsvista/features/details/ie7protectedmode.mspx)。
-   默认情况下，Microsoft Office Outlook 2007 使用 Microsoft Word 显示电子邮件，这样可保护客户免受 HTML 电子邮件预览和攻击媒介的攻击。
-   在基于 Web 的攻击中，攻击者必须拥有一个网站，并在上面放置用来利用此漏洞的网页。 攻击者还可以尝试构建一个网站并且通过它来提供带有恶意内容的网页，进而利用此漏洞。 攻击者无法强迫用户访问网站。 相反，攻击者必须劝诱用户访问该网站，通常是让用户单击通向攻击者站点或攻击者构建的站点的链接。
-   成功利用此漏洞的攻击者可以获得与本地用户相同的用户权限。 那些帐户被配置为拥有较少系统用户权限的用户比具有管理用户权限的用户受到的影响要小。

#### Windows 动态光标远程执行代码漏洞 (CVE-2007-0038) 的变通办法：

Microsoft 已测试以下变通办法。 尽管这些变通办法不能从根本上消除此漏洞，但它们有助于阻止已知的攻击媒介。 如果某种变通办法导致功能下降，下一节中将进行说明。

-   **如果您使用的是 Outlook 2002 Service Pack 3 或更高版本，请用纯文本格式阅读电子邮件，以帮助保护自己免受来自 HTML 电子邮件攻击媒介的攻击。**

    使用 Microsoft Outlook 2002 Service Pack 3 和 Microsoft Outlook Express 6 Service Pack 1 或更高版本的客户可以启用此设置，并查看未经过数字签名的电子邮件或者未加密的电子邮件。

    
**注意** 在 Outlook Express 上以纯文本格式阅读电子邮件并**不会**缓解尝试利用此漏洞的影响。

    
**注意** 在 Windows Vista 的 Windows Mail 上以纯文本格式阅读电子邮件的确可以缓解利用该漏洞的企图，但是在转发或回复攻击者发送的电子邮件的情况下，**不**提供缓解。

**变通办法的影响：** 用纯文本格式查看的电子邮件中不会包含图片、特殊字体、动画或其他丰富内容。 此外

-   这些更改适用于预览窗格和打开的邮件。
-   图片变成了附件，因此不会丢失。
-   由于存储区中的邮件仍然是 RTF 格式或 HTML 格式，因此对象模型（自定义代码解决方案）可能不按预期方式运行。

#### Windows 动态光标远程执行代码漏洞 (CVE-2007-0038) 的常见问题：

**此漏洞的影响范围有多大？**  
这是一个远程执行代码漏洞。 成功利用此漏洞的攻击者可以完全控制受影响的系统。 攻击者可随后安装程序；查看、更改或删除数据；或者创建拥有完全权限的新帐户。 帐户配置系统权限较少的用户比具有管理权限的用户受到的威胁要小。

**什么是动态光标？**  
动态光标是一种允许一系列帧显示在鼠标指针位置（而不是单个图像）的功能。 动态光标功能的指定后缀为 .ani。

**如果我阻止了扩展名为 .ani 的文件，这是否可以保护我不受到此漏洞的威胁？**  
否。 该漏洞并不受 .ani 文件扩展名的约束。 其他图像文件类型可能用于利用该漏洞。

**造成漏洞的原因是什么？**  
Windows 处理光标、动态光标和图标之前执行格式验证的方式中存在一个漏洞。

**攻击者可能利用此漏洞执行什么操作？**  
成功利用此漏洞的攻击者可以完全控制受影响的系统。

**攻击者如何利用此漏洞？**  
攻击者可能通过创建特制的网页来利用该漏洞。 攻击者还可以创建特制的电子邮件消息并将它发送至受影响的系统。 当查看网页时，预览或阅读特制的邮件或者打开特制的电子邮件附件，攻击者可能导致受影响的系统执行代码。 虽然动态光标通常与 .ani 文件扩展名相关联，但是成功的攻击并不受此文件类型的限制。

**受此漏洞威胁最大的系统有哪些？**  
工作站和终端服务器受到的威胁最大。 当没有足够管理权限的用户被授予登录到服务器并运行程序或浏览 Internet 的权限时，服务器会更有危险。 不过，最佳做法是不要授予这样的权限。

**此更新有什么作用？**  
此更新通过修改使用光标、动态光标和图标格式之前对其进行验证的方式来消除漏洞。

**发布此安全公告时，此漏洞是否已公开披露？**  
是。 此漏洞已公开披露。 已为此漏洞分配常见漏洞和披露号码 CVE-2007-0038。

**在发布此安全公告时，Microsoft 是否收到任何有关此漏洞已被利用的报告？**  
是。 在发布此安全公告时，Microsoft 已收到有关此漏洞已被利用的信息。

**Microsoft 如何看待动态光标漏洞的第三方修补程序的可用性？**  
Microsoft 建议客户下载并部署与本公告关联的安全更新。

总的来说，最佳做法是获取软件原始供应商针对软件漏洞提供的安全更新。 对于 Microsoft 软件，Microsoft 仔细检查和测试了安全更新以确保提供高质量的安全更新，并对这些更新的应用程序兼容性进行了彻底评估。 此外，Microsoft 将针对软件的所有受影响版本以 23 种语言同时发布安全更新。

Microsoft 无法对独立的第三方安全修补程序或缓解作出类似的保证。

**应用此安全更新是否有助于防止客户运行已公开发布的试图利用此漏洞的代码？**  
是。 此安全更新可消除当前正被利用的漏洞。 已为解决的漏洞分配了常见漏洞和披露号码 CVE-2007-0038。

#### GDI 不正确的参数本地特权提升漏洞 - CVE-2007-1215：

图形设备接口由于处理颜色相关参数的方式而存在一个本地特权提升漏洞。 此漏洞可能使攻击者能够完全控制系统。

#### GDI 不正确的参数本地特权提升漏洞 (CVE-2007-1215) 的缓解因素：

攻击者必须拥有有效的登录凭据并能本地登录才能利用此漏洞。 匿名用户无法利用此漏洞，也无法以远程方式利用此漏洞

#### GDI 不正确的参数本地特权提升漏洞 (CVE-2007-1215) 的变通办法：

我们并未发现此漏洞的任何变通办法。

#### GDI 不正确的参数本地特权提升漏洞 (CVE-2007-1215) 的常见问题：

**此漏洞的影响范围有多大？**  
这是一个本地特权提升漏洞。 成功利用此漏洞的攻击者可以完全控制受影响的系统。 具有有效登录凭据的攻击者随后可安装程序；查看、更改或删除数据；或者创建权限与已登录用户相同的新帐户。

**造成漏洞的原因是什么？**  
当基于 Windows 的程序呈现受影响的图像类型时，该程序会将颜色相关参数传递到 GDI 中未经检查的内存缓冲区。

**什么是图形设备接口 (GDI)？**  
Microsoft Windows 图形设备接口 (GDI) 允许应用程序在视频显示和打印机上使用图形和格式化文本。 基于 Windows 的应用程序不直接访问图形硬件。 而是 GDI 代表应用程序与设备驱动程序进行交互。 有关 GDI 的详细信息，请访问下列 [MSDN 文章](http://msdn.microsoft.com/library/default.asp?url=/library/en-us/gdi/wingdistart_9ezp.asp)。

**攻击者可能利用此漏洞执行什么操作？**  
成功利用此漏洞的攻击者可以完全控制受影响的系统。

**攻击者如何利用此漏洞？**  
任何渲染受影响的图像类型的程序都可能受到此攻击。 攻击者可以在本地登录系统，然后运行可以利用此漏洞的特制程序。

**受此漏洞威胁最大的系统有哪些？**  
工作站和终端服务器受到的威胁最大。 如果管理员允许用户登录服务器并运行程序或浏览网页，服务器可能面临更大风险。 不过，最佳做法是不要授予这样的权限。

**此更新有什么作用？**  
此更新通过修改图形设备接口在将数据传递到分配的缓冲区之前验证数据长度的方式来消除此漏洞。

**发布此安全公告时，此漏洞是否已公开披露？**  
否。 Microsoft 通过可靠的披露渠道了解到有关此漏洞的信息。

#### 字体光栅器本地特权提升漏洞 - CVE-2007-1213：

TrueType 字体光栅器由于处理损坏的或经过修改的字体类型而存在一个本地特权提升漏洞。 已登录的用户可通过利用此漏洞完全控制系统。

#### 字体光栅器本地特权提升漏洞 (CVE-2007-1213) 的缓解因素：

利用此漏洞的尝试最有可能导致拒绝服务情况，该情况是由受影响的系统意外重新启动造成的，而不是由本地特权提升造成的。

#### 字体光栅器本地特权提升漏洞 (CVE-2007-1213) 的变通办法：

我们并未发现此漏洞的任何变通办法。

#### 字体光栅器本地特权提升漏洞 (CVE-2007-1213) 的常见问题：

**此漏洞的影响范围有多大？**  
这是一个本地特权提升漏洞。 成功利用此漏洞的攻击者可以完全控制受影响的系统。 具有有效登录凭据的攻击者可随后安装程序；查看、更改或删除数据；或者创建拥有完全用户权限的新帐户。

**造成漏洞的原因是什么？**  
当处理损坏的或经过修改的字体时，TrueType 字体光栅器可能调用未初始化的函数指针。

**什么是 TrueType 字体光栅器？**  
TrueType 字体光栅器为屏幕和打印机生成字符位图，又称为光栅设备。

**攻击者可能利用此漏洞执行什么操作？**  
成功利用此漏洞的攻击者可以完全控制受影响的系统。

**哪些人可能会利用此漏洞？**  
要尝试利用此漏洞，攻击者必须能够以本地方式登录到系统并运行程序。

**攻击者如何利用此漏洞？**  
攻击者可能创建使用特制字体的应用程序，当 True Type 字体光栅器尝试呈现该特制字体时，光栅器将会允许攻击者完全控制受影响的系统。

**受此漏洞威胁最大的系统有哪些？**  
工作站和终端服务器受到的威胁最大。 如果管理员允许用户登录服务器并运行程序，服务器可能面临更大风险。 不过，最佳做法是不要授予这样的权限。

**此更新有什么作用？**  
此更新通过更改 TrueType 字体光栅器初始化 True Type 字体的方式来消除此漏洞。

**发布此安全公告时，此漏洞是否已公开披露？**  
否。 Microsoft 通过可靠的披露渠道了解到有关此漏洞的信息。

安全更新信息
------------


**受影响的软件：**

有关您的受影响软件的特定安全更新信息，请单击相应的链接：

#### Windows 2000（所有版本）

**先决条件**
对于 Windows 2000，此安全更新需要 Service Pack 4 (SP4)。 对于 Small Business Server 2000，此安全更新需要 Small Business Server 2000 Service Pack 1a (SP1a) 或与 Windows 2000 Server Service Pack 4 (SP4) 一起运行的 Small Business Server 2000。

已对列出的软件进行了测试，以确定这些版本是否会受到影响。 其他版本或者不再包括安全更新支持，或者可能不会受到影响。 要确定产品和版本的技术支持生命周期，请访问 [Microsoft 产品技术支持生命周期网站](http://go.microsoft.com/fwlink/?linkid=21742)。

有关如何获得最新 Service Pack 的详细信息，请参阅 [Microsoft 知识库文章 260910](http://support.microsoft.com/kb/260910)。

**包括在以后的 Service Pack 中**
没有为此操作系统计划其他 Service Pack。 此问题的更新程序将包含在以后的更新汇总中。

**安装信息**  

此安全更新支持以下安装开关。

<p> </p> 
<table class="dataTable">
<caption>
受支持的安全更新安装开关
</caption>
<tr class="thead">
<th>
开关
</th>
<th>
描述
</th>
</tr>
<tr>
<td style="border:1px solid black;">
**/help**
</td>
<td style="border:1px solid black;">
显示命令行选项。
</td>
</tr>
<tr>
<th colspan="2" style="border:1px solid black;">
安装模式
</th>
</tr>
<tr class="alternateRow">
<td style="border:1px solid black;">
**/passive**
</td>
<td style="border:1px solid black;">
无人参与安装模式。 无需用户交互操作，但会显示安装状态。 如果安装结束时需要重新启动，将显示一个带有计时器的对话框，警告计算机将在 30 秒后重新启动。
</td>
</tr>
<tr>
<td style="border:1px solid black;">
**/quiet**
</td>
<td style="border:1px solid black;">
安静模式。 这与无人参与模式相同，但是不显示任何状态或错误消息。
</td>
</tr>
<tr>
<th colspan="2" style="border:1px solid black;">
重新启动选项
</th>
</tr>
<tr class="alternateRow">
<td style="border:1px solid black;">
**/norestart**
</td>
<td style="border:1px solid black;">
安装完成后不重新启动。
</td>
</tr>
<tr>
<td style="border:1px solid black;">
**/forcerestart**
</td>
<td style="border:1px solid black;">
安装后重新启动计算机，且在关机时强制其他应用程序关闭而不先保存打开的文件。
</td>
</tr>
<tr class="alternateRow">
<td style="border:1px solid black;">
**/warnrestart\[:x\]**
</td>
<td style="border:1px solid black;">
显示一个带有计时器的对话框，警告计算机将在 *x* 秒后重新启动。 （默认设置为 30 秒。） 与 **/quiet** 开关或 **/passive** 开关一起使用。
</td>
</tr>
<tr>
<td style="border:1px solid black;">
**/promptrestart**
</td>
<td style="border:1px solid black;">
显示提示本地用户允许重新启动的对话框。
</td>
</tr>
<tr>
<th colspan="2" style="border:1px solid black;">
特殊选项
</th>
</tr>
<tr class="alternateRow">
<td style="border:1px solid black;">
**/overwriteoem**
</td>
<td style="border:1px solid black;">
不经提示而覆盖 OEM 文件。
</td>
</tr>
<tr>
<td style="border:1px solid black;">
**/nobackup**
</td>
<td style="border:1px solid black;">
不备份卸载所需的文件。
</td>
</tr>
<tr class="alternateRow">
<td style="border:1px solid black;">
**/forceappsclose**
</td>
<td style="border:1px solid black;">
在计算机关机时强制关闭其他程序。
</td>
</tr>
<tr>
<td style="border:1px solid black;">
**/log:path**
</td>
<td style="border:1px solid black;">
允许重定向安装日志文件。
</td>
</tr>
<tr class="alternateRow">
<td style="border:1px solid black;">
**/integrate:path**
</td>
<td style="border:1px solid black;">
将更新集成到 Windows 源文件中。 这些文件位于开关中指定的路径中。
</td>
</tr>
<tr>
<td style="border:1px solid black;">
**/extract\[:path\]**
</td>
<td style="border:1px solid black;">
提取文件而不启动安装程序。
</td>
</tr>
<tr class="alternateRow">
<td style="border:1px solid black;">
**/ER**
</td>
<td style="border:1px solid black;">
启用扩展错误报告功能。
</td>
</tr>
<tr>
<td style="border:1px solid black;">
**/verbose**
</td>
<td style="border:1px solid black;">
启用详细日志记录。 在安装期间，创建 %Windir%\\CabBuild.log。此日志详述了被复制的文件。 使用此开关可能导致安装过程变慢。
</td>
</tr>
</table>
<p> </p>

**注意** 可以将这些开关组合到一个命令中。 为了保持向后兼容，此安全更新还支持以前版本的安装程序所使用的安装开关。 有关受支持的安装开关的详细信息，请参阅 [Microsoft 知识库文章 262841](http://support.microsoft.com/kb/262841)。有关 Update.exe 安装程序的详细信息，请访问 [Microsoft TechNet 网站](http://go.microsoft.com/fwlink/?linkid=38951)。 有关本公告中出现的术语（如“*修补程序*”）的详细信息，请参阅 [Microsoft 知识库文章 824684](http://support.microsoft.com/kb/824684)。

**部署信息**

对于 Windows 2000 Service Pack 4，要在没有任何用户干预的情况下安装此安全更新，请在命令提示符处使用以下命令：

**Windows2000-kb925902-x86-enu /quiet**


**注意** 使用 **/quiet** 开关将抑制所有消息。 这包括抑制失败消息。 管理员应该使用其中一种支持的方法，验证使用 **/quiet** 开关时安装是否成功。 管理员还应该检查 **KB925902**.log 文件，查看使用此开关时的任何失败消息。

对于 Windows 2000 Service Pack 4，如果在安装此安全更新后不强制系统重新启动，请在命令提示符处使用以下命令：

**Windows2000-kb925902-x86-enu /norestart**

有关如何使用 Software Update Services 部署此安全更新的详细信息，请访问 [Software Update Services 网站](http://go.microsoft.com/fwlink/?linkid=21125)。 有关如何使用 Windows Server Update Services 部署此安全更新的详细信息，请访问 [Windows Server Update Services 网站](http://go.microsoft.com/fwlink/?linkid=50120)。 此安全更新还将通过 [Microsoft Update 网站](http://update.microsoft.com/microsoftupdate)提供。

**重新启动要求**

应用此安全更新后，必须重新启动系统。

**删除信息**

要删除此安全更新，请使用“控制面板”中的“添加或删除程序”工具。

系统管理员也可以使用 Spuninst.exe 实用工具删除此安全更新。 Spuninst.exe 实用工具位于 %Windir%\\$NTUninstall**KB925902**$\\Spuninst 文件夹中。

<p> </p> 
<table class="dataTable">
<caption>
受支持的 Spuninst.exe 开关
</caption>
<tr class="thead">
<th>
开关
</th>
<th>
描述
</th>
</tr>
<tr>
<td style="border:1px solid black;">
**/help**
</td>
<td style="border:1px solid black;">
显示命令行选项。
</td>
</tr>
<tr>
<th colspan="2" style="border:1px solid black;">
安装模式
</th>
</tr>
<tr class="alternateRow">
<td style="border:1px solid black;">
**/passive**
</td>
<td style="border:1px solid black;">
无人参与安装模式。 无需用户交互操作，但会显示安装状态。 如果安装结束时需要重新启动，将显示一个带有计时器的对话框，警告计算机将在 30 秒后重新启动。
</td>
</tr>
<tr>
<td style="border:1px solid black;">
**/quiet**
</td>
<td style="border:1px solid black;">
安静模式。 这与无人参与模式相同，但是不显示任何状态或错误消息。
</td>
</tr>
<tr>
<th colspan="2" style="border:1px solid black;">
重新启动选项
</th>
</tr>
<tr class="alternateRow">
<td style="border:1px solid black;">
**/norestart**
</td>
<td style="border:1px solid black;">
安装完成后不重新启动。
</td>
</tr>
<tr>
<td style="border:1px solid black;">
**/forcerestart**
</td>
<td style="border:1px solid black;">
安装后重新启动计算机，且在关机时强制其他应用程序关闭而不先保存打开的文件。
</td>
</tr>
<tr class="alternateRow">
<td style="border:1px solid black;">
**/warnrestart\[:x\]**
</td>
<td style="border:1px solid black;">
显示一个带有计时器的对话框，警告计算机将在 *x* 秒后重新启动。 （默认设置为 30 秒。） 与 **/quiet** 开关或 **/passive** 开关一起使用。
</td>
</tr>
<tr>
<td style="border:1px solid black;">
**/promptrestart**
</td>
<td style="border:1px solid black;">
显示提示本地用户允许重新启动的对话框。
</td>
</tr>
<tr>
<th colspan="2" style="border:1px solid black;">
特殊选项
</th>
</tr>
<tr class="alternateRow">
<td style="border:1px solid black;">
**/forceappsclose**
</td>
<td style="border:1px solid black;">
在计算机关机时强制关闭其他程序。
</td>
</tr>
<tr>
<td style="border:1px solid black;">
**/log:path**
</td>
<td style="border:1px solid black;">
允许重定向安装日志文件。
</td>
</tr>
</table>
<p> </p>

**文件信息**

此安全更新的英文版具有下表所列的文件属性。 这些文件的日期和时间按照协调通用时间 (UTC) 列出。 当您查看文件信息时，它将转换为本地时间。 要了解 UTC 与本地时间之间的时差，请使用“控制面板”上的“日期/时间”工具中的“**时区**”选项卡。

Windows 2000 Service Pack 4 和 Small Business Server 2000：

| 文件名     | 版本          | 日期              | 时间  | 大小      | 文件夹  |
|------------|---------------|-------------------|-------|-----------|---------|
| gdi32.dll  | 5.0.2195.7133 | 2007 年 3 月 6 日 | 11:17 | 235,280   | .       |
| mf3216.dll | 5.0.2195.7133 | 2007 年 3 月 6 日 | 11:17 | 38,160    | .       |
| user32.dll | 5.0.2195.7133 | 2007 年 3 月 7 日 | 00:47 | 381,200   | .       |
| win32k.sys | 5.0.2195.7133 | 2007 年 3 月 6 日 | 06:12 | 1,641,936 | .       |
| win32k.sys | 5.0.2195.7133 | 2007 年 3 月 6 日 | 06:12 | 1,641,936 | uniproc |

**验证是否已应用更新**

-   **Microsoft Baseline Security Analyzer**

    要验证受影响的系统上是否应用了安全更新，可以使用 Microsoft Baseline Security Analyzer (MBSA) 工具。 请参阅本安全公告前面的“与此安全更新相关的常见问题 (FAQ)”部分的常见问题“可否使用 Microsoft 基准安全分析器 (MBSA) 确定是否需要此更新？”。

-   **文件版本验证**

    
**注意** 由于 Microsoft Windows 有多个版本，因此以下步骤可能会因您的计算机而不同。 如果不同，请参阅产品文档来完成这些步骤。

1.  单击“**开始**”，然后单击“**搜索**”。  
2.  在“**搜索结果**”窗格中，单击“**搜索助理**”下的“**所有文件和文件夹**”。  
3.  在“**完整或部分文件名**”框中，键入相应文件信息表中的一个文件名，然后单击“**搜索**”。  
4.  在文件列表中，用鼠标右键单击相应文件信息表中的一个文件名，然后单击“**属性**”。  
        
**注意** 由于安装的操作系统或程序的版本不同，因此文件信息表中所列的某些文件可能并未安装。
5.  在“**版本**”选项卡上，通过将计算机上安装的文件与相应文件信息表中记录的版本进行比较来确定该文件的版本。
        
**注意** 在安装过程中，除文件版本以外的其他属性均可能会发生变化。 不支持通过将其他文件属性与文件信息表中的信息进行比较这种方法来验证是否应用了更新。 另外，在某些情况下，在安装过程中还可能会重命名文件。 如果没有文件或版本信息，请使用另外一种方法来验证更新安装。

-   **注册表项验证**

    也可以通过查看以下注册表项，检查此安全更新已安装的文件：

    HKEY\_LOCAL\_MACHINE\\SOFTWARE\\Microsoft\\Updates\\Windows 2000\\SP5\\KB925902\\Filelist

    
**注意** 此注册表项可能不包含已安装文件的完整列表。 另外，如果管理员或 OEM 将安全更新集成或组合到 Windows 安装源文件中，可能无法正确创建此注册表项。

#### Windows XP（所有版本）

**先决条件**
此安全更新需要 Windows XP Service Pack 2 或者 Windows XP Professional x64 Edition。 有关如何获得最新的 Windows XP Service Pack 的详细信息，请参阅 [Microsoft 知识库文章 322389](http://support.microsoft.com/kb/322389)。有关如何获得 Windows XP Professional x64 Edition Service Pack 2 的详细信息，请参阅此[网站](http://www.microsoft.com/downloads/details.aspx?familyid=893fd6c0-6283-44c3-bb84-b2f0315b2ae6&displaylang=en)。

**包括在以后的 Service Pack 中**
此问题的更新程序将包含在以后的 Service Pack 或更新汇总中。

**安装信息**  

此安全更新支持以下安装开关。

<p> </p> 
<table class="dataTable">
<caption>
受支持的安全更新安装开关
</caption>
<tr class="thead">
<th>
开关
</th>
<th>
描述
</th>
</tr>
<tr>
<td style="border:1px solid black;">
**/help**
</td>
<td style="border:1px solid black;">
显示命令行选项。
</td>
</tr>
<tr>
<th colspan="2" style="border:1px solid black;">
安装模式
</th>
</tr>
<tr class="alternateRow">
<td style="border:1px solid black;">
**/passive**
</td>
<td style="border:1px solid black;">
无人参与安装模式。 无需用户交互操作，但会显示安装状态。 如果安装结束时需要重新启动，将显示一个带有计时器的对话框，警告计算机将在 30 秒后重新启动。
</td>
</tr>
<tr>
<td style="border:1px solid black;">
**/quiet**
</td>
<td style="border:1px solid black;">
安静模式。 这与无人参与模式相同，但是不显示任何状态或错误消息。
</td>
</tr>
<tr>
<th colspan="2" style="border:1px solid black;">
重新启动选项
</th>
</tr>
<tr class="alternateRow">
<td style="border:1px solid black;">
**/norestart**
</td>
<td style="border:1px solid black;">
安装完成后不重新启动。
</td>
</tr>
<tr>
<td style="border:1px solid black;">
**/forcerestart**
</td>
<td style="border:1px solid black;">
安装后重新启动计算机，且在关机时强制其他应用程序关闭而不先保存打开的文件。
</td>
</tr>
<tr class="alternateRow">
<td style="border:1px solid black;">
**/warnrestart\[:x\]**
</td>
<td style="border:1px solid black;">
显示一个带有计时器的对话框，警告计算机将在 *x* 秒后重新启动。 （默认设置为 30 秒。） 与 **/quiet** 开关或 **/passive** 开关一起使用。
</td>
</tr>
<tr>
<td style="border:1px solid black;">
**/promptrestart**
</td>
<td style="border:1px solid black;">
显示提示本地用户允许重新启动的对话框。
</td>
</tr>
<tr>
<th colspan="2" style="border:1px solid black;">
特殊选项
</th>
</tr>
<tr class="alternateRow">
<td style="border:1px solid black;">
**/overwriteoem**
</td>
<td style="border:1px solid black;">
不经提示而覆盖 OEM 文件。
</td>
</tr>
<tr>
<td style="border:1px solid black;">
**/nobackup**
</td>
<td style="border:1px solid black;">
不备份卸载所需的文件。
</td>
</tr>
<tr class="alternateRow">
<td style="border:1px solid black;">
**/forceappsclose**
</td>
<td style="border:1px solid black;">
在计算机关机时强制关闭其他程序。
</td>
</tr>
<tr>
<td style="border:1px solid black;">
**/log:path**
</td>
<td style="border:1px solid black;">
允许重定向安装日志文件。
</td>
</tr>
<tr class="alternateRow">
<td style="border:1px solid black;">
**/integrate:path**
</td>
<td style="border:1px solid black;">
将更新集成到 Windows 源文件中。 这些文件位于开关中指定的路径中。
</td>
</tr>
<tr>
<td style="border:1px solid black;">
**/extract\[:path\]**
</td>
<td style="border:1px solid black;">
提取文件而不启动安装程序。
</td>
</tr>
<tr class="alternateRow">
<td style="border:1px solid black;">
**/ER**
</td>
<td style="border:1px solid black;">
启用扩展错误报告功能。
</td>
</tr>
<tr>
<td style="border:1px solid black;">
**/verbose**
</td>
<td style="border:1px solid black;">
启用详细日志记录。 在安装期间，创建 %Windir%\\CabBuild.log。此日志详述了被复制的文件。 使用此开关可能导致安装过程变慢。
</td>
</tr>
</table>
<p> </p>

**注意** 可以将这些开关组合到一个命令中。 为了保持向后兼容，此安全更新还支持以前版本的安装程序所使用的安装开关。 有关受支持的安装开关的详细信息，请参阅 [Microsoft 知识库文章 262841](http://support.microsoft.com/kb/262841)。有关 Update.exe 安装程序的详细信息，请访问 [Microsoft TechNet 网站](http://go.microsoft.com/fwlink/?linkid=38951)。

**部署信息**

对于 Microsoft Windows XP，要在没有任何用户干预的情况下安装此安全更新，请在命令提示符处使用以下命令：

**Windowsxp-kb925902-x86-enu /quiet**


**注意** 使用 **/quiet** 开关将抑制所有消息。 这包括抑制失败消息。 管理员应该使用其中一种支持的方法，验证使用 **/quiet** 开关时安装是否成功。 管理员还应该检查 KB925902.log 文件，查看使用此开关时的任何失败消息。

对于 Windows XP，要安装此安全更新而不强制重新启动系统，请在命令提示符处使用以下命令：

**Windowsxp-kb925902-x86-enu /norestart**

有关如何使用 Software Update Services 部署此安全更新的信息，请访问 [Software Update Services 网站](http://go.microsoft.com/fwlink/?linkid=21125)。 有关如何使用 Windows Server Update Services 部署此安全更新的详细信息，请访问 [Windows Server Update Services 网站](http://go.microsoft.com/fwlink/?linkid=50120)。 此安全更新还将通过 [Microsoft Update 网站](http://update.microsoft.com/microsoftupdate)提供。

**重新启动要求**

应用此安全更新后，必须重新启动系统。

**删除信息**

要删除此安全更新，请使用“控制面板”中的“添加或删除程序”工具。

系统管理员也可以使用 Spuninst.exe 实用工具删除此安全更新。 Spuninst.exe 实用工具位于 %Windir%\\$NTUninstall**KB925902**$\\Spuninst 文件夹中。

<p> </p> 
<table class="dataTable">
<caption>
受支持的 Spuninst.exe 开关
</caption>
<tr class="thead">
<th>
开关
</th>
<th>
描述
</th>
</tr>
<tr>
<td style="border:1px solid black;">
**/help**
</td>
<td style="border:1px solid black;">
显示命令行选项。
</td>
</tr>
<tr>
<th colspan="2" style="border:1px solid black;">
安装模式
</th>
</tr>
<tr class="alternateRow">
<td style="border:1px solid black;">
**/passive**
</td>
<td style="border:1px solid black;">
无人参与安装模式。 无需用户交互操作，但会显示安装状态。 如果安装结束时需要重新启动，将显示一个带有计时器的对话框，警告计算机将在 30 秒后重新启动。
</td>
</tr>
<tr>
<td style="border:1px solid black;">
**/quiet**
</td>
<td style="border:1px solid black;">
安静模式。 这与无人参与模式相同，但是不显示任何状态或错误消息。
</td>
</tr>
<tr>
<th colspan="2" style="border:1px solid black;">
重新启动选项
</th>
</tr>
<tr class="alternateRow">
<td style="border:1px solid black;">
**/norestart**
</td>
<td style="border:1px solid black;">
安装完成后不重新启动。
</td>
</tr>
<tr>
<td style="border:1px solid black;">
**/forcerestart**
</td>
<td style="border:1px solid black;">
安装后重新启动计算机，且在关机时强制其他应用程序关闭而不先保存打开的文件。
</td>
</tr>
<tr class="alternateRow">
<td style="border:1px solid black;">
**/warnrestart\[:x\]**
</td>
<td style="border:1px solid black;">
显示一个带有计时器的对话框，警告计算机将在 *x* 秒后重新启动。 （默认设置为 30 秒。） 与 **/quiet** 开关或 **/passive** 开关一起使用。
</td>
</tr>
<tr>
<td style="border:1px solid black;">
**/promptrestart**
</td>
<td style="border:1px solid black;">
显示提示本地用户允许重新启动的对话框。
</td>
</tr>
<tr>
<th colspan="2" style="border:1px solid black;">
特殊选项
</th>
</tr>
<tr class="alternateRow">
<td style="border:1px solid black;">
**/forceappsclose**
</td>
<td style="border:1px solid black;">
在计算机关机时强制关闭其他程序。
</td>
</tr>
<tr>
<td style="border:1px solid black;">
**/log:path**
</td>
<td style="border:1px solid black;">
允许重定向安装日志文件。
</td>
</tr>
</table>
<p> </p>

**文件信息**

此安全更新的英文版具有下表所列的文件属性。 这些文件的日期和时间按照协调通用时间 (UTC) 列出。 当您查看文件信息时，它将转换为本地时间。 要了解 UTC 与本地时间之间的时差，请使用“控制面板”上的“日期/时间”工具中的“**时区**”选项卡。

Windows XP Home Edition Service Pack 2、Windows XP Professional Service Pack 2、Windows XP Tablet PC Edition 2005 和 Windows XP Media Center Edition 2005：

| 文件名     | 版本          | 日期              | 时间  | 大小      | 文件夹 |
|------------|---------------|-------------------|-------|-----------|--------|
| gdi32.dll  | 5.1.2600.3099 | 2007 年 3 月 8 日 | 15:36 | 281,600   | SP2GDR |
| mf3216.dll | 5.1.2600.3099 | 2007 年 3 月 8 日 | 15:36 | 40,960    | SP2GDR |
| user32.dll | 5.1.2600.3099 | 2007 年 3 月 8 日 | 15:36 | 577,536   | SP2GDR |
| win32k.sys | 5.1.2600.3099 | 2007 年 3 月 8 日 | 13:47 | 1,843,584 | SP2GDR |
| gdi32.dll  | 5.1.2600.3099 | 2007 年 3 月 8 日 | 15:48 | 282,112   | SP2QFE |
| mf3216.dll | 5.1.2600.3099 | 2007 年 3 月 8 日 | 15:48 | 40,960    | SP2QFE |
| user32.dll | 5.1.2600.3099 | 2007 年 3 月 8 日 | 15:48 | 578,048   | SP2QFE |
| win32k.sys | 5.1.2600.3099 | 2007 年 3 月 8 日 | 13:49 | 1,843,968 | SP2QFE |

Windows XP Professional x64 Edition 和 Windows XP Professional x64 Edition Service Pack 2：

| 文件名      | 版本          | 日期              | 时间  | 大小      | CPU | 文件夹      |
|-------------|---------------|-------------------|-------|-----------|-----|-------------|
| Gdi32.dll   | 5.2.3790.2892 | 2007 年 3 月 2 日 | 08:56 | 616,960   | x64 | SP1GDR      |
| Mf3216.dll  | 5.2.3790.2892 | 2007 年 3 月 2 日 | 08:56 | 95,744    | x64 | SP1GDR      |
| User32.dll  | 5.2.3790.2892 | 2007 年 3 月 2 日 | 08:56 | 1,085,952 | x64 | SP1GDR      |
| Win32k.sys  | 5.2.3790.2892 | 2007 年 3 月 2 日 | 08:56 | 4,525,568 | x64 | SP1GDR      |
| Wgdi32.dll  | 5.2.3790.2892 | 2007 年 3 月 2 日 | 08:56 | 287,232   | x86 | SP1GDR\\WOW |
| Wmf3216.dll | 5.2.3790.2892 | 2007 年 3 月 2 日 | 08:56 | 41,472    | x86 | SP1GDR\\WOW |
| Wuser32.dll | 5.2.3790.2892 | 2007 年 3 月 2 日 | 08:56 | 602,112   | x86 | SP1GDR\\WOW |
| Gdi32.dll   | 5.2.3790.2892 | 2007 年 3 月 2 日 | 08:56 | 617,472   | x64 | SP1QFE      |
| Mf3216.dll  | 5.2.3790.2892 | 2007 年 3 月 2 日 | 08:56 | 95,744    | x64 | SP1QFE      |
| User32.dll  | 5.2.3790.2892 | 2007 年 3 月 2 日 | 08:56 | 1,085,952 | x64 | SP1QFE      |
| Win32k.sys  | 5.2.3790.2892 | 2007 年 3 月 2 日 | 08:56 | 4,536,320 | x64 | SP1QFE      |
| Wgdi32.dll  | 5.2.3790.2892 | 2007 年 3 月 2 日 | 08:56 | 287,744   | x86 | SP1QFE\\WOW |
| Wmf3216.dll | 5.2.3790.2892 | 2007 年 3 月 2 日 | 08:56 | 41,472    | x86 | SP1QFE\\WOW |
| Wuser32.dll | 5.2.3790.2892 | 2007 年 3 月 2 日 | 08:56 | 602,112   | x86 | SP1QFE\\WOW |
| Gdi32.dll   | 5.2.3790.4033 | 2007 年 3 月 2 日 | 09:54 | 619,520   | x64 | SP2GDR      |
| Mf3216.dll  | 5.2.3790.4033 | 2007 年 3 月 2 日 | 09:54 | 95,744    | x64 | SP2GDR      |
| User32.dll  | 5.2.3790.4033 | 2007 年 3 月 2 日 | 09:54 | 1,086,464 | x64 | SP2GDR      |
| Win32k.sys  | 5.2.3790.4033 | 2007 年 3 月 2 日 | 09:54 | 4,530,176 | x64 | SP2GDR      |
| Wgdi32.dll  | 5.2.3790.4033 | 2007 年 3 月 2 日 | 09:54 | 290,816   | x86 | SP2GDR\\WOW |
| Wmf3216.dll | 5.2.3790.4033 | 2007 年 3 月 2 日 | 09:54 | 40,960    | x86 | SP2GDR\\WOW |
| Wuser32.dll | 5.2.3790.4033 | 2007 年 3 月 2 日 | 09:54 | 602,624   | x86 | SP2GDR\\WOW |
| Gdi32.dll   | 5.2.3790.4033 | 2007 年 3 月 2 日 | 08:56 | 619,520   | x64 | SP2QFE      |
| Mf3216.dll  | 5.2.3790.4033 | 2007 年 3 月 2 日 | 08:56 | 95,744    | x64 | SP2QFE      |
| User32.dll  | 5.2.3790.4033 | 2007 年 3 月 2 日 | 08:56 | 1,086,464 | x64 | SP2QFE      |
| Win32k.sys  | 5.2.3790.4033 | 2007 年 3 月 2 日 | 08:56 | 4,530,176 | x64 | SP2QFE      |
| Wgdi32.dll  | 5.2.3790.4033 | 2007 年 3 月 2 日 | 08:56 | 290,816   | x86 | SP2QFE\\WOW |
| Wmf3216.dll | 5.2.3790.4033 | 2007 年 3 月 2 日 | 08:56 | 40,960    | x86 | SP2QFE\\WOW |
| Wuser32.dll | 5.2.3790.4033 | 2007 年 3 月 2 日 | 08:56 | 602,624   | x86 | SP2QFE\\WOW |


**注意** 当您安装这些安全更新时，安装程序将检查系统中正在更新的一个或多个文件是否已由 Microsoft 修补程序更新。

如果以前安装的修补程序已经更新过其中的某个文件，安装程序就会将 RTMQFE、SP1QFE 或 SP2QFE 文件复制到系统中。 否则，安装程序将 RTMGDR、SP1GDR 或 SP2GDR 文件复制到您的系统中。 安全更新可能不包含这些文件的所有版本。 有关此行为的详细信息，请参阅 [Microsoft 知识库文章 824994](http://support.microsoft.com/kb/824994)。

有关 Update.exe 安装程序的详细信息，请访问 [Microsoft TechNet 网站](http://go.microsoft.com/fwlink/?linkid=38951)。

有关本公告中出现的术语（如“*修补程序*”）的详细信息，请参阅 [Microsoft 知识库文章 824684](http://support.microsoft.com/kb/824684)。

**验证是否已应用更新**

-   **Microsoft Baseline Security Analyzer**

    要验证受影响的系统上是否应用了安全更新，可以使用 Microsoft Baseline Security Analyzer (MBSA) 工具。 请参阅本安全公告前面的“与此安全更新相关的常见问题 (FAQ)”部分的常见问题“可否使用 Microsoft 基准安全分析器 (MBSA) 确定是否需要此更新？”。

-   **文件版本验证**

    
**注意** 由于 Microsoft Windows 有多个版本，因此以下步骤可能会因您的计算机而不同。 如果不同，请参阅产品文档来完成这些步骤。

1.  单击“**开始**”，然后单击“**搜索**”。  
2.  在“**搜索结果**”窗格中，单击“**搜索助理**”下的“**所有文件和文件夹**”。  
3.  在“**完整或部分文件名**”框中，键入相应文件信息表中的一个文件名，然后单击“**搜索**”。  
4.  在文件列表中，用鼠标右键单击相应文件信息表中的一个文件名，然后单击“**属性**”。  
        
**注意** 由于安装的操作系统或程序的版本不同，因此文件信息表中所列的某些文件可能并未安装。
5.  在“**版本**”选项卡上，通过将计算机上安装的文件与相应文件信息表中记录的版本进行比较来确定该文件的版本。
        
**注意** 在安装过程中，除文件版本以外的其他属性均可能会发生变化。 不支持通过将其他文件属性与文件信息表中的信息进行比较这种方法来验证是否应用了更新。 另外，在某些情况下，在安装过程中还可能会重命名文件。 如果没有文件或版本信息，请使用另外一种方法来验证更新安装。

-   **注册表项验证**

    也可以通过查看以下注册表项，检查此安全更新已安装的文件。

    对于 Windows XP Home Edition Service Pack 2、Windows XP Professional Service Pack 2、Windows XP Tablet PC Edition 2005 和 Windows XP Media Center Edition 2005：

    HKEY\_LOCAL\_MACHINE\\SOFTWARE\\Microsoft\\Updates\\Windows XP\\SP3\\KB925902\\Filelist

    对于 Windows XP Professional x64 Edition 和 Windows XP Professional x64 Edition Service Pack 2：

    HKEY\_LOCAL\_MACHINE\\SOFTWARE\\Microsoft\\Updates\\Windows XP Version 2003\\SP3\\KB925902\\Filelist

    
**注意** 这些注册表项可能不包含已安装文件的完整列表。 另外，如果管理员或 OEM 将安全更新集成或组合到 Windows 安装源文件中，则可能无法正确创建这些注册表项。

#### Windows Server 2003（所有版本）

**先决条件**
此安全更新需要 Windows Server 2003、Windows Server 2003 Service Pack 1、Windows Server 2003 Service Pack 2、Windows Server 2003（用于基于 Itanium 的系统）、Windows Server 2003 SP1（用于基于 Itanium 的系统）、Windows Server 2003 SP2（用于基于 Itanium 的系统）、Windows Server 2003 x64 Edition 或 Windows Server 2003 x64 Edition Service Pack 2。

**包括在以后的 Service Pack 中**
此问题的更新程序将包含在以后的 Service Pack 或更新汇总中。

**安装信息**  

此安全更新支持以下安装开关。

<p> </p> 
<table class="dataTable">
<caption>
受支持的安全更新安装开关
</caption>
<tr class="thead">
<th>
开关
</th>
<th>
描述
</th>
</tr>
<tr>
<td style="border:1px solid black;">
**/help**
</td>
<td style="border:1px solid black;">
显示命令行选项。
</td>
</tr>
<tr>
<th colspan="2" style="border:1px solid black;">
安装模式
</th>
</tr>
<tr class="alternateRow">
<td style="border:1px solid black;">
**/passive**
</td>
<td style="border:1px solid black;">
无人参与安装模式。 无需用户交互操作，但会显示安装状态。 如果安装结束时需要重新启动，将显示一个带有计时器的对话框，警告计算机将在 30 秒后重新启动。
</td>
</tr>
<tr>
<td style="border:1px solid black;">
**/quiet**
</td>
<td style="border:1px solid black;">
安静模式。 这与无人参与模式相同，但是不显示任何状态或错误消息。
</td>
</tr>
<tr>
<th colspan="2" style="border:1px solid black;">
重新启动选项
</th>
</tr>
<tr class="alternateRow">
<td style="border:1px solid black;">
**/norestart**
</td>
<td style="border:1px solid black;">
安装完成后不重新启动。
</td>
</tr>
<tr>
<td style="border:1px solid black;">
**/forcerestart**
</td>
<td style="border:1px solid black;">
安装后重新启动计算机，且在关机时强制其他应用程序关闭而不先保存打开的文件。
</td>
</tr>
<tr class="alternateRow">
<td style="border:1px solid black;">
**/warnrestart\[:x\]**
</td>
<td style="border:1px solid black;">
显示一个带有计时器的对话框，警告计算机将在 *x* 秒后重新启动。 （默认设置为 30 秒。） 与 **/quiet** 开关或 **/passive** 开关一起使用。
</td>
</tr>
<tr>
<td style="border:1px solid black;">
**/promptrestart**
</td>
<td style="border:1px solid black;">
显示提示本地用户允许重新启动的对话框。
</td>
</tr>
<tr>
<th colspan="2" style="border:1px solid black;">
特殊选项
</th>
</tr>
<tr class="alternateRow">
<td style="border:1px solid black;">
**/overwriteoem**
</td>
<td style="border:1px solid black;">
不经提示而覆盖 OEM 文件。
</td>
</tr>
<tr>
<td style="border:1px solid black;">
**/nobackup**
</td>
<td style="border:1px solid black;">
不备份卸载所需的文件。
</td>
</tr>
<tr class="alternateRow">
<td style="border:1px solid black;">
**/forceappsclose**
</td>
<td style="border:1px solid black;">
在计算机关机时强制关闭其他程序。
</td>
</tr>
<tr>
<td style="border:1px solid black;">
**/log: path**
</td>
<td style="border:1px solid black;">
允许重定向安装日志文件。
</td>
</tr>
<tr class="alternateRow">
<td style="border:1px solid black;">
**/integrate:path**
</td>
<td style="border:1px solid black;">
将更新集成到 Windows 源文件中。 这些文件位于开关中指定的路径中。
</td>
</tr>
<tr>
<td style="border:1px solid black;">
**/extract\[:path\]**
</td>
<td style="border:1px solid black;">
提取文件而不启动安装程序。
</td>
</tr>
<tr class="alternateRow">
<td style="border:1px solid black;">
**/ER**
</td>
<td style="border:1px solid black;">
启用扩展错误报告功能。
</td>
</tr>
<tr>
<td style="border:1px solid black;">
**/verbose**
</td>
<td style="border:1px solid black;">
启用详细日志记录。 在安装期间，创建 %Windir%\\CabBuild.log。此日志详述了被复制的文件。 使用此开关可能导致安装过程变慢。
</td>
</tr>
</table>
<p> </p>

**注意** 可以将这些开关组合到一个命令中。 为了保持向后兼容，此安全更新还支持以前版本的安装程序所使用的许多安装开关。 有关受支持的安装开关的详细信息，请参阅 [Microsoft 知识库文章 262841](http://support.microsoft.com/kb/262841)。有关 Update.exe 安装程序的详细信息，请访问 [Microsoft TechNet 网站](http://go.microsoft.com/fwlink/?linkid=38951)。

**部署信息**

对于 Windows Server 2003，要在没有任何用户干预的情况下安装此安全更新，请在命令提示符处使用以下命令：

**Windowsserver2003-kb925902-x86-enu /quiet**


**注意** 使用 **/quiet** 开关将抑制所有消息。 这包括抑制失败消息。 管理员应该使用其中一种支持的方法，验证使用 **/quiet** 开关时安装是否成功。 管理员还应该检查 KB925902.log 文件，查看使用此开关时的任何失败消息。

对于 Windows Server 2003，要安装此安全更新而不强制重新启动系统，请在命令提示符处使用以下命令：

**Windowsserver2003-kb925902-x86-enu /norestart**

有关如何使用 Software Update Services 部署此安全更新的信息，请访问 [Software Update Services 网站](http://go.microsoft.com/fwlink/?linkid=21125)。 有关如何使用 Windows Server Update Services 部署此安全更新的详细信息，请访问 [Windows Server Update Services 网站](http://go.microsoft.com/fwlink/?linkid=50120)。 此安全更新还将通过 [Microsoft Update 网站](http://update.microsoft.com/microsoftupdate)提供。

**重新启动要求**

应用此安全更新后，必须重新启动系统。

此安全更新不支持 HotPatching。 有关 HotPatching 的详细信息，请参阅 [Microsoft 知识库文章 897341](http://support.microsoft.com/kb/897341)。


**注意** 并非所有安全更新均支持 HotPatching，某些支持 HotPatching 的安全更新可能要求您在安装安全更新之后重新启动服务器。 只有当安全更新替代的文件为通用分布版本 (GDR) 文件时，才支持 HotPatching。 如果您之前安装了修补程序来更新安全更新中包括的某个文件，则不支持 HotPatching。 有关此行为的详细信息，请参阅 [Microsoft 知识库文章 897341](http://support.microsoft.com/kb/897341) 和 [Microsoft 知识库文章 824994](http://support.microsoft.com/kb/824994)。

**删除信息**

要删除此更新，请使用“控制面板”中的“添加/删除程序”工具。

系统管理员也可以使用 Spuninst.exe 实用工具删除此安全更新。 Spuninst.exe 实用工具位于 %Windir%\\$NTUninstall**KB925902**$\\Spuninst 文件夹中。

<p> </p> 
<table class="dataTable">
<caption>
受支持的 Spuninst.exe 开关
</caption>
<tr class="thead">
<th>
开关
</th>
<th>
描述
</th>
</tr>
<tr>
<td style="border:1px solid black;">
**/help**
</td>
<td style="border:1px solid black;">
显示命令行选项。
</td>
</tr>
<tr>
<th colspan="2" style="border:1px solid black;">
安装模式
</th>
</tr>
<tr class="alternateRow">
<td style="border:1px solid black;">
**/passive**
</td>
<td style="border:1px solid black;">
无人参与安装模式。 无需用户交互操作，但会显示安装状态。 如果安装结束时需要重新启动，将显示一个带有计时器的对话框，警告计算机将在 30 秒后重新启动。
</td>
</tr>
<tr>
<td style="border:1px solid black;">
**/quiet**
</td>
<td style="border:1px solid black;">
安静模式。 这与无人参与模式相同，但是不显示任何状态或错误消息。
</td>
</tr>
<tr>
<th colspan="2" style="border:1px solid black;">
重新启动选项
</th>
</tr>
<tr class="alternateRow">
<td style="border:1px solid black;">
**/norestart**
</td>
<td style="border:1px solid black;">
安装完成后不重新启动。
</td>
</tr>
<tr>
<td style="border:1px solid black;">
**/forcerestart**
</td>
<td style="border:1px solid black;">
安装后重新启动计算机，且在关机时强制其他应用程序关闭而不先保存打开的文件。
</td>
</tr>
<tr class="alternateRow">
<td style="border:1px solid black;">
**/warnrestart\[:x\]**
</td>
<td style="border:1px solid black;">
显示一个带有计时器的对话框，警告计算机将在 *x* 秒后重新启动。 （默认设置为 30 秒。） 与 **/quiet** 开关或 **/passive** 开关一起使用。
</td>
</tr>
<tr>
<td style="border:1px solid black;">
**/promptrestart**
</td>
<td style="border:1px solid black;">
显示提示本地用户允许重新启动的对话框。
</td>
</tr>
<tr>
<th colspan="2" style="border:1px solid black;">
特殊选项
</th>
</tr>
<tr class="alternateRow">
<td style="border:1px solid black;">
**/forceappsclose**
</td>
<td style="border:1px solid black;">
在计算机关机时强制关闭其他程序。
</td>
</tr>
<tr>
<td style="border:1px solid black;">
**/log:path**
</td>
<td style="border:1px solid black;">
允许重定向安装日志文件。
</td>
</tr>
</table>
<p> </p>

**文件信息**

此安全更新的英文版具有下表所列的文件属性。 这些文件的日期和时间按照协调通用时间 (UTC) 列出。 当您查看文件信息时，它将转换为本地时间。 要了解 UTC 与本地时间之间的时差，请使用“控制面板”上的“日期/时间”工具中的“**时区**”选项卡。

Windows Server 2003 Web Edition、Windows Server 2003 Standard Edition、Windows Server 2003 Datacenter Edition、Windows Server 2003 Enterprise Edition、Windows Small Business Server 2003、Windows Server 2003 Web Edition (SP1)、Windows Server 2003 Standard Edition (SP1)、Windows Server 2003 Enterprise Edition (SP1)、Windows Server 2003 Datacenter Edition (SP1)、Windows Small Business Server 2003 SP1、Windows Server 2003 R2 Web Edition、Windows Server 2003 R2 Standard Edition、Windows Server 2003 R2 Datacenter Edition、Windows Server 2003 R2、Enterprise Edition 和 Windows Small Business Server 2003 R2： Windows Server 2003 Web Edition (SP2)、Windows Server 2003 Standard Edition (SP2)、Windows Server 2003 Enterprise Edition (SP2)、Windows Server 2003 Datacenter Edition (SP2)、Windows Server 2003 R2 Web Edition SP2、Windows Server 2003 R2 Standard Edition SP2、Windows Server 2003 R2 Datacenter Edition SP2、Windows Server 2003 R2 Enterprise Edition SP2 和 Windows Small Business Server 2003 R2 SP2：

| 文件名     | 版本          | 日期              | 时间  | 大小      | 文件夹 |
|------------|---------------|-------------------|-------|-----------|--------|
| gdi32.dll  | 5.2.3790.651  | 2007 年 3 月 2 日 | 05:49 | 273,408   | RTMGDR |
| mf3216.dll | 5.2.3790.651  | 2007 年 3 月 2 日 | 05:49 | 39,936    | RTMGDR |
| user32.dll | 5.2.3790.651  | 2007 年 3 月 2 日 | 05:49 | 577,024   | RTMGDR |
| win32k.sys | 5.2.3790.651  | 2007 年 3 月 1 日 | 11:09 | 1,827,328 | RTMGDR |
| gdi32.dll  | 5.2.3790.651  | 2007 年 3 月 2 日 | 05:54 | 273,920   | RTMQFE |
| mf3216.dll | 5.2.3790.651  | 2007 年 3 月 2 日 | 05:54 | 39,936    | RTMQFE |
| user32.dll | 5.2.3790.651  | 2007 年 3 月 2 日 | 05:54 | 578,048   | RTMQFE |
| win32k.sys | 5.2.3790.651  | 2007 年 3 月 1 日 | 11:19 | 1,829,376 | RTMQFE |
| gdi32.dll  | 5.2.3790.2892 | 2007 年 3 月 2 日 | 06:10 | 283,648   | SP1GDR |
| mf3216.dll | 5.2.3790.2892 | 2007 年 3 月 2 日 | 06:10 | 41,472    | SP1GDR |
| user32.dll | 5.2.3790.2892 | 2007 年 3 月 2 日 | 06:10 | 588,800   | SP1GDR |
| win32k.sys | 5.2.3790.2892 | 2007 年 3 月 1 日 | 12:44 | 1,851,904 | SP1GDR |
| gdi32.dll  | 5.2.3790.2892 | 2007 年 3 月 2 日 | 08:11 | 284,160   | SP1QFE |
| mf3216.dll | 5.2.3790.2892 | 2007 年 3 月 2 日 | 08:11 | 41,472    | SP1QFE |
| user32.dll | 5.2.3790.2892 | 2007 年 3 月 2 日 | 08:11 | 588,800   | SP1QFE |
| win32k.sys | 5.2.3790.2892 | 2007 年 3 月 1 日 | 12:24 | 1,854,976 | SP1QFE |
| gdi32.dll  | 5.2.3790.4033 | 2007 年 3 月 2 日 | 06:38 | 282,624   | SP2GDR |
| mf3216.dll | 5.2.3790.4033 | 2007 年 3 月 2 日 | 06:38 | 40,960    | SP2GDR |
| user32.dll | 5.2.3790.4033 | 2007 年 3 月 2 日 | 06:38 | 583,680   | SP2GDR |
| win32k.sys | 5.2.3790.4033 | 2007 年 3 月 1 日 | 15:04 | 1,845,760 | SP2GDR |
| gdi32.dll  | 5.2.3790.4033 | 2007 年 3 月 2 日 | 06:41 | 282,624   | SP2QFE |
| mf3216.dll | 5.2.3790.4033 | 2007 年 3 月 2 日 | 06:41 | 40,960    | SP2QFE |
| user32.dll | 5.2.3790.4033 | 2007 年 3 月 2 日 | 06:41 | 583,680   | SP2QFE |
| win32k.sys | 5.2.3790.4033 | 2007 年 3 月 1 日 | 15:52 | 1,845,760 | SP2QFE |

Windows Server 2003 Enterprise Edition（用于基于 Itanium 的系统）、Windows Server 2003 Datacenter Edition（用于基于 Itanium 的系统）、Windows Server 2003 Enterprise Edition (SP1)（用于基于 Itanium 的系统）、Windows Server 2003 Datacenter Edition (SP1)（用于基于 Itanium 的系统）、Windows Server 2003 Enterprise Edition (SP2)（用于基于 Itanium 的系统）和 Windows Server 2003 Datacenter Edition (SP2)（用于基于 Itanium 的系统）：

| 文件名      | 版本          | 日期              | 时间  | 大小      | CPU   | 文件夹      |
|-------------|---------------|-------------------|-------|-----------|-------|-------------|
| Gdi32.dll   | 5.2.3790.651  | 2007 年 3 月 2 日 | 08:57 | 809,984   | IA-64 | RTMGDR      |
| Mf3216.dll  | 5.2.3790.651  | 2007 年 3 月 2 日 | 08:57 | 122,880   | IA-64 | RTMGDR      |
| User32.dll  | 5.2.3790.651  | 2007 年 3 月 2 日 | 08:57 | 1,375,232 | IA-64 | RTMGDR      |
| Win32k.sys  | 5.2.3790.651  | 2007 年 3 月 2 日 | 08:57 | 4,965,888 | IA-64 | RTMGDR      |
| Wgdi32.dll  | 5.2.3790.651  | 2007 年 3 月 2 日 | 08:57 | 251,904   | x86   | RTMGDR\\WOW |
| Wmf3216.dll | 5.2.3790.651  | 2007 年 3 月 2 日 | 08:57 | 39,936    | x86   | RTMGDR\\WOW |
| Wuser32.dll | 5.2.3790.651  | 2007 年 3 月 2 日 | 08:57 | 568,832   | x86   | RTMGDR\\WOW |
| Gdi32.dll   | 5.2.3790.651  | 2007 年 3 月 2 日 | 08:58 | 811,008   | IA-64 | RTMQFE      |
| Mf3216.dll  | 5.2.3790.651  | 2007 年 3 月 2 日 | 08:58 | 122,368   | IA-64 | RTMQFE      |
| User32.dll  | 5.2.3790.651  | 2007 年 3 月 2 日 | 08:58 | 1,376,768 | IA-64 | RTMQFE      |
| Win32k.sys  | 5.2.3790.651  | 2007 年 3 月 2 日 | 08:58 | 4,972,032 | IA-64 | RTMQFE      |
| Wgdi32.dll  | 5.2.3790.651  | 2007 年 3 月 2 日 | 08:58 | 252,416   | x86   | RTMQFE\\WOW |
| Wmf3216.dll | 5.2.3790.651  | 2007 年 3 月 2 日 | 08:58 | 39,936    | x86   | RTMQFE\\WOW |
| Wuser32.dll | 5.2.3790.651  | 2007 年 3 月 2 日 | 08:58 | 569,344   | x86   | RTMQFE\\WOW |
| Gdi32.dll   | 5.2.3790.2892 | 2007 年 3 月 2 日 | 08:58 | 908,288   | IA-64 | SP1GDR      |
| Mf3216.dll  | 5.2.3790.2892 | 2007 年 3 月 2 日 | 08:58 | 123,392   | IA-64 | SP1GDR      |
| User32.dll  | 5.2.3790.2892 | 2007 年 3 月 2 日 | 08:58 | 1,474,048 | IA-64 | SP1GDR      |
| Win32k.sys  | 5.2.3790.2892 | 2007 年 3 月 2 日 | 08:58 | 5,544,448 | IA-64 | SP1GDR      |
| Wgdi32.dll  | 5.2.3790.2892 | 2007 年 3 月 2 日 | 08:58 | 287,232   | x86   | SP1GDR\\WOW |
| Wmf3216.dll | 5.2.3790.2892 | 2007 年 3 月 2 日 | 08:58 | 41,472    | x86   | SP1GDR\\WOW |
| Wuser32.dll | 5.2.3790.2892 | 2007 年 3 月 2 日 | 08:58 | 602,112   | x86   | SP1GDR\\WOW |
| Gdi32.dll   | 5.2.3790.2892 | 2007 年 3 月 2 日 | 08:58 | 909,312   | IA-64 | SP1QFE      |
| Mf3216.dll  | 5.2.3790.2892 | 2007 年 3 月 2 日 | 08:58 | 123,392   | IA-64 | SP1QFE      |
| User32.dll  | 5.2.3790.2892 | 2007 年 3 月 2 日 | 08:58 | 1,474,048 | IA-64 | SP1QFE      |
| Win32k.sys  | 5.2.3790.2892 | 2007 年 3 月 2 日 | 08:58 | 5,552,128 | IA-64 | SP1QFE      |
| Wgdi32.dll  | 5.2.3790.2892 | 2007 年 3 月 2 日 | 08:58 | 287,744   | x86   | SP1QFE\\WOW |
| Wmf3216.dll | 5.2.3790.2892 | 2007 年 3 月 2 日 | 08:58 | 41,472    | x86   | SP1QFE\\WOW |
| Wuser32.dll | 5.2.3790.2892 | 2007 年 3 月 2 日 | 08:58 | 602,112   | x86   | SP1QFE\\WOW |
| Gdi32.dll   | 5.2.3790.4033 | 2007 年 3 月 2 日 | 09:58 | 913,408   | IA-64 | SP2GDR      |
| Mf3216.dll  | 5.2.3790.4033 | 2007 年 3 月 2 日 | 09:58 | 123,392   | IA-64 | SP2GDR      |
| User32.dll  | 5.2.3790.4033 | 2007 年 3 月 2 日 | 09:58 | 1,474,560 | IA-64 | SP2GDR      |
| Win32k.sys  | 5.2.3790.4033 | 2007 年 3 月 2 日 | 09:58 | 5,556,736 | IA-64 | SP2GDR      |
| Wgdi32.dll  | 5.2.3790.4033 | 2007 年 3 月 2 日 | 09:58 | 290,816   | x86   | SP2GDR\\WOW |
| Wmf3216.dll | 5.2.3790.4033 | 2007 年 3 月 2 日 | 09:58 | 40,960    | x86   | SP2GDR\\WOW |
| Wuser32.dll | 5.2.3790.4033 | 2007 年 3 月 2 日 | 09:58 | 602,624   | x86   | SP2GDR\\WOW |
| Gdi32.dll   | 5.2.3790.4033 | 2007 年 3 月 2 日 | 09:19 | 913,408   | IA-64 | SP2QFE      |
| Mf3216.dll  | 5.2.3790.4033 | 2007 年 3 月 2 日 | 09:19 | 123,392   | IA-64 | SP2QFE      |
| User32.dll  | 5.2.3790.4033 | 2007 年 3 月 2 日 | 09:19 | 1,474,560 | IA-64 | SP2QFE      |
| Win32k.sys  | 5.2.3790.4033 | 2007 年 3 月 2 日 | 09:19 | 5,556,736 | IA-64 | SP2QFE      |
| Wgdi32.dll  | 5.2.3790.4033 | 2007 年 3 月 2 日 | 09:19 | 290,816   | x86   | SP2QFE\\WOW |
| Wmf3216.dll | 5.2.3790.4033 | 2007 年 3 月 2 日 | 09:19 | 40,960    | x86   | SP2QFE\\WOW |
| Wuser32.dll | 5.2.3790.4033 | 2007 年 3 月 2 日 | 09:19 | 602,624   | x86   | SP2QFE\\WOW |

Windows Server 2003 Standard x64 Edition、Windows Server 2003 Enterprise x64 Edition、Windows Server 2003 Datacenter x64 Edition、Windows Server 2003 R2 Standard x64 Edition、Windows Server 2003 R2 Enterprise x64 Edition、Windows Server 2003 R2 Datacenter x64 Edition、Windows Server 2003 Standard x64 Edition SP2、Windows Server 2003 Enterprise x64 Edition SP2、Windows Server 2003 Datacenter x64 Edition SP2、Windows Server 2003 R2 Standard x64 Edition SP2、Windows Server 2003 R2, Enterprise x64 Edition SP2 和 Windows Server 2003 R2 Datacenter x64 Edition SP2：

| 文件名      | 版本          | 日期              | 时间  | 大小      | CPU | 文件夹      |
|-------------|---------------|-------------------|-------|-----------|-----|-------------|
| Gdi32.dll   | 5.2.3790.2892 | 2007 年 3 月 2 日 | 08:56 | 616,960   | x64 | SP1GDR      |
| Mf3216.dll  | 5.2.3790.2892 | 2007 年 3 月 2 日 | 08:56 | 95,744    | x64 | SP1GDR      |
| User32.dll  | 5.2.3790.2892 | 2007 年 3 月 2 日 | 08:56 | 1,085,952 | x64 | SP1GDR      |
| Win32k.sys  | 5.2.3790.2892 | 2007 年 3 月 2 日 | 08:56 | 4,525,568 | x64 | SP1GDR      |
| Wgdi32.dll  | 5.2.3790.2892 | 2007 年 3 月 2 日 | 08:56 | 287,232   | x86 | SP1GDR\\WOW |
| Wmf3216.dll | 5.2.3790.2892 | 2007 年 3 月 2 日 | 08:56 | 41,472    | x86 | SP1GDR\\WOW |
| Wuser32.dll | 5.2.3790.2892 | 2007 年 3 月 2 日 | 08:56 | 602,112   | x86 | SP1GDR\\WOW |
| Gdi32.dll   | 5.2.3790.2892 | 2007 年 3 月 2 日 | 08:56 | 617,472   | x64 | SP1QFE      |
| Mf3216.dll  | 5.2.3790.2892 | 2007 年 3 月 2 日 | 08:56 | 95,744    | x64 | SP1QFE      |
| User32.dll  | 5.2.3790.2892 | 2007 年 3 月 2 日 | 08:56 | 1,085,952 | x64 | SP1QFE      |
| Win32k.sys  | 5.2.3790.2892 | 2007 年 3 月 2 日 | 08:56 | 4,536,320 | x64 | SP1QFE      |
| Wgdi32.dll  | 5.2.3790.2892 | 2007 年 3 月 2 日 | 08:56 | 287,744   | x86 | SP1QFE\\WOW |
| Wmf3216.dll | 5.2.3790.2892 | 2007 年 3 月 2 日 | 08:56 | 41,472    | x86 | SP1QFE\\WOW |
| Wuser32.dll | 5.2.3790.2892 | 2007 年 3 月 2 日 | 08:56 | 602,112   | x86 | SP1QFE\\WOW |
| Gdi32.dll   | 5.2.3790.4033 | 2007 年 3 月 2 日 | 09:54 | 619,520   | x64 | SP2GDR      |
| Mf3216.dll  | 5.2.3790.4033 | 2007 年 3 月 2 日 | 09:54 | 95,744    | x64 | SP2GDR      |
| User32.dll  | 5.2.3790.4033 | 2007 年 3 月 2 日 | 09:54 | 1,086,464 | x64 | SP2GDR      |
| Win32k.sys  | 5.2.3790.4033 | 2007 年 3 月 2 日 | 09:54 | 4,530,176 | x64 | SP2GDR      |
| Wgdi32.dll  | 5.2.3790.4033 | 2007 年 3 月 2 日 | 09:54 | 290,816   | x86 | SP2GDR\\WOW |
| Wmf3216.dll | 5.2.3790.4033 | 2007 年 3 月 2 日 | 09:54 | 40,960    | x86 | SP2GDR\\WOW |
| Wuser32.dll | 5.2.3790.4033 | 2007 年 3 月 2 日 | 09:54 | 602,624   | x86 | SP2GDR\\WOW |
| Gdi32.dll   | 5.2.3790.4033 | 2007 年 3 月 2 日 | 08:56 | 619,520   | x64 | SP2QFE      |
| Mf3216.dll  | 5.2.3790.4033 | 2007 年 3 月 2 日 | 08:56 | 95,744    | x64 | SP2QFE      |
| User32.dll  | 5.2.3790.4033 | 2007 年 3 月 2 日 | 08:56 | 1,086,464 | x64 | SP2QFE      |
| Win32k.sys  | 5.2.3790.4033 | 2007 年 3 月 2 日 | 08:56 | 4,530,176 | x64 | SP2QFE      |
| Wgdi32.dll  | 5.2.3790.4033 | 2007 年 3 月 2 日 | 08:56 | 290,816   | x86 | SP2QFE\\WOW |
| Wmf3216.dll | 5.2.3790.4033 | 2007 年 3 月 2 日 | 08:56 | 40,960    | x86 | SP2QFE\\WOW |
| Wuser32.dll | 5.2.3790.4033 | 2007 年 3 月 2 日 | 08:56 | 602,624   | x86 | SP2QFE\\WOW |


**注意** 当您安装这些安全更新时，安装程序将检查系统中正在更新的一个或多个文件是否已由 Microsoft 修补程序更新。

如果以前安装的修补程序已经更新过其中的某个文件，安装程序就会将 RTMQFE、SP1QFE 或 SP2QFE 文件复制到系统中。 否则，安装程序将 RTMGDR、SP1GDR 或 SP2GDR 文件复制到您的系统中。 安全更新可能不包含这些文件的所有版本。 有关此行为的详细信息，请参阅 [Microsoft 知识库文章 824994](http://support.microsoft.com/kb/824994)。

有关此行为的详细信息，请参阅 [Microsoft 知识库文章 824994](http://support.microsoft.com/kb/824994)。

有关 Update.exe 安装程序的详细信息，请访问 [Microsoft TechNet 网站](http://go.microsoft.com/fwlink/?linkid=38951)。

有关本公告中出现的术语（如“*修补程序*”）的详细信息，请参阅 [Microsoft 知识库文章 824684](http://support.microsoft.com/kb/824684)。

**验证是否已应用更新**

-   **Microsoft Baseline Security Analyzer**

    要验证受影响的系统上是否应用了安全更新，可以使用 Microsoft Baseline Security Analyzer (MBSA) 工具。 请参阅本安全公告前面的“与此安全更新相关的常见问题 (FAQ)”部分的常见问题“可否使用 Microsoft 基准安全分析器 (MBSA) 确定是否需要此更新？”。

-   **文件版本验证**

    
**注意** 由于 Microsoft Windows 有多个版本，因此以下步骤可能会因您的计算机而不同。 如果不同，请参阅产品文档来完成这些步骤。

1.  单击“**开始**”，然后单击“**搜索**”。  
2.  在“**搜索结果**”窗格中，单击“**搜索助理**”下的“**所有文件和文件夹**”。  
3.  在“**完整或部分文件名**”框中，键入相应文件信息表中的一个文件名，然后单击“**搜索**”。  
4.  在文件列表中，用鼠标右键单击相应文件信息表中的一个文件名，然后单击“**属性**”。  
        
**注意** 由于安装的操作系统或程序的版本不同，因此文件信息表中所列的某些文件可能并未安装。
5.  在“**版本**”选项卡上，通过将计算机上安装的文件与相应文件信息表中记录的版本进行比较来确定该文件的版本。
        
**注意** 在安装过程中，除文件版本以外的其他属性均可能会发生变化。 不支持通过将其他文件属性与文件信息表中的信息进行比较这种方法来验证是否应用了更新。 另外，在某些情况下，在安装过程中还可能会重命名文件。 如果没有文件或版本信息，请使用另外一种方法来验证更新安装。

-   **注册表项验证**

    也可以通过查看以下注册表项，检查此安全更新已安装的文件。

    Windows Server 2003 Web Edition、Windows Server 2003 Standard Edition、Windows Server 2003 Enterprise Edition、Windows Server 2003 Datacenter Edition、Windows Small Business Server 2003、Windows Server 2003 Web Edition (SP1)、Windows Server 2003 Standard Edition (SP1)、Windows Server 2003 Enterprise Edition (SP1)、Windows Server 2003 Datacenter Edition (SP1)、Windows Server 2003 Enterprise Edition（用于基于 Itanium 的系统）、Windows Server 2003 Datacenter Edition（用于基于 Itanium 的系统）、Windows Server 2003 Enterprise Edition (SP1)（用于基于 Itanium 的系统）、Windows Server 2003 Datacenter Edition (SP1)（用于基于 Itanium 的系统）、Windows Server 2003 Standard x64 Edition、Windows Server 2003 Enterprise x64 Edition、Windows Server 2003 Datacenter x64 Edition、Windows Server 2003 R2 Standard x64 Edition、Windows Server 2003 R2 Enterprise x64 Edition、Windows Server 2003 R2 Datacenter x64 Edition、Windows Server 2003 Web Edition (SP2)、Windows Server 2003 Standard Edition (SP2)、Windows Server 2003 Enterprise Edition (SP2)、Windows Server 2003 Datacenter Edition (SP2)、Windows Server 2003、Windows Server 2003 Enterprise Edition (SP2)（用于基于 Itanium 的系统）、Windows Server 2003 Datacenter Edition (SP2)（用于基于 Itanium 的系统）、Windows Server 2003 Standard x64 Edition SP2、Windows Server 2003 Enterprise x64 Edition SP2、Windows Server 2003 Datacenter x64 Edition SP2、Windows Server 2003 R2 Standard x64 Edition SP2、Windows Server 2003 R2 Enterprise x64 Edition SP2 和 Windows Server 2003 R2 Datacenter x64 Edition SP2：

    HKEY\_LOCAL\_MACHINE\\SOFTWARE\\Microsoft\\Updates\\Windows Server 2003\\SP3\\KB925902\\Filelist

    
**注意** 此注册表项可能不包含已安装文件的完整列表。 另外，如果管理员或 OEM 将安全更新集成或组合到 Windows 安装源文件中，则可能无法正确创建此注册表项。

#### Windows Vista（所有版本）

**先决条件**
此安全更新需要一个已发布的 Windows Vista 版本。

**包括在以后的 Service Pack 中**
此问题的更新程序将包含在以后的 Service Pack 或更新汇总中。

**安装信息**  
**此安全更新支持以下安装开关。**

受支持的安全更新安装开关

| 开关              | 描述                                                                                       |
|-------------------|--------------------------------------------------------------------------------------------|
| **/?、/h、/help** | 在支持的开关上显示帮助。                                                                   |
| **/quiet**        | 抑制显示状态或者错误消息。                                                                 |
| **/norestart**    | 当与 /quiet 结合使用时，系统在安装之后不会重新启动，即使要求重新启动才能完成安装也是如此。 |


**注意** 有关 wusa.exe 安装程序的详细信息，请参阅 Microsoft 知识库文章 934307。

**部署信息**

对于 Windows Vista，要在没有任何用户干预的情况下安装此安全更新，请在命令提示符处使用以下命令：

**Windows6.0-KB925902-x86.msu /quiet**


**注意** 使用 **/quiet** 开关将抑制所有消息（包括失败消息）。 管理员应该使用其中一种支持的方法，验证安装是否成功。 管理员还应该检查系统事件日志，查看使用此开关时的任何失败消息。

对于 Windows Vista，要安装此安全更新而不强制重新启动系统，请在命令提示符处使用以下命令。

**Windows6.0-KB925902-x86.msu /quiet /norestart**

有关如何使用 Windows Server Update Services 部署此安全更新的详细信息，请访问 [Windows Server Update Services 网站](http://go.microsoft.com/fwlink/?linkid=50120)。 此安全更新还将通过 [Microsoft Update 网站](http://update.microsoft.com/microsoftupdate)提供。

**重新启动要求**

应用此安全更新后，必须重新启动系统。

**删除信息**

要删除此更新，请依次单击“**控制面板**”、“**安全**”，然后在“**Windows Update**”之下单击“**查看安装的更新**”，并从更新列表中选择。


**文件信息**

此安全更新具有下表所列的文件属性。 这些文件的日期和时间按照协调通用时间 (UTC) 列出。 当您查看文件信息时，它将转换为本地时间。 要了解 UTC 与本地时间之间的时差，请使用“控制面板”上的“日期/时间”工具中的“**时区**”选项卡。

Windows Vista Ultimate、Windows Vista Enterprise、Windows Vista Business、Windows Vista Home Premium、Windows Vista Home Basic 和 Windows Vista Starter：

| 文件名     | 版本           | 日期               | 时间  | 大小      | 文件夹                                                                                                           |
|------------|----------------|--------------------|-------|-----------|------------------------------------------------------------------------------------------------------------------|
| user32.dll | 6.0.6000.16438 | 2007 年 2 月 15 日 | 04:05 | 633,856   | Windows6.0-KB925902-x86\\x86\_microsoft-windows-user32\_31bf3856ad364e35\_6.0.6000.16438\_none\_cb39bc5b7047127e |
| user32.dll | 6.0.6000.20537 | 2007 年 2 月 15 日 | 04:06 | 633,856   | Windows6.0-KB925902-x86\\x86\_microsoft-windows-user32\_31bf3856ad364e35\_6.0.6000.20537\_none\_cbc258dc896598f1 |
| win32k.sys | 6.0.6000.16438 | 2007 年 2 月 15 日 | 02:57 | 2,026,496 | Windows6.0-KB925902-x86\\x86\_microsoft-windows-win32k\_31bf3856ad364e35\_6.0.6000.16438\_none\_b6f4c9d49d715d0c |
| win32k.sys | 6.0.6000.20537 | 2007 年 2 月 15 日 | 02:57 | 2,026,496 | Windows6.0-KB925902-x86\\x86\_microsoft-windows-win32k\_31bf3856ad364e35\_6.0.6000.20537\_none\_b77d6655b68fe37f |

Windows Vista Ultimate、Windows Vista Enterprise、Windows Vista Business、Windows Vista Home Premium、Windows Vista Home Basic 和 Windows Vista Starter 的 64 位版本：

| 文件名     | 版本           | 日期               | 时间  | 大小      | 文件夹                                                                                                             |
|------------|----------------|--------------------|-------|-----------|--------------------------------------------------------------------------------------------------------------------|
| user32.dll | 6.0.6000.16438 | 2007 年 2 月 15 日 | 05:22 | 810,496   | Windows6.0-KB925902-x64\\amd64\_microsoft-windows-user32\_31bf3856ad364e35\_6.0.6000.16438\_none\_275857df28a483b4 |
| user32.dll | 6.0.6000.20537 | 2007 年 2 月 15 日 | 05:23 | 810,496   | Windows6.0-KB925902-x64\\amd64\_microsoft-windows-user32\_31bf3856ad364e35\_6.0.6000.20537\_none\_27e0f46041c30a27 |
| win32k.sys | 6.0.6000.16438 | 2007 年 2 月 15 日 | 03:28 | 2,748,928 | Windows6.0-KB925902-x64\\amd64\_microsoft-windows-win32k\_31bf3856ad364e35\_6.0.6000.16438\_none\_1313655855cece42 |
| win32k.sys | 6.0.6000.20537 | 2007 年 2 月 15 日 | 03:25 | 2,748,928 | Windows6.0-KB925902-x64\\amd64\_microsoft-windows-win32k\_31bf3856ad364e35\_6.0.6000.20537\_none\_139c01d96eed54b5 |
| user32.dll | 6.0.6000.16438 | 2007 年 2 月 15 日 | 04:05 | 646,656   | Windows6.0-KB925902-x64\\wow64\_microsoft-windows-user32\_31bf3856ad364e35\_6.0.6000.16438\_none\_31ad02315d0545af |
| user32.dll | 6.0.6000.20537 | 2007 年 2 月 15 日 | 04:07 | 646,656   | Windows6.0-KB925902-x64\\wow64\_microsoft-windows-user32\_31bf3856ad364e35\_6.0.6000.20537\_none\_32359eb27623cc22 |


**注意** 当您安装此安全更新时，Windows 将检查系统中正在更新的一个或多个文件是否已由 Windows 修补程序更新。 如果以前安装的修补程序已经更新过其中某个文件，安装程序将应用更新的 LDR 版本。 否则，安装程序将应用更新的 GDR 版本。

有关此行为的详细信息，请参阅 Microsoft 知识库文章 824994。

有关 wusa.exe 安装程序的详细信息，请参阅 [Microsoft 知识库文章 934307](http://support.microsoft.com/kb/934307)。

有关本公告中出现的术语（如“*修补程序*”）的详细信息，请参阅 [Microsoft 知识库文章 824684](http://support.microsoft.com/kb/824684)。

**验证是否已应用更新**

-   **Microsoft Baseline Security Analyzer**

    要验证受影响的系统上是否应用了安全更新，可以使用 Microsoft Baseline Security Analyzer (MBSA) 工具。 请参阅本安全公告前面的“与此安全更新相关的常见问题 (FAQ)”部分的常见问题“可否使用 Microsoft 基准安全分析器 (MBSA) 确定是否需要此更新？”。

-   **文件版本验证**

    
**注意** 由于 Microsoft Windows 有多个版本，因此以下步骤可能会因您的计算机而不同。 如果不同，请参阅产品文档来完成这些步骤。

1.  单击“**开始**”，然后在“**开始搜索**”中输入更新文件名。  
2.  当文件显示在“**程序**”之下时，右键单击文件名，然后单击“**属性**”  。
3.  在“**常规**”选项卡之下，将文件大小与本部分之前提供的文件信息表进行比较。  
4.  您也可以单击“**详细信息**”选项卡，并将信息（如文件版本和修改日期）与本部分之前提供的文件信息表进行比较。  
5.  最后，您也可以单击“**以前的版本**”选项卡，并将文件的以前版本的文件信息与新的或经过更新的文件版本的文件信息进行比较。      

### 其他信息

**鸣谢**

Microsoft [感谢](http://go.microsoft.com/fwlink/?linkid=21127)下列人员或组织与我们一起致力于保护客户的利益：

-   [Determina Security Research](http://www.determina.com/) 的 Alexander Sotirov 报告了 Windows 动态光标远程执行代码漏洞 CVE-2007-0038。
-   McAfee 与我们一起努力处理了 Windows 动态光标远程执行代码漏洞 CVE-2007-0038。
-   [iDefense](http://labs.idefense.com/)报告了 WMF 拒绝服务漏洞 CVE-2007-1211。
-   [NGS Software](http://www.ngssoftware.com/) 的 Shaun Colley 报告了 EMF 特权提升漏洞 CVE-2007-1212。
-   [Adobe Systems](http://www.adobe.com/) 的 Thomas Phinney 报告了字体光栅器本地特权提升漏洞 CVE-2007-1213。
-   Sergey Svinolobov 报告了 GDI 不正确的参数本地特权提升漏洞 CVE-2007-1215。

**获取其他安全更新：**

可从以下位置获得针对其他安全问题的更新：

-   [Microsoft 下载中心](http://go.microsoft.com/fwlink/?linkid=21129)提供了安全更新。 通过搜索关键字“安全修补程序”，可以非常方便地找到这些更新。
-   有关客户平台的更新可从 [Microsoft Update 网站](http://go.microsoft.com/fwlink/?linkid=40747)获得。

**支持：**

-   美国和加拿大的客户可拨打电话 1-866-PCSAFETY，从 [Microsoft 产品支持服务](http://go.microsoft.com/fwlink/?linkid=21131)获得技术支持。 与安全更新有关的电话支持服务是免费的。
-   其他国家（或地区）的用户可从当地的 Microsoft 分公司获得支持。 与安全更新有关的支持服务不收取任何费用。 有关如何就支持问题与 Microsoft 取得联系方面的详细信息，请访问[国际支持网站](http://go.microsoft.com/fwlink/?linkid=21155)。

**安全性资源：**

-   [Microsoft TechNet 安全](http://go.microsoft.com/fwlink/?linkid=21132)网站提供了有关 Microsoft 产品安全的详细信息。
-   [TechNet 更新管理中心](http://go.microsoft.com/fwlink/?linkid=69903)
-   [Microsoft Software Update Services](http://go.microsoft.com/fwlink/?linkid=21133)
-   [Microsoft Windows Server Update Services](http://go.microsoft.com/fwlink/?linkid=50120)
-   [Microsoft Baseline Security Analyzer](http://go.microsoft.com/fwlink/?linkid=21134) (MBSA)
-   [Windows Update](http://go.microsoft.com/fwlink/?linkid=21130)
-   [Microsoft Update](http://update.microsoft.com/microsoftupdate)
-   Windows Update 目录： 有关 Windows Update 目录的详细信息，请参阅 [Microsoft 知识库文章 323166](http://support.microsoft.com/kb/323166)。
-   [Office Update](http://go.microsoft.com/fwlink/?linkid=21135)

**Software Update Services：**

通过使用 Microsoft Software Update Services (SUS)，管理员可以在基于 Windows 2000 和 Windows Server 2003 的服务器以及运行 Windows 2000 Professional 或 Windows XP Professional 的台式机系统上快速而可靠地部署最新的关键更新和安全更新。

有关如何使用 Software Update Services 部署安全更新的详细信息，请访问 [Software Update Services 网站](http://go.microsoft.com/fwlink/?linkid=21133)。

**Windows Server Update Service：**

通过使用 Windows Server Update Services (WSUS)，管理员可以快速而可靠地将 Windows 2000 操作系统和更高版本、Office XP 和更高版本、Exchange Server 2003 以及 SQL Server 2000 的最新关键更新和安全更新部署到 Windows 2000 和更高版本的操作系统。

有关如何使用Windows Server Update Services 部署安全更新的详细信息，请访问 [Windows Server Update Services 网站](http://go.microsoft.com/fwlink/?linkid=50120)。

**Systems Management Server：**

Microsoft Systems Management Server (SMS) 提供了一个用于管理更新且可高度配置的企业解决方案。 通过使用 SMS，管理员可以确定需要安全更新的基于 Windows 的系统，并在整个企业中以可控制的方式执行这些更新的部署，而只对最终用户造成最低程度的干扰。 有关管理员如何使用 SMS 2003 来部署安全更新的详细信息，请访问 [SMS 2003 安全修补程序管理网站](http://go.microsoft.com/fwlink/?linkid=22939)。 SMS 2.0 用户还可以使用 [Software Updates Service 功能包](http://go.microsoft.com/fwlink/?linkid=33340)帮助部署安全更新。 有关 SMS 的信息，请访问 [SMS 网站](http://go.microsoft.com/fwlink/?linkid=21158)。


**注意** SMS 使用 Microsoft Baseline Security Analyzer、Microsoft Office 检测工具和企业更新扫描工具为安全公告更新检测和部署提供广泛支持。 这些工具可能检测不到某些软件更新。 在这些情况下，管理员可以使用 SMS 的清单功能将更新部署到特定系统上。 有关此过程的详细信息，请访问以下[网站](http://go.microsoft.com/fwlink/?linkid=33341)。 某些安全更新在重新启动系统后可能需要管理权限。 管理员可以使用提升权限部署工具（在 [SMS 2003 管理功能包](http://go.microsoft.com/fwlink/?linkid=33387)和 [SMS 2.0 管理功能包](http://go.microsoft.com/fwlink/?linkid=21161)中提供）来安装这些更新。

**免责声明：**

Microsoft 知识库中的信息“按原样”提供，没有任何形式的担保。 Microsoft 不作任何明示或暗示保证，包括对适销性和针对特定目的的适用性的保证。 Microsoft Corporation 或其供应商不对任何损害（包括直接的、间接的、偶然的、必然的损害，商业利润损失，或特殊损害）承担任何责任，即使 Microsoft Corporation 或其供应商事先已被告知有可能发生此类损害。 有些州不允许排除或限制必然或偶然损害的赔偿责任，因此上述限制可能不适用。

**修订版本：**

-   V1.0（2007 年 4 月 3 日）： 已发布公告。
-   V1.1（2008 年 12 月 9 日）： 已更新公告，在**与此安全更新相关的常见问题 (FAQ)** 部分添加了关于 Windows Server 2003 程序包的次要修订的条目。 成功地应用了以前的更新的客户不必采取任何行动。

*Built at 2014-04-18T01:50:00Z-07:00*
