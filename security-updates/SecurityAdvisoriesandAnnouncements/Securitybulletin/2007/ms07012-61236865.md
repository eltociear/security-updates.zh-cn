---
TOCTitle: 'MS07-012'
Title: 'Microsoft 安全公告 MS07-012 - 重要'
ms:assetid: 'ms07-012'
ms:contentKeyID: 61236865
ms:mtpsurl: 'https://technet.microsoft.com/zh-CN/library/ms07-012(v=Security.10)'
---

Security Bulletin

Microsoft 安全公告 MS07-012 - 重要
==================================

Microsoft MFC 中的漏洞可能允许远程执行代码 (924667)
---------------------------------------------------

发布时间: 2007年2月13日 | 更新时间: 2007年6月12日

**版本:** 2.0

#### 摘要

**本文的目标读者：** 使用 Microsoft Windows 的客户

**漏洞的影响：** 远程执行代码

**最高严重等级：** 重要

**建议：** 客户应尽早应用该更新。

**安全更新替代：** 无

**注意事项：** [Microsoft 知识库文章 924667](http://support.microsoft.com/?kbid=924667) 介绍了客户在安装此安全更新时可能遇到的当前已知问题。 本文还介绍了这些问题的建议解决办法。 有关详细信息，请参阅 [Microsoft 知识库文章 924667](http://support.microsoft.com/?kbid=924667)

**经过测试的软件和安全更新下载位置：**

**受影响的软件：**

-   Microsoft Windows 2000 Service Pack 4 — [下载此更新](http://www.microsoft.com/downloads/details.aspx?displaylang=zh-cn&familyid=d6577f1f-0d9e-4856-b1d6-7e27657a3620)
-   Microsoft Windows XP Service Pack 2 - [下载此更新](http://www.microsoft.com/downloads/details.aspx?displaylang=zh-cn&familyid=84ae4c62-89ae-410a-b34b-471e3c09ce98)
-   Microsoft Windows XP Professional x64 Edition 和 Microsoft Windows XP Professional x64 Edition Service Pack 2 — [下载此更新](http://www.microsoft.com/downloads/details.aspx?familyid=54e0dc33-6bad-476c-b4cf-b833d591aaad)
-   Microsoft Windows Server 2003、Microsoft Windows Server 2003 Service Pack 1 和 Microsoft Windows Server 2003 Service Pack 2 — [下载此更新](http://www.microsoft.com/downloads/details.aspx?displaylang=zh-cn&familyid=934ca609-d6bc-4bf0-8233-969eb43d48bb)
-   Microsoft Windows Server 2003（用于基于 Itanium 的系统）、Microsoft Windows Server 2003 SP1（用于基于 Itanium 的系统）以及 Microsoft Windows Server 2003 SP2（用于基于 Itanium 的系统）- [下载此更新](http://www.microsoft.com/downloads/details.aspx?familyid=67f52e93-cd57-4852-b838-a958ab9b23fb)
-   Microsoft Windows Server 2003 x64 Edition 和 Microsoft Windows Server 2003 x64 Edition Service Pack 2 - [下载此更新](http://www.microsoft.com/downloads/details.aspx?familyid=f2ca9de9-f69e-4e34-9aa9-0b320d670e04)
-   Microsoft Visual Studio .NET 2002 - [下载此更新 (KB924641)](http://www.microsoft.com/downloads/details.aspx?familyid=711f05a8-cd67-4702-b079-3ff79a3ab4de)
-   Microsoft Visual Studio .NET 2002 Service Pack 1 - [下载此更新](http://www.microsoft.com/downloads/details.aspx?familyid=124f2d2d-8cf3-47f3-a8fd-24a9facf4fa4) (KB924642)
-   Microsoft Visual Studio .NET 2003 - [下载此更新](http://www.microsoft.com/downloads/details.aspx?familyid=a05ce727-c5b5-4022-b7a0-d8861ce99209) (KB924643)
-   Microsoft Visual Studio .NET 2003 Service Pack 1 - [下载此更新](http://www.microsoft.com/downloads/details.aspx?familyid=1dd6d8e7-390b-4e02-9f16-ab9d5ef7792e) (KB927696)

**不受影响的软件：**

-   Windows Vista
-   Microsoft Visual Studio 2005
-   Microsoft SQL Server 2000
-   Windows Server 2003 Service Pack 1 Platform SDK
-   Windows Server 2003 R2 Platform SDK

已对此列表中的软件进行了测试，以确定是否这些版本会受到影响。 其他版本或者不再包括安全更新支持，或者可能不会受到影响。 要确定产品和版本的技术支持生命周期，请访问 [Microsoft 产品技术支持生命周期网站](http://go.microsoft.com/fwlink/?linkid=21742)。

### 一般信息

摘要
----

<span></span>
**摘要：**

此更新可消除一个秘密报告的新发现漏洞。 本公告的“漏洞详细资料”部分中对此漏洞进行了说明。

成功利用此漏洞的攻击者可以完全控制受影响的系统。 攻击者可随后安装程序；查看、更改或删除数据；或者创建拥有完全用户权限的新帐户。 那些帐户被配置为拥有较少系统用户权限的用户比具有管理用户权限的用户受到的影响要小。 要利用此漏洞，需要进行用大量的户交互。

我们建议客户应尽早应用此更新。

**严重等级和漏洞标识符：**

| 漏洞标识符                                                                                      | 漏洞的影响   | Microsoft Windows 2000 Service Pack 4 | Microsoft Windows XP Service Pack 2 | Microsoft Windows Server 2003、Microsoft Windows Server 2003 Service Pack 1 和 Microsoft Windows Server 2003 Service Pack 2 | Microsoft Visual Studio .NET 2002 | Microsoft Visual Studio .NET 2002 Service Pack 1 | Microsoft Visual Studio .NET 2003 | Microsoft Visual Studio .NET 2003 Service Pack 1 |
|-------------------------------------------------------------------------------------------------|--------------|---------------------------------------|-------------------------------------|-----------------------------------------------------------------------------------------------------------------------------|-----------------------------------|--------------------------------------------------|-----------------------------------|--------------------------------------------------|
| MFC 内存损坏漏洞 - [CVE-2007-0025](http://cve.mitre.org/cgi-bin/cvename.cgi?name=cve-2007-0025) | 远程执行代码 | 重要                                  | 重要                                | 重要                                                                                                                        | 重要                              | 重要                                             | 重要                              | 重要                                             |

此[评估](http://go.microsoft.com/fwlink/?linkid=21140)是基于以下几点作出的：受此漏洞影响的系统类型，它们的典型部署模式，以及利用此漏洞会对它们产生什么影响。

**注意** Windows Server 2003、Windows Server 2003 Service Pack 1、Windows Server 2003 Service Pack 2、Windows Server 2003 x64 Edition 和 Windows Server 2003 x64 Edition Service Pack 2 的安全更新同时也适用于 Windows Server 2003 R2。

**注意** 非 x86 操作系统版本与 x86 操作系统版本的严重等级按以下方式对应：

-   Windows XP Professional x64 Edition 和 Windows XP Professional x64 Edition Service Pack 2 的严重等级与 Windows XP Service Pack 2 的严重等级相同。
-   Windows Server 2003（用于基于 Itanium 的系统）的严重等级与 Windows Server 2003 的严重等级相同。
-   Windows Server 2003 SP1（用于基于 Itanium 的系统）的严重等级与 Windows Server 2003 Service Pack 1 的严重等级相同。
-   Windows Server 2003 SP2（用于基于 Itanium 的系统）的严重等级与 Windows Server 2003 Service Pack 1 的严重等级相同。
-   Windows Server 2003 x64 Edition 的严重等级与 Windows Server 2003 Service Pack 1 的严重等级相同。
-   Windows Server 2003 x64 Edition Service Pack 2 的严重等级与 Windows Server 2003 Service Pack 2 的严重等级相同。

与此安全更新相关的常见问题 (FAQ)
--------------------------------

<span></span>
**为什么 Microsoft 在 2007 年 6 月 12 日重新发布此公告？**
此公告已重新发布，作为受影响的产品添加了 Microsoft Windows Server 2003 Service Pack 2。 在应用 Windows Server 2003 Service Pack 2 之前安装此更新的客户不需要重新应用此更新。

**当客户安装此安全更新时可能遇到什么已知问题？**
[Microsoft 知识库文章 924667](http://support.microsoft.com/?kbid=924667) 介绍了客户在安装此安全更新时可能遇到的当前已知问题。 本文还介绍了这些问题的建议解决办法。 有关详细信息，请参阅 [Microsoft 知识库文章 924667](http://support.microsoft.com/?kbid=924667)。

-   [Microsoft 知识库文章 933273](http://support.microsoft.com/?kbid=933273)： 安装安全更新 MS07-012 时未更新 MFC 源文件 Oleui2.cpp。
-   [Microsoft 知识库文章 933339](http://support.microsoft.com/?kbid=933339)： 安装安全更新 MS07-012 时未更新 Mfc42u.dll。

**我正在使用 Microsoft Windows Server 2003 或 Microsoft Windows Server 2003 Service Pack 1。我已经安装了安全更新 MS07-012 的原始版本。是否需要重新安装此修订版本？**
否。 在应用 Windows Server 2003 Service Pack 2 之前安装此更新的客户不需要重新应用此更新。

**此安全更新解决的漏洞与 MS07-011 和 MS07-013 中解决的漏洞是否相同？**
否，每个单独的安全公告解决不同软件组件中唯一的安全漏洞；但是，这三个安全公告在攻击者如何利用漏洞方面存在着相似性。 请注意，MS07-011 (*OLE*) 包括可帮助阻止已知的攻击媒介利用 MS07-012 (*MFC*) 中解决的漏洞的纵深防御改进。 即使采用了 MS07-011 纵深防御改进，Microsoft 仍强烈建议部署所有这三个安全更新以解决所有已知的漏洞。

**我是否需要在部署 MS07-011 和 MS07-013 之前部署此安全更新？**
否，三个安全公告中的安全更新可以以任何顺序部署。 三个安全公告中的安全更新之间不存在应用程序兼容性依赖关系。

**我正在开发包含 Visual Studio 6.0 中可重新分发的文件的软件。由于这些软件包含 mfc40u.dll 和 mfc42u.dll，它们是否受此问题的影响？ 此外，如果受影响，由于 Visual Studio 6.0 的支持已经结束，我们应该如何解决？**
由于 Microsoft 仅为其受支持的软件版本提供安全更新，并且 Visual Studio 6.0 的支持已经结束，我们建议您升级您的软件以使用受支持的 Visual Studio 版本（例如 Visual Studio 2005）。

**我正在开发可动态链接到 Visual Studio .NET 2002 中的文件 mfc70u.lib 或 Visual Studio .NET 2003 中的文件 mfc71u.lib 的软件。我该怎么办？**
您应该根据需要安装本安全公告中包括的 Visual Studio .NET 2002 和 Visual Studio .NET 2003 安全更新，使用安全更新中找到的经过更新的动态库重新构建应用程序，然后向您的客户发布经过更新的应用程序版本。

如果您正在使用 Visual Studio .NET 2003，则应该参阅 [Microsoft 知识库文章 933273](http://support.microsoft.com/kb/933273/) 并从 [Microsoft 下载中心](http://www.microsoft.com/downloads/details.aspx?familyid=48e4c8fa-7a8c-41dc-af1c-e9e3be107171)下载 MFC 源文件。 这在您从来源重新构建 MFC 库，并静态或动态链接到您构建的库时尤其重要。 在重新构建应用程序***之前***，您应该下载更新来源并重新构建 MFC 库。

**我正在开发包含 Visual Studio .NET 2002 中的可重新分发文件 mfc70u.dll 或 Visual Studio .NET 2003 中的文件 mfc71u.dll 的软件。我该怎么办？**
您应该根据需要安装此 Visual Studio .NET 2002 或 Visual Studio .NET 2003 安全公告中包括的安全更新。 如果您随您的应用程序一起重新分发了 mfc70u.dll 或 mfc71u.dll，则应该向使用此 Visual Studio .NET 2002 或 Visual Studio .NET 2003 安全更新中包括的这些文件的更新版本的客户发布您的应用程序的更新版本。

**%windir%\\system32 之外的其他文件夹中存在 mfc40u.dll 和 mfc42u.dll 的副本。我该怎么办？**
您需要联系提供重新分发这些文件中一个或多个文件的应用程序的供应商，并要求供应商提供文件的较新版本附带的软件的更新版本。

**我正在使用 Microsoft SQL Server 2000，它包含 Visual Studio .NET 2003 中的可重新分发文件 mfc71u.dll。此文件中是否存在漏洞？**
否。 Microsoft SQL Server 2000 不受影响。 在应用特定的操作系统更新之后，文件 mfc71u.dll 不需要更新也可确保安全。

**我已经安装了 Platform SDK 的某个版本，它包含本安全公告中更新的文件 mfc42u.dll。 此文件中是否存在漏洞？**
否。 Platform SDK 不受影响。 一旦应用了特定操作系统更新，Platform SDK 的任何版本提供的文件 mfc42u.dll 不需要更新即可保持安全。

**我正在使用包含 Visual Studio .NET 2002 中的可重新分发文件 mfc70u.dll 或 Visual Studio .NET 2003 中的文件 mfc71u.dll 的第三方应用程序。这些文件中是否存在漏洞？ 如果存在漏洞，我们应该如何消除该漏洞？**
您需要联系提供重新分发这些文件中一个或多个文件的应用程序的供应商，并要求供应商提供文件的较新版本附带的软件的更新版本。

**我正在使用包含 Visual Studio 6.0 中可重新分发的文件的应用程序。由于这些应用程序包含 mfc40u.dll 和 mfc42u.dll，它们是否受此问题的影响？ 此外，如果受影响，由于 Visual Studio 6.0 的支持已经结束，我们应该如何解决？**
您需要联系提供重新分发这些文件中一个或多个文件的应用程序的供应商，并要求供应商提供不重新分发 mfc40u.dll 和 mfc41u.dll 的软件的更新版本。

**Microsoft Windows XP Home Edition Service Pack 1 或 Service Pack 1a、Windows XP Media Center Edition 2002 Service Pack 1、Windows XP Media Center Edition 2004 Service Pack 1、Windows XP Professional Service Pack 1 或 Service Pack 1a 以及 Windows XP Tablet PC Edition Service Pack 1 的延长安全更新支持已在 2006 年 10 月 10 日结束。我仍在使用其中一种操作系统，我该怎么办？**
Windows XP（所有版本）Service Pack 1 的支持生命周期已经结束。 使用这些操作系统版本的客户应优先考虑迁移到受支持的版本，以防止可能会受到新出现漏洞的影响。 有关 Windows 产品生命周期的详细信息，请访问以下 [Microsoft 产品技术支持生命周期网站](http://go.microsoft.com/fwlink/?linkid=21742)。 有关这些操作系统版本的延长安全更新支持周期的详细信息，请访问 [Microsoft 产品支持服务网站](http://go.microsoft.com/fwlink/?linkid=33328)。

**Microsoft Windows 98、Windows 98 Second Edition 或 Windows Millennium Edition 的延长安全更新支持已在 2006 年 7 月 11 日结束。我仍在使用其中一种操作系统，我该怎么办？ **
Windows 98、Windows 98 Second Edition 和 Windows Millennium Edition 已经到达其支持生命周期的末尾。 使用这些操作系统版本的客户应优先考虑迁移到受支持的版本，以防止可能会受到新出现漏洞的影响。 有关 Windows 产品生命周期的详细信息，请访问下面的 Microsoft 产品技术支持生命周期网站。 有关这些操作系统版本的延长安全更新支持周期的详细信息，请访问 Microsoft 产品支持服务网站。

**Microsoft Windows NT Workstation 4.0 Service Pack 6a 和 Windows 2000 Service Pack 2 的延长安全更新支持已在 2004 年 6 月 30 日结束。Microsoft Windows NT Server 4.0 Service Pack 6a 的延长安全更新支持已在 2004 年 12 月 31 日结束。Microsoft Windows 2000 Service Pack 3 的延长安全更新支持已在 2005 年 6 月 30 日结束。我仍在使用其中一种操作系统，我该怎么办？**
Windows NT Workstation 4.0 Service Pack 6a、Windows NT Server 4.0 Service Pack 6a、Windows 2000 Service Pack 2 和 Windows 2000 Service Pack 3 已经到达其支持生命周期的末尾。 使用这些操作系统版本的客户应优先考虑迁移到受支持的版本，以防止可能会受到新出现漏洞的影响。 有关 Windows 产品生命周期的详细信息，请访问以下 [Microsoft 产品技术支持生命周期网站](http://go.microsoft.com/fwlink/?linkid=21742)。 有关这些操作系统版本的延长安全更新支持周期的详细信息，请访问 [Microsoft 产品支持服务网站](http://go.microsoft.com/fwlink/?linkid=33328)。

如果用户需要获得这些产品的定制支持，则必须与其 Microsoft 客服小组代表、其技术客户经理或适当的 Microsoft 合作伙伴代表联系以了解定制支持选项。 没有联合合同、优先支持合同或授权合同的客户可与其当地的 Microsoft 销售分支机构联系。 有关联系信息，请访问 [Microsoft Worldwide Information 网站](http://go.microsoft.com/fwlink/?linkid=33329)，选择所在国家/地区，然后单击“**Go**”以查看电话号码列表。 在打电话时，请找当地“优先支持”销售经理进行洽谈。 有关详细信息，请参阅 [Windows 操作系统产品支持生命周期常见问题](http://go.microsoft.com/fwlink/?linkid=33330)。

有关详细信息，请访问 [Windows 操作系统常见问题](http://go.microsoft.com/fwlink/?linkid=33330)。

**可否使用 Microsoft 基准安全分析器 (MBSA) 确定是否需要此更新？**
下表提供此安全更新的 MBSA 检测摘要。

| 产品                                                                                                                                                                                    | MBSA 1.2.1 | EST | MBSA 2.0 |
|-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|------------|-----|----------|
| Microsoft Windows 2000 Service Pack 4                                                                                                                                                   | 是         | 否  | 是       |
| Microsoft Windows XP Service Pack 2                                                                                                                                                     | 是         | 否  | 是       |
| Microsoft Windows XP Professional x64 Edition 和 Microsoft Windows XP Professional x64 Edition Service Pack 2                                                                           | 否         | 否  | 是       |
| Microsoft Windows Server 2003、Microsoft Windows Server 2003 Service Pack 1 和 Microsoft Windows Server 2003 Service Pack 2                                                             | 是         | 否  | 是       |
| Microsoft Windows Server 2003（用于基于 Itanium 的系统）、Microsoft Windows Server 2003 SP1（用于基于 Itanium 的系统）以及 Microsoft Windows Server 2003 SP2（用于基于 Itanium 的系统） | 否         | 否  | 是       |
| Microsoft Windows Server 2003 x64 Edition 和 Microsoft Windows Server 2003 x64 Edition Service Pack 2                                                                                   | 否         | 否  | 是       |
| Microsoft Visual Studio .NET 2002                                                                                                                                                       | 否         | 是  | 否       |
| Microsoft Visual Studio .NET 2002 Service Pack 1                                                                                                                                        | 否         | 是  | 否       |
| Microsoft Visual Studio .NET 2003                                                                                                                                                       | 否         | 是  | 否       |
| Microsoft Visual Studio .NET 2003 Service Pack 1                                                                                                                                        | 否         | 是  | 否       |

有关 MBSA 的详细信息，请访问 [MBSA 网站](http://go.microsoft.com/fwlink/?linkid=21134)。 有关 Microsoft Update 和 MBSA 2.0 当前不检测的程序的详细信息，请参阅 [Microsoft 知识库文章 895660](http://support.microsoft.com/kb/895660)。

有关详细信息，请参阅 [Microsoft 知识库文章 910723](http://support.microsoft.com/kb/910723)。

**什么是企业更新扫描工具 (EST)？**
Microsoft 始终坚持为公告级别的安全更新提供检测工具，一旦 Microsoft 基准安全分析器 (MBSA) 和 Office 检测工具 (ODT) 不能检测 MSRC 发行周期是否需要更新，Microsoft 将提供独立的检测工具。 此独立工具称为“企业更新扫描工具 (EST)”，是为企业管理员设计的。 在为特定公告创建企业更新扫描工具的某个版本之后，客户可以通过命令行界面 (CLI) 来运行该工具并查看 XML 输出文件的结果。 为帮助客户更好地利用此工具，此工具附带详细说明文档。 另外，此工具还有一个版本，用来为 SMS 管理员提供的综合体验。

**是否可以使用企业** **更新扫描工具 (EST) 的某个版本来确定是否需要此更新？**
是。 Microsoft 已开发出 EST 的一个版本，帮助您确定是否必须应用此更新。 有关本月发行的 EST 版本的下载链接和详细信息，请参阅 [Microsoft 知识库文章 894193](http://support.microsoft.com/kb/894193)。有关 SMS 和 EST 的详细信息，SMS 客户应查看下列常见问题“可否使用 Systems Management Server (SMS) 确定是否需要此更新？”。

**可否使用 Systems Management Server (SMS) 确定是否需要此更新？**
下表提供此安全更新的 SMS 检测摘要。

| 产品                                                                                                                                                                                    | SMS 2.0      | SMS 2003 |
|-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|--------------|----------|
| Microsoft Windows 2000 Service Pack 4                                                                                                                                                   | 是           | 是       |
| Microsoft Windows XP Service Pack 2                                                                                                                                                     | 是           | 是       |
| Microsoft Windows XP Professional x64 Edition 和 Microsoft Windows XP Professional x64 Edition Service Pack 2                                                                           | 否           | 是       |
| Microsoft Windows Server 2003、Microsoft Windows Server 2003 Service Pack 1 和 Microsoft Windows Server 2003 Service Pack 2                                                             | 是           | 是       |
| Microsoft Windows Server 2003（用于基于 Itanium 的系统）、Microsoft Windows Server 2003 SP1（用于基于 Itanium 的系统）以及 Microsoft Windows Server 2003 SP2（用于基于 Itanium 的系统） | 否           | 是       |
| Microsoft Windows Server 2003 x64 Edition 和 Microsoft Windows Server 2003 x64 Edition Service Pack 2                                                                                   | 否           | 是       |
| Microsoft Visual Studio .NET 2002                                                                                                                                                       | 是（用 EST） | 是       |
| Microsoft Visual Studio .NET 2002 Service Pack 1                                                                                                                                        | 是（用 EST） | 是       |
| Microsoft Visual Studio .NET 2003                                                                                                                                                       | 是（用 EST） | 是       |
| Microsoft Visual Studio .NET 2003 Service Pack 1                                                                                                                                        | 是（用 EST） | 是       |

SMS 2.0 和 SMS 2003 软件更新服务 (SUS) 功能包可以使用 MBSA 1.2.1 进行检测，因此具有本公告前面所列的与 MBSA 1.2.1 不检测的程序有关的相同限制。

对于 SMS 2.0，SMS SUS 功能包（包含安全更新清单工具 (SUIT)）可由 SMS 用来检测安全更新。 SMS SUIT 使用 MBSA 1.2.1 引擎进行检测。 有关 SUIT 的详细信息，请访问以下 [Microsoft 网站](http://support.microsoft.com/kb/894154/)。 有关 SUIT 限制的详细信息，请参阅 [Microsoft 知识库文章 306460](http://support.microsoft.com/kb/306460/)。SMS SUS 功能包还包含用于检测 Microsoft Office 应用程序更新的 Microsoft Office 清单工具。

对于 SMS 2003，SMS 可以使用适用于 Microsoft 更新的 SMS 2003 清单工具 (ITMU) 检测 [Microsoft Update](http://update.microsoft.com/microsoftupdate) 提供的以及 [Windows Server 更新服务](http://go.microsoft.com/fwlink/?linkid=50120)支持的安全更新。 有关 SMS 2003 ITMU 的详细信息，请访问下列 [Microsoft 网站](http://go.microsoft.com/fwlink/?linkid=72181)。 SMS 2003 还可以使用 Microsoft Office 清单工具来检测 Microsoft Office 应用程序所需的更新。

有关 SMS 的详细信息，请访问 [SMS 网站](http://go.microsoft.com/fwlink/?linkid=21158)。

有关详细信息，请参阅 [Microsoft 知识库文章 910723](http://support.microsoft.com/kb/910723)。

漏洞详细资料
------------

<span></span>
#### MFC 内存损坏漏洞 - CVE-2007-0025：

Microsoft Windows 提供的 MFC 组件中存在一个远程执行代码漏洞。 当用户与 RTF 文件或 RTF 电子邮件中格式错误的嵌入式 OLE 对象进行交互时，攻击者可能企图利用此漏洞。

如果用户使用管理用户权限登录，成功利用此漏洞的攻击者便可完全控制受影响的系统。 攻击者可随后安装程序；查看、更改或删除数据；或者创建拥有完全用户权限的新帐户。 那些帐户被配置为拥有较少系统用户权限的用户比具有管理权限的用户受到的影响要小。

#### MFC 内存损坏漏洞 (CVE-2007-0025) 的缓解因素：

-   成功利用此漏洞的攻击者可以获得与本地用户相同的用户权限。 那些帐户被配置为拥有较少系统用户权限的用户比具有管理用户权限的用户受到的影响要小。
-   只有当用户打开 RTF 文件或 RTF 电子邮件并与其中嵌入的 OLE 对象交互时，攻击者才可能利用此漏洞。
-   此漏洞无法通过基于 Web 的攻击情形自动加以利用。 攻击者必须拥有一个网站，并在上面放置用来尝试利用此漏洞的 RTF 文件。 攻击者无法强迫用户访问恶意网站。 相反，攻击者必须劝诱用户访问该网站，通常是让用户单击指向攻击者网站的链接，然后诱使他们打开文件。
-   此漏洞无法通过电子邮件自动加以利用。 用户只有打开在电子邮件中发送的附件，并与在 RTF 文件中嵌入的 OLE 对象进行交互，或与 RTF 电子邮件中嵌入的 OLE 对象进行交互时，攻击才可能成功。

#### MFC 内存损坏漏洞 (CVE-2007-0025) 的避免方法：

Microsoft 已测试以下变通办法。 尽管这些变通办法不能从根本上消除此漏洞，但它们有助于阻止已知的攻击媒介。 如果某种变通办法导致功能下降，下一节中将进行说明。

-   **阻止 Wordpad.exe 中嵌入的对象**

    **注意：** 此变通方法仅适用于 Microsoft Windows XP Service Pack 2、Microsoft Windows Server 2003、Microsoft Windows Server 2003 Service Pack 1 和 Microsoft Windows Server 2003 Service Pack 2 系统。

    Wordpad.exe 是用于打开 RTF 文件的默认应用程序。 用户可以暂时阻止分析 RTF 文件的嵌入对象。

    **警告** 如果不正确地使用注册表编辑器，可能导致严重的问题，或许需要您重新安装操作系统。 Microsoft 不保证您可以解决因错误运用注册表编辑器而产生的问题。 使用注册表编辑器的风险由您自己承担。

    建议您在编辑注册表之前先对其进行备份。

    使用下列文本创建一个 .reg 文件，以便在使用 Wordpad.exe 时自动编辑注册表，从而暂时阻止分析 RTF 文件中嵌入的对象。您可以复制下列文本，将其粘贴到文本编辑器（如记事本），然后使用 .reg 文件扩展名保存文件。 在易受攻击的客户端上运行该 .reg 文件。

    **Windows Registry Editor Version 5.00**

    \[HKEY\_LOCAL\_MACHINE\\SOFTWARE\\Microsoft\\RtfStreamIn\\ObjectBlocking\\wordpad.exe\]

    **变通办法的影响：** Wordpad.exe 不再分析 RTF 文件中嵌入的对象。

-   不要打开或保存从不受信任来源或从受信任来源意外收到的 RTF 文件。 当用户打开特制文件时，攻击者可以利用此漏洞。
-   **从 Windows 2000 或 Windows 2003 卸载 WordPad**

    Wordpad.exe 是用于打开 RTF 文件的默认应用程序。 通过卸载写字板，用户可以阻止分析 RTF 文件的嵌入对象。

    1.  依次单击“开始”、“控制面板”和“添加或删除程序”。
    2.  单击“**添加/删除 Windows 组件**”，双击“**附件和实用工具**”，然后双击“**附件**”。
    3.  取消选中“**写字板**”，单击“**确定**”可使可选组件管理器卸载写字板。

    **变通办法的影响：** Wordpad 不再分析 RTF 文件中嵌入的对象。

#### MFC 内存损坏漏洞 (CVE-2007-0025) 的常见问题解答：

**此漏洞的影响范围有多大？**
Microsoft Windows 提供的 MFC 组件中存在一个远程执行代码漏洞。 当用户与 RTF 文件或 RTF 电子邮件中格式错误的嵌入式 OLE 对象进行交互时，攻击者可能会利用此漏洞。 如果用户使用管理用户权限登录，成功利用此漏洞的攻击者便可完全控制受影响的系统。 攻击者可随后安装程序；查看、更改或删除数据；或者创建拥有完全用户权限的新帐户。 那些帐户被配置为拥有较少系统用户权限的用户比具有管理权限的用户受到的影响要小。

**什么是 RTF 格式？**
RTF 格式规范为文本和图形交换提供一种格式，可与不同的输出设备、操作环境和操作系统一起使用。

**什么是 OLE？**
通过使用 OLE 技术，应用程序可以提供嵌入和链接支持。 OLE 是应用程序用于创建和编辑复合文档的技术。 这些可以是一种格式（例如 Microsoft Word 文档）的文档，包含另一种格式（例如 Microsoft Excel）文档的嵌入或链接。 OLE 2.0 比 OLE 前进了一大步，允许就地编辑。 在激活 OLE 对象时，用户会查看现有应用程序内的一组新菜单项，而非启动新应用程序。 有关 OLE 的详细信息，请访问以下 [MSDN 网站](http://msdn2.microsoft.com/en-us/library/ms693383.aspx)。

**造成漏洞的原因是什么？**
Windows MFC 组件在分析 RTF 文件中嵌入的 OLE 对象时没有执行足够的验证。 当用户与 RTF 文件中嵌入的格式错误的 OLE 对象进行交互时，它可能以一种攻击者可以执行任意代码的方式来破坏系统内存。

**攻击者可能利用此漏洞执行什么操作？**
成功利用此漏洞的攻击者可能导致任意代码使用打开文件的用户的特权运行。

**攻击者如何利用此漏洞？**
只有当用户打开 RTF 文件或 RTF 电子邮件并与其中嵌入的 OLE 对象交互时，攻击者才可能利用此漏洞。

此漏洞无法通过基于 Web 的攻击情形自动加以利用。 攻击者必须拥有一个网站，并在上面放置用来尝试利用此漏洞的 RTF 文件。 攻击者无法强迫用户访问恶意网站。 相反，攻击者必须劝诱用户访问该网站，通常是让用户单击指向攻击者网站的链接，然后诱使他们打开文件。

此漏洞无法通过电子邮件自动加以利用。 用户只有打开在电子邮件中发送的附件，并与在 RTF 文件中嵌入的 OLE 对象进行交互，或与 RTF 电子邮件中嵌入的 OLE 对象进行交互时，攻击才可能成功。

**受此漏洞威胁最大的系统有哪些？**
工作站和终端服务器受到的威胁最大。 如果管理员允许用户登录服务器并运行程序，服务器可能面临更大风险。 不过，最佳做法是不要授予这样的权限。

**此更新有什么作用？**
此更新通过修改 Windows MFC 组件分析 RTF 文件中的 OLE 流的方式来消除此漏洞。

**发布此安全公告时，此漏洞是否已公开披露？**
否。 Microsoft 通过可靠的披露渠道了解到有关此漏洞的信息。 在最初发布此安全公告时，Microsoft 未收到任何表明此漏洞已公开披露的信息。

**在发布此安全公告时，Microsoft 是否收到任何有关此漏洞已被利用的报告？**
否。 在最初发布此安全公告时，Microsoft 未收到任何表明此漏洞已被公开用于攻击客户的信息，也没有看到任何发布的概念代码证明示例。

安全更新信息
------------

<span></span>
**受影响的软件：**

有关您的受影响软件的特定安全更新信息，请单击相应的链接：

#### Windows 2000（所有版本）

**先决条件**
对于 Windows 2000，此安全更新需要 Service Pack 4 (SP4)。 对于 Small Business Server 2000，此安全更新需要 Small Business Server 2000 Service Pack 1a (SP1a) 或与 Windows 2000 Server Service Pack 4 (SP4) 一起运行的 Small Business Server 2000。

已对列出的软件进行了测试，以确定这些版本是否会受到影响。 其他版本或者不再包括安全更新支持，或者可能不会受到影响。 要确定产品和版本的技术支持生命周期，请访问 [Microsoft 产品技术支持生命周期网站](http://go.microsoft.com/fwlink/?linkid=21742)。

有关如何获得最新 Service Pack 的详细信息，请参阅 [Microsoft 知识库文章 260910](http://support.microsoft.com/kb/260910)。

**包括在以后的 Service Pack 中**
此问题的更新程序将包含在以后的更新汇总中。

**安装信息**

此安全更新支持以下安装开关。

<table class="dataTable">
<caption>
受支持的安全更新安装开关
</caption>
<tr class="thead">
<th>
开关
</th>
<th>
描述
</th>
</tr>
<tr>
<td style="border:1px solid black;">
**/help**
</td>
<td style="border:1px solid black;">
显示命令行选项。
</td>
</tr>
<tr>
<th colspan="2">
安装模式
</th>
</tr>
<tr class="alternateRow">
<td style="border:1px solid black;">
**/passive**
</td>
<td style="border:1px solid black;">
无人参与安装模式。 无需用户交互操作，但会显示安装状态。 如果安装结束时需要重新启动，将显示一个带有计时器的对话框，警告计算机将在 30 秒后重新启动。
</td>
</tr>
<tr>
<td style="border:1px solid black;">
**/quiet**
</td>
<td style="border:1px solid black;">
安静模式。 这与无人参与模式相同，但是不显示任何状态或错误消息。
</td>
</tr>
<tr>
<th colspan="2">
重新启动选项
</th>
</tr>
<tr class="alternateRow">
<td style="border:1px solid black;">
**/norestart**
</td>
<td style="border:1px solid black;">
安装完成后不重新启动。
</td>
</tr>
<tr>
<td style="border:1px solid black;">
**/forcerestart**
</td>
<td style="border:1px solid black;">
安装后重新启动计算机，且在关机时强制其他应用程序关闭而不先保存打开的文件。
</td>
</tr>
<tr class="alternateRow">
<td style="border:1px solid black;">
**/warnrestart\[:x\]**
</td>
<td style="border:1px solid black;">
显示一个带有计时器的对话框，警告计算机将在 *x* 秒后重新启动。 （默认设置为 30 秒。） 与 **/quiet** 开关或 **/passive** 开关一起使用。
</td>
</tr>
<tr>
<td style="border:1px solid black;">
**/promptrestart**
</td>
<td style="border:1px solid black;">
显示提示本地用户允许重新启动的对话框。
</td>
</tr>
<tr>
<th colspan="2">
特殊选项
</th>
</tr>
<tr class="alternateRow">
<td style="border:1px solid black;">
**/overwriteoem**
</td>
<td style="border:1px solid black;">
不经提示而覆盖 OEM 文件。
</td>
</tr>
<tr>
<td style="border:1px solid black;">
**/nobackup**
</td>
<td style="border:1px solid black;">
不备份卸载所需的文件。
</td>
</tr>
<tr class="alternateRow">
<td style="border:1px solid black;">
**/forceappsclose**
</td>
<td style="border:1px solid black;">
在计算机关机时强制关闭其他程序。
</td>
</tr>
<tr>
<td style="border:1px solid black;">
**/log:path**
</td>
<td style="border:1px solid black;">
允许重定向安装日志文件。
</td>
</tr>
<tr class="alternateRow">
<td style="border:1px solid black;">
**/integrate:path**
</td>
<td style="border:1px solid black;">
将更新集成到 Windows 源文件中。 这些文件位于开关中指定的路径中。
</td>
</tr>
<tr>
<td style="border:1px solid black;">
**/extract\[:path\]**
</td>
<td style="border:1px solid black;">
提取文件而不启动安装程序。
</td>
</tr>
<tr class="alternateRow">
<td style="border:1px solid black;">
**/ER**
</td>
<td style="border:1px solid black;">
启用扩展错误报告功能。
</td>
</tr>
<tr>
<td style="border:1px solid black;">
**/verbose**
</td>
<td style="border:1px solid black;">
启用详细日志记录。 在安装期间，创建 %Windir%\\CabBuild.log。此日志详述了被复制的文件。 使用此开关可能导致安装过程变慢。
</td>
</tr>
</table>
<p> </p>
**注意** 这些开关可以在一个命令中组合使用。 为了保持向后兼容，此安全更新还支持以前版本的安装程序所使用的安装开关。 有关受支持的安装开关的详细信息，请参阅 [Microsoft 知识库文章 262841](http://support.microsoft.com/kb/262841)。有关 Update.exe 安装程序的详细信息，请访问 [Microsoft TechNet 网站](http://go.microsoft.com/fwlink/?linkid=38951)。 有关本公告中出现的术语（如“*修补程序*”）的详细信息，请参阅 [Microsoft 知识库文章 824684](http://support.microsoft.com/kb/824684)。

**部署信息**

对于 Windows 2000 Service Pack 4，要在没有任何用户干预的情况下安装此安全更新，请在命令提示符处使用以下命令：

**Windows2000-KB924667-x86-enu /quiet**

**注意** 使用 **/quiet** 开关将抑制所有消息。 这包括抑制失败消息。 管理员应该使用其中一种支持的方法，验证使用 **/quiet** 开关时安装是否成功。 管理员还应该检查 KB924667.log 文件，查看使用此开关时的任何失败消息。

对于 Windows 2000 Service Pack 4，如果在安装此安全更新后不强制系统重新启动，请在命令提示符处使用以下命令：

**Windows2000-KB924667-x86-enu /norestart**

有关如何使用软件更新服务部署此安全更新的详细信息，请访问[软件更新服务网站](http://go.microsoft.com/fwlink/?linkid=21125)。 有关如何使用 Windows Server 更新服务部署此安全更新的详细信息，请访问 [Windows Server 更新服务网站](http://go.microsoft.com/fwlink/?linkid=50120)。 此安全更新还将通过 [Microsoft Update 网站](http://update.microsoft.com/microsoftupdate)提供。

**重新启动要求**

应用此安全更新后，必须重新启动系统。

**删除信息**

要删除此安全更新，请使用“控制面板”中的“添加或删除程序”工具。

系统管理员也可以使用 Spuninst.exe 实用工具删除此安全更新。 Spuninst.exe 实用工具位于 %Windir%\\$NTUninstallKB924667$\\Spuninst 文件夹中。

<table class="dataTable">
<caption>
受支持的 Spuninst.exe 开关
</caption>
<tr class="thead">
<th>
开关
</th>
<th>
描述
</th>
</tr>
<tr>
<td style="border:1px solid black;">
**/help**
</td>
<td style="border:1px solid black;">
显示命令行选项。
</td>
</tr>
<tr>
<th colspan="2">
安装模式
</th>
</tr>
<tr class="alternateRow">
<td style="border:1px solid black;">
**/passive**
</td>
<td style="border:1px solid black;">
无人参与安装模式。 无需用户交互操作，但会显示安装状态。 如果安装结束时需要重新启动，将显示一个带有计时器的对话框，警告计算机将在 30 秒后重新启动。
</td>
</tr>
<tr>
<td style="border:1px solid black;">
**/quiet**
</td>
<td style="border:1px solid black;">
安静模式。 这与无人参与模式相同，但是不显示任何状态或错误消息。
</td>
</tr>
<tr>
<th colspan="2">
重新启动选项
</th>
</tr>
<tr class="alternateRow">
<td style="border:1px solid black;">
**/norestart**
</td>
<td style="border:1px solid black;">
安装完成后不重新启动。
</td>
</tr>
<tr>
<td style="border:1px solid black;">
**/forcerestart**
</td>
<td style="border:1px solid black;">
安装后重新启动计算机，且在关机时强制其他应用程序关闭而不先保存打开的文件。
</td>
</tr>
<tr class="alternateRow">
<td style="border:1px solid black;">
**/warnrestart\[:x\]**
</td>
<td style="border:1px solid black;">
显示一个带有计时器的对话框，警告计算机将在 *x* 秒后重新启动。 （默认设置为 30 秒。） 与 **/quiet** 开关或 **/passive** 开关一起使用。
</td>
</tr>
<tr>
<td style="border:1px solid black;">
**/promptrestart**
</td>
<td style="border:1px solid black;">
显示提示本地用户允许重新启动的对话框。
</td>
</tr>
<tr>
<th colspan="2">
特殊选项
</th>
</tr>
<tr class="alternateRow">
<td style="border:1px solid black;">
**/forceappsclose**
</td>
<td style="border:1px solid black;">
在计算机关机时强制关闭其他程序。
</td>
</tr>
<tr>
<td style="border:1px solid black;">
**/log:path**
</td>
<td style="border:1px solid black;">
允许重定向安装日志文件。
</td>
</tr>
</table>
<p> </p>
**文件信息**

此安全更新的英文版具有下表所列的文件属性。 这些文件的日期和时间按照协调通用时间 (UTC) 列出。 当您查看文件信息时，它将转换为本地时间。 要了解 UTC 与本地时间之间的时差，请使用“控制面板”上的“日期/时间”工具中的“**时区**”选项卡。

Windows 2000 Service Pack 4：

| 文件名     | 版本       | 日期               | 时间  | 大小      |
|------------|------------|--------------------|-------|-----------|
| Mfc40u.dll | 4.1.0.6141 | 2006 年 11 月 3 日 | 07:01 | 927,504   |
| Mfc42u.dll | 6.0.9792.0 | 2006 年 11 月 3 日 | 07:01 | 1,011,774 |

**验证是否已应用更新**

-   **Microsoft 基准安全分析器**

    要验证受影响的系统上是否应用了安全更新，可以使用 Microsoft 基准安全分析器 (MBSA) 工具。 请参阅本安全公告前面的“与此安全更新相关的常见问题 (FAQ)”部分的常见问题“可否使用 Microsoft 基准安全分析器 (MBSA) 确定是否需要此更新？”。

-   **文件版本验证**

    **注意** 由于 Microsoft Windows 有多个版本，因此以下步骤在您的计算机上可能会有所不同。 如果不同，请参阅产品文档来完成这些步骤。

    1.  单击“**开始**”，然后单击“**搜索**”。
    2.  在“**搜索结果**”窗格中，单击“**搜索助理**”下的“**所有文件和文件夹**”。
    3.  在“**完整或部分文件名**”框中，键入相应文件信息表中的一个文件名，然后单击“**搜索**”。
    4.  在文件列表中，用鼠标右键单击相应文件信息表中的一个文件名，然后单击“**属性**”。
        **注意** 由于安装的操作系统或程序的版本不同，因此文件信息表中所列的某些文件可能并未安装。
    5.  在“**版本**”选项卡上，通过将计算机上安装的文件与相应文件信息表中记录的版本进行比较来确定该文件的版本。
        **注意** 在安装过程中，除文件版本以外的其他属性均可能会发生变化。 不支持通过将其他文件属性与文件信息表中的信息进行比较这种方法来验证是否应用了更新。 另外，在某些情况下，在安装过程中还可能会重命名文件。 如果没有文件或版本信息，请使用另外一种方法来验证更新安装。

-   **注册表项验证**

    也可以通过查看以下注册表项，检查此安全更新已安装的文件：

    HKEY\_LOCAL\_MACHINE\\SOFTWARE\\Microsoft\\Updates\\Windows 2000\\SP5\\KB924667\\Filelist

    **注意** 此注册表项可能不包含已安装文件的完整列表。 另外，如果管理员或 OEM 将 924667 安全更新集成或组合到 Windows 安装源文件中，则可能无法正确创建此注册表项。

#### Windows XP（所有版本）

**先决条件**
此安全更新需要 Microsoft Windows XP Service Pack 2。有关详细信息，请参阅 [Microsoft 知识库文章 322389](http://support.microsoft.com/kb/322389)。

**包括在以后的 Service Pack 中**
此问题的更新程序将包含在以后的 Service Pack 或更新汇总中。

**安装信息**

此安全更新支持以下安装开关。

<table class="dataTable">
<caption>
受支持的安全更新安装开关
</caption>
<tr class="thead">
<th>
开关
</th>
<th>
描述
</th>
</tr>
<tr>
<td style="border:1px solid black;">
**/help**
</td>
<td style="border:1px solid black;">
显示命令行选项。
</td>
</tr>
<tr>
<th colspan="2">
安装模式
</th>
</tr>
<tr class="alternateRow">
<td style="border:1px solid black;">
**/passive**
</td>
<td style="border:1px solid black;">
无人参与安装模式。 无需用户交互操作，但会显示安装状态。 如果安装结束时需要重新启动，将显示一个带有计时器的对话框，警告计算机将在 30 秒后重新启动。
</td>
</tr>
<tr>
<td style="border:1px solid black;">
**/quiet**
</td>
<td style="border:1px solid black;">
安静模式。 这与无人参与模式相同，但是不显示任何状态或错误消息。
</td>
</tr>
<tr>
<th colspan="2">
重新启动选项
</th>
</tr>
<tr class="alternateRow">
<td style="border:1px solid black;">
**/norestart**
</td>
<td style="border:1px solid black;">
安装完成后不重新启动。
</td>
</tr>
<tr>
<td style="border:1px solid black;">
**/forcerestart**
</td>
<td style="border:1px solid black;">
安装后重新启动计算机，且在关机时强制其他应用程序关闭而不先保存打开的文件。
</td>
</tr>
<tr class="alternateRow">
<td style="border:1px solid black;">
**/warnrestart\[:x\]**
</td>
<td style="border:1px solid black;">
显示一个带有计时器的对话框，警告计算机将在 *x* 秒后重新启动。 （默认设置为 30 秒。） 与 **/quiet** 开关或 **/passive** 开关一起使用。
</td>
</tr>
<tr>
<td style="border:1px solid black;">
**/promptrestart**
</td>
<td style="border:1px solid black;">
显示提示本地用户允许重新启动的对话框。
</td>
</tr>
<tr>
<th colspan="2">
特殊选项
</th>
</tr>
<tr class="alternateRow">
<td style="border:1px solid black;">
**/overwriteoem**
</td>
<td style="border:1px solid black;">
不经提示而覆盖 OEM 文件。
</td>
</tr>
<tr>
<td style="border:1px solid black;">
**/nobackup**
</td>
<td style="border:1px solid black;">
不备份卸载所需的文件。
</td>
</tr>
<tr class="alternateRow">
<td style="border:1px solid black;">
**/forceappsclose**
</td>
<td style="border:1px solid black;">
在计算机关机时强制关闭其他程序。
</td>
</tr>
<tr>
<td style="border:1px solid black;">
**/log:path**
</td>
<td style="border:1px solid black;">
允许重定向安装日志文件。
</td>
</tr>
<tr class="alternateRow">
<td style="border:1px solid black;">
**/integrate:path**
</td>
<td style="border:1px solid black;">
将更新集成到 Windows 源文件中。 这些文件位于开关中指定的路径中。
</td>
</tr>
<tr>
<td style="border:1px solid black;">
**/extract\[:path\]**
</td>
<td style="border:1px solid black;">
提取文件而不启动安装程序。
</td>
</tr>
<tr class="alternateRow">
<td style="border:1px solid black;">
**/ER**
</td>
<td style="border:1px solid black;">
启用扩展错误报告功能。
</td>
</tr>
<tr>
<td style="border:1px solid black;">
**/verbose**
</td>
<td style="border:1px solid black;">
启用详细日志记录。 在安装期间，创建 %Windir%\\CabBuild.log。此日志详述了被复制的文件。 使用此开关可能导致安装过程变慢。
</td>
</tr>
</table>
<p> </p>
**注意** 这些开关可以在一个命令中组合使用。 为了保持向后兼容，此安全更新还支持以前版本的安装程序所使用的安装开关。 有关受支持的安装开关的详细信息，请参阅 [Microsoft 知识库文章 262841](http://support.microsoft.com/kb/262841)。有关 Update.exe 安装程序的详细信息，请访问 [Microsoft TechNet 网站](http://go.microsoft.com/fwlink/?linkid=38951)。

**部署信息**

对于 Microsoft Windows XP，要在没有任何用户干预的情况下安装此安全更新，请在命令提示符处使用以下命令：

**WindowsXP-KB924667-x86-enu /quiet**

**注意** 使用 **/quiet** 开关将抑制所有消息。 这包括抑制失败消息。 管理员应该使用其中一种支持的方法，验证使用 **/quiet** 开关时安装是否成功。 管理员还应该检查 KB924667.log 文件，查看使用此开关时的任何失败消息。

对于 Windows XP，要安装此安全更新而不强制重新启动系统，请在命令提示符处使用以下命令：

**WindowsXP-KB924667-x86-enu /norestart**

有关如何使用软件更新服务部署此安全更新的信息，请访问[软件更新服务网站](http://go.microsoft.com/fwlink/?linkid=21125)。 有关如何使用 Windows Server 更新服务部署此安全更新的详细信息，请访问 [Windows Server 更新服务网站](http://go.microsoft.com/fwlink/?linkid=50120)。 此安全更新还将通过 [Microsoft Update 网站](http://update.microsoft.com/microsoftupdate)提供。

**重新启动要求**

应用此安全更新后，必须重新启动系统。

**删除信息**

要删除此安全更新，请使用“控制面板”中的“添加或删除程序”工具。

系统管理员也可以使用 Spuninst.exe 实用工具删除此安全更新。 Spuninst.exe 实用工具位于 %Windir%\\$NTUninstallKB924667$\\Spuninst 文件夹中。

<table class="dataTable">
<caption>
受支持的 Spuninst.exe 开关
</caption>
<tr class="thead">
<th>
开关
</th>
<th>
描述
</th>
</tr>
<tr>
<td style="border:1px solid black;">
**/help**
</td>
<td style="border:1px solid black;">
显示命令行选项。
</td>
</tr>
<tr>
<th colspan="2">
安装模式
</th>
</tr>
<tr class="alternateRow">
<td style="border:1px solid black;">
**/passive**
</td>
<td style="border:1px solid black;">
无人参与安装模式。 无需用户交互操作，但会显示安装状态。 如果安装结束时需要重新启动，将显示一个带有计时器的对话框，警告计算机将在 30 秒后重新启动。
</td>
</tr>
<tr>
<td style="border:1px solid black;">
**/quiet**
</td>
<td style="border:1px solid black;">
安静模式。 这与无人参与模式相同，但是不显示任何状态或错误消息。
</td>
</tr>
<tr>
<th colspan="2">
重新启动选项
</th>
</tr>
<tr class="alternateRow">
<td style="border:1px solid black;">
**/norestart**
</td>
<td style="border:1px solid black;">
安装完成后不重新启动。
</td>
</tr>
<tr>
<td style="border:1px solid black;">
**/forcerestart**
</td>
<td style="border:1px solid black;">
安装后重新启动计算机，且在关机时强制其他应用程序关闭而不先保存打开的文件。
</td>
</tr>
<tr class="alternateRow">
<td style="border:1px solid black;">
**/warnrestart\[:x\]**
</td>
<td style="border:1px solid black;">
显示一个带有计时器的对话框，警告计算机将在 *x* 秒后重新启动。 （默认设置为 30 秒。） 与 **/quiet** 开关或 **/passive** 开关一起使用。
</td>
</tr>
<tr>
<td style="border:1px solid black;">
**/promptrestart**
</td>
<td style="border:1px solid black;">
显示提示本地用户允许重新启动的对话框。
</td>
</tr>
<tr>
<th colspan="2">
特殊选项
</th>
</tr>
<tr class="alternateRow">
<td style="border:1px solid black;">
**/forceappsclose**
</td>
<td style="border:1px solid black;">
在计算机关机时强制关闭其他程序。
</td>
</tr>
<tr>
<td style="border:1px solid black;">
**/log:path**
</td>
<td style="border:1px solid black;">
允许重定向安装日志文件。
</td>
</tr>
</table>
<p> </p>
**文件信息**

此安全更新的英文版具有下表所列的文件属性。 这些文件的日期和时间按照协调通用时间 (UTC) 列出。 当您查看文件信息时，它将转换为本地时间。 要了解 UTC 与本地时间之间的时差，请使用“控制面板”上的“日期/时间”工具中的“**时区**”选项卡。

Windows XP Home Edition Service Pack 2、Windows XP Professional Service Pack 2、Windows XP Tablet PC Edition 2005 和 Windows XP Media Center Edition 2005：

| 文件名      | 版本       | 日期                | 时间  | 大小      | 文件夹                                |
|-------------|------------|---------------------|-------|-----------|---------------------------------------|
| Mfc40u.dll  | 4.1.0.6141 | 2006 年 11 月 1 日  | 19:17 | 927,504   | SP2QFE                                |
| Mfc42u.dll  | 6.2.8071.0 | 2006 年 12 月 14 日 | 13:45 | 981,760   | SP2QFE                                |
| Atl.dll     | 3.0.9238.0 | 2007 年 1 月 19 日  | 20:15 | 74,802    | SP2QFE\\ASMS\\60\\MSFT\\VCRTL         |
| Mfc42.dll   | 6.0.8665.0 | 2007 年 1 月 19 日  | 20:15 | 995,383   | SP2QFE\\ASMS\\60\\MSFT\\VCRTL         |
| Mfc42u.dll  | 6.0.9792.0 | 2007 年 1 月 19 日  | 20:15 | 1,011,774 | SP2QFE\\ASMS\\60\\MSFT\\VCRTL         |
| Msvcp60.dll | 6.0.8972.0 | 2007 年 1 月 19 日  | 20:15 | 401,462   | SP2QFE\\ASMS\\60\\MSFT\\VCRTL         |
| Vcrtl.man   | 不适用     | 2007 年 1 月 19 日  | 20:18 | 1,822     | SP2QFE\\ASMS\\60\\MSFT\\VCRTL         |
| Vcrtl.man   | 不适用     | 2007 年 1 月 19 日  | 20:18 | 644       | SP2QFE\\ASMS\\60\\POLICY\\MSFT\\VCRTL |

Windows XP Professional x64：

| 文件名      | 版本       | 日期               | 时间  | 大小      | CPU | 文件夹                                  |
|-------------|------------|--------------------|-------|-----------|-----|-----------------------------------------|
| Mfc42u.dll  | 6.5.9146.0 | 2007 年 1 月 25 日 | 12:11 | 1,460,992 | x64 | SP1QFE                                  |
| Atl.dll     | 3.0.9238.0 | 2007 年 1 月 25 日 | 12:11 | 74,802    | x86 | SP1QFE\\ASMS\\6000\\MSFT\\VCRTL         |
| Mfc42.dll   | 6.0.8665.0 | 2007 年 1 月 25 日 | 12:11 | 995,383   | x86 | SP1QFE\\ASMS\\6000\\MSFT\\VCRTL         |
| Mfc42u.dll  | 6.0.9792.0 | 2007 年 1 月 25 日 | 12:11 | 1,011,774 | x86 | SP1QFE\\ASMS\\6000\\MSFT\\VCRTL         |
| Msvcp60.dll | 6.0.8972.0 | 2007 年 1 月 25 日 | 12:11 | 401,462   | x86 | SP1QFE\\ASMS\\6000\\MSFT\\VCRTL         |
| Vcrtl.man   | 不适用     | 2007 年 1 月 25 日 | 12:11 | 1,822     |     | SP1QFE\\ASMS\\6000\\MSFT\\VCRTL         |
| Vcrtl.man   | 不适用     | 2007 年 1 月 25 日 | 12:11 | 699       |     | SP1QFE\\ASMS\\6000\\POLICY\\MSFT\\VCRTL |
| Wmfc40u.dll | 4.1.0.6141 | 2007 年 1 月 25 日 | 12:11 | 927,504   | x86 | SP1QFE\\WOW                             |
| Wmfc42u.dll | 6.6.8063.0 | 2007 年 1 月 25 日 | 12:11 | 1,163,776 | x86 | SP1QFE\\WOW                             |

**注意** 当您安装这些安全更新时，安装程序将检查系统中正在更新的一个或多个文件是否已由 Microsoft 修补程序更新。

如果以前安装的修补程序已经更新过其中的某个文件，安装程序就会将 RTMQFE、SP1QFE 或 SP2QFE 文件复制到系统中。 否则，安装程序将 RTMGDR、SP1GDR 或 SP2GDR 文件复制到您的系统中。 安全更新可能不包含这些文件的所有版本。 有关此行为的详细信息，请参阅 [Microsoft 知识库文章 824994](http://support.microsoft.com/kb/824994)。

有关 Update.exe 安装程序的详细信息，请访问 [Microsoft TechNet 网站](http://go.microsoft.com/fwlink/?linkid=38951)。

有关本公告中出现的术语（如“*修补程序*”）的详细信息，请参阅 [Microsoft 知识库文章 824684](http://support.microsoft.com/kb/824684)。

**验证是否已应用更新**

-   **Microsoft 基准安全分析器**

    要验证受影响的系统上是否应用了安全更新，可以使用 Microsoft 基准安全分析器 (MBSA) 工具。 请参阅本安全公告前面的“与此安全更新相关的常见问题 (FAQ)”部分的常见问题“可否使用 Microsoft 基准安全分析器 (MBSA) 确定是否需要此更新？”。

-   **文件版本验证**

    **注意** 由于 Microsoft Windows 有多个版本，因此以下步骤在您的计算机上可能会有所不同。 如果不同，请参阅产品文档来完成这些步骤。

    1.  单击“**开始**”，然后单击“**搜索**”。
    2.  在“**搜索结果**”窗格中，单击“**搜索助理**”下的“**所有文件和文件夹**”。
    3.  在“**完整或部分文件名**”框中，键入相应文件信息表中的一个文件名，然后单击“**搜索**”。
    4.  在文件列表中，用鼠标右键单击相应文件信息表中的一个文件名，然后单击“**属性**”。
        **注意** 由于安装的操作系统或程序的版本不同，因此文件信息表中所列的某些文件可能并未安装。
    5.  在“**版本**”选项卡上，通过将计算机上安装的文件与相应文件信息表中记录的版本进行比较来确定该文件的版本。
        **注意** 在安装过程中，除文件版本以外的其他属性均可能会发生变化。 不支持通过将其他文件属性与文件信息表中的信息进行比较这种方法来验证是否应用了更新。 另外，在某些情况下，在安装过程中还可能会重命名文件。 如果没有文件或版本信息，请使用另外一种方法来验证更新安装。

-   **注册表项验证**

    也可以通过查看以下注册表项，检查此安全更新已安装的文件。

    Windows XP Home Edition Service Pack 2、Windows XP Professional Service Pack 2、Windows XP Tablet PC Edition 2005 和 Windows XP Media Center Edition 2005：

    HKEY\_LOCAL\_MACHINE\\SOFTWARE\\Microsoft\\Updates\\Windows XP\\SP3\\KB924667\\Filelist

    对于 Windows XP Professional x64 Edition 和 Windows XP Professional x64 Edition Service Pack 2：

    HKEY\_LOCAL\_MACHINE\\SOFTWARE\\Microsoft\\Updates\\Windows XP Version 2003\\SP2\\KB924667\\Filelist

    **注意** 这些注册表项可能不包含已安装文件的完整列表。 另外，如果管理员或 OEM 将 924667 安全更新集成或组合到 Windows 安装源文件中，则可能无法正确创建这些注册表项。

#### Windows Server 2003（所有版本）

**先决条件**
此安全更新需要 Windows Server 2003、Windows Server 2003 Service Pack 1 或 Windows Server 2003 Service Pack 2。

**注意** Microsoft Windows Server 2003、Microsoft Windows Server 2003 Service Pack 1 和 Microsoft Windows Server 2003 Service Pack 2 的安全更新也适用于 Microsoft Windows Server 2003 R2。

**包括在以后的 Service Pack 中**
此问题的更新将包括在以后的 Service Pack 或更新汇总中。

**安装信息**

此安全更新支持以下安装开关。

<table class="dataTable">
<caption>
受支持的安全更新安装开关
</caption>
<tr class="thead">
<th>
开关
</th>
<th>
描述
</th>
</tr>
<tr>
<td style="border:1px solid black;">
**/help**
</td>
<td style="border:1px solid black;">
显示命令行选项。
</td>
</tr>
<tr>
<th colspan="2">
安装模式
</th>
</tr>
<tr class="alternateRow">
<td style="border:1px solid black;">
**/passive**
</td>
<td style="border:1px solid black;">
无人参与安装模式。 无需用户交互操作，但会显示安装状态。 如果安装结束时需要重新启动，将显示一个带有计时器的对话框，警告计算机将在 30 秒后重新启动。
</td>
</tr>
<tr>
<td style="border:1px solid black;">
**/quiet**
</td>
<td style="border:1px solid black;">
安静模式。 这与无人参与模式相同，但是不显示任何状态或错误消息。
</td>
</tr>
<tr>
<th colspan="2">
重新启动选项
</th>
</tr>
<tr class="alternateRow">
<td style="border:1px solid black;">
**/norestart**
</td>
<td style="border:1px solid black;">
安装完成后不重新启动。
</td>
</tr>
<tr>
<td style="border:1px solid black;">
**/forcerestart**
</td>
<td style="border:1px solid black;">
安装后重新启动计算机，且在关机时强制其他应用程序关闭而不先保存打开的文件。
</td>
</tr>
<tr class="alternateRow">
<td style="border:1px solid black;">
**/warnrestart\[:x\]**
</td>
<td style="border:1px solid black;">
显示一个带有计时器的对话框，警告计算机将在 *x* 秒后重新启动。 （默认设置为 30 秒。） 与 **/quiet** 开关或 **/passive** 开关一起使用。
</td>
</tr>
<tr>
<td style="border:1px solid black;">
**/promptrestart**
</td>
<td style="border:1px solid black;">
显示提示本地用户允许重新启动的对话框。
</td>
</tr>
<tr>
<th colspan="2">
特殊选项
</th>
</tr>
<tr class="alternateRow">
<td style="border:1px solid black;">
**/overwriteoem**
</td>
<td style="border:1px solid black;">
不经提示而覆盖 OEM 文件。
</td>
</tr>
<tr>
<td style="border:1px solid black;">
**/nobackup**
</td>
<td style="border:1px solid black;">
不备份卸载所需的文件。
</td>
</tr>
<tr class="alternateRow">
<td style="border:1px solid black;">
**/forceappsclose**
</td>
<td style="border:1px solid black;">
在计算机关机时强制关闭其他程序。
</td>
</tr>
<tr>
<td style="border:1px solid black;">
**/log: path**
</td>
<td style="border:1px solid black;">
允许重定向安装日志文件。
</td>
</tr>
<tr class="alternateRow">
<td style="border:1px solid black;">
**/integrate:path**
</td>
<td style="border:1px solid black;">
将更新集成到 Windows 源文件中。 这些文件位于开关中指定的路径中。
</td>
</tr>
<tr>
<td style="border:1px solid black;">
**/extract\[:path\]**
</td>
<td style="border:1px solid black;">
提取文件而不启动安装程序。
</td>
</tr>
<tr class="alternateRow">
<td style="border:1px solid black;">
**/ER**
</td>
<td style="border:1px solid black;">
启用扩展错误报告功能。
</td>
</tr>
<tr>
<td style="border:1px solid black;">
**/verbose**
</td>
<td style="border:1px solid black;">
启用详细日志记录。 在安装期间，创建 %Windir%\\CabBuild.log。此日志详述了被复制的文件。 使用此开关可能导致安装过程变慢。
</td>
</tr>
</table>
<p> </p>
**注意** 这些开关可以在一个命令中组合使用。 为了保持向后兼容，此安全更新还支持以前版本的安装程序所使用的许多安装开关。 有关受支持的安装开关的详细信息，请参阅 [Microsoft 知识库文章 262841](http://support.microsoft.com/kb/262841)。有关 Update.exe 安装程序的详细信息，请访问 [Microsoft TechNet 网站](http://go.microsoft.com/fwlink/?linkid=38951)。

**部署信息**

对于 Windows Server 2003，要在没有任何用户干预的情况下安装此安全更新，请在命令提示符处使用以下命令：

**WindowsServer2003-KB924667-v2-x86-enu /quiet**

**注意** 使用 **/quiet** 开关将抑制所有消息。 这包括抑制失败消息。 管理员应该使用其中一种支持的方法，验证使用 **/quiet** 开关时安装是否成功。 管理员还应该检查 KB924667.log 文件，查看使用此开关时的任何失败消息。

对于 Windows Server 2003，要安装此安全更新而不强制重新启动系统，请在命令提示符处使用以下命令：

**WindowsServer2003-KB924667-v2-x86-enu /norestart**

有关如何使用软件更新服务部署此安全更新的信息，请访问[软件更新服务网站](http://go.microsoft.com/fwlink/?linkid=21125)。 有关如何使用 Windows Server 更新服务部署此安全更新的详细信息，请访问 [Windows Server 更新服务网站](http://go.microsoft.com/fwlink/?linkid=50120)。 此安全更新还将通过 [Microsoft Update 网站](http://update.microsoft.com/microsoftupdate)提供。

**重新启动要求**

应用此安全更新后，必须重新启动系统。

此安全更新不支持 HotPatching。 有关 HotPatching 的详细信息，请参阅 [Microsoft 知识库文章 897341](http://support.microsoft.com/kb/897341)。

**注意** 并非所有安全更新均支持 HotPatching，某些支持 HotPatching 的安全更新可能要求您在安装安全更新之后重新启动服务器。 只有当安全更新替代的文件为通用分布版本 (GDR) 文件时，才支持 HotPatching。 如果您之前安装了修补程序来更新安全更新中包括的某个文件，则不支持 HotPatching。 有关此行为的详细信息，请参阅 [Microsoft 知识库文章 897341](http://support.microsoft.com/kb/897341) 和 [Microsoft 知识库文章 824994](http://support.microsoft.com/kb/824994)。

**删除信息**

要删除此更新，请使用“控制面板”中的“添加/删除程序”工具。

系统管理员也可以使用 Spuninst.exe 实用工具删除此安全更新。 Spuninst.exe 实用工具位于 %Windir%\\$NTUninstallKB924667$\\Spuninst 文件夹中。

<table class="dataTable">
<caption>
受支持的 Spuninst.exe 开关
</caption>
<tr class="thead">
<th>
开关
</th>
<th>
描述
</th>
</tr>
<tr>
<td style="border:1px solid black;">
**/help**
</td>
<td style="border:1px solid black;">
显示命令行选项。
</td>
</tr>
<tr>
<th colspan="2">
安装模式
</th>
</tr>
<tr class="alternateRow">
<td style="border:1px solid black;">
**/passive**
</td>
<td style="border:1px solid black;">
无人参与安装模式。 无需用户交互操作，但会显示安装状态。 如果安装结束时需要重新启动，将显示一个带有计时器的对话框，警告计算机将在 30 秒后重新启动。
</td>
</tr>
<tr>
<td style="border:1px solid black;">
**/quiet**
</td>
<td style="border:1px solid black;">
安静模式。 这与无人参与模式相同，但是不显示任何状态或错误消息。
</td>
</tr>
<tr>
<th colspan="2">
重新启动选项
</th>
</tr>
<tr class="alternateRow">
<td style="border:1px solid black;">
**/norestart**
</td>
<td style="border:1px solid black;">
安装完成后不重新启动。
</td>
</tr>
<tr>
<td style="border:1px solid black;">
**/forcerestart**
</td>
<td style="border:1px solid black;">
安装后重新启动计算机，且在关机时强制其他应用程序关闭而不先保存打开的文件。
</td>
</tr>
<tr class="alternateRow">
<td style="border:1px solid black;">
**/warnrestart\[:x\]**
</td>
<td style="border:1px solid black;">
显示一个带有计时器的对话框，警告计算机将在 *x* 秒后重新启动。 （默认设置为 30 秒。） 与 **/quiet** 开关或 **/passive** 开关一起使用。
</td>
</tr>
<tr>
<td style="border:1px solid black;">
**/promptrestart**
</td>
<td style="border:1px solid black;">
显示提示本地用户允许重新启动的对话框。
</td>
</tr>
<tr>
<th colspan="2">
特殊选项
</th>
</tr>
<tr class="alternateRow">
<td style="border:1px solid black;">
**/forceappsclose**
</td>
<td style="border:1px solid black;">
在计算机关机时强制关闭其他程序。
</td>
</tr>
<tr>
<td style="border:1px solid black;">
**/log:path**
</td>
<td style="border:1px solid black;">
允许重定向安装日志文件。
</td>
</tr>
</table>
<p> </p>
**文件信息**

此安全更新的英文版具有下表所列的文件属性。 这些文件的日期和时间按照协调通用时间 (UTC) 列出。 当您查看文件信息时，它将转换为本地时间。 要了解 UTC 与本地时间之间的时差，请使用“控制面板”上的“日期/时间”工具中的“**时区**”选项卡。

Windows Server 2003 Web Edition、Windows Server 2003 Standard Edition、Windows Server 2003 Datacenter Edition、Windows Server 2003 Enterprise Edition、Windows Small Business Server 2003、Windows Server 2003 Web Edition (SP1)、Windows Server 2003 Standard Edition (SP1)、Windows Server 2003 Enterprise Edition (SP1)、Windows Server 2003 Datacenter Edition (SP1)、Windows Server 2003 Web Edition (SP1)、Windows Server 2003 Standard Edition (SP1)、Windows Server 2003 Enterprise Edition (SP1)、Windows Server 2003 Datacenter Edition (SP1)、Windows Server 2003 R2 Web Edition、Windows Server 2003 R2 Standard Edition、Windows Server 2003 R2 Datacenter Edition、Windows Server 2003 R2 Enterprise Edition 和 Windows Small Business Server 2003 R2：

| 文件名      | 版本       | 日期                | 时间  | 大小      | 文件夹                          |
|-------------|------------|---------------------|-------|-----------|---------------------------------|
| mfc40u.dll  | 4.1.0.6141 | 2006 年 10 月 31 日 | 21:01 | 927,504   | RTMQFE                          |
| mfc42u.dll  | 6.6.8063.0 | 2007 年 5 月 1 日   | 13:44 | 1,163,776 | RTMQFE                          |
| atl.dll     | 3.0.9238.0 | 2007 年 1 月 25 日  | 13:09 | 74,802    | RTMQFE\\asms\\6000\\msft\\vcrtl |
| mfc42.dll   | 6.0.8665.0 | 2007 年 1 月 25 日  | 13:09 | 995,383   | RTMQFE\\asms\\6000\\msft\\vcrtl |
| mfc42u.dll  | 6.0.9792.0 | 2007 年 1 月 25 日  | 13:09 | 1,011,774 | RTMQFE\\asms\\6000\\msft\\vcrtl |
| msvcp60.dll | 6.0.8972.0 | 2007 年 1 月 25 日  | 13:09 | 401,462   | RTMQFE\\asms\\6000\\msft\\vcrtl |
| mfc40u.dll  | 4.1.0.6141 | 2006 年 10 月 31 日 | 21:17 | 927,504   | SP1QFE                          |
| mfc42u.dll  | 6.6.8063.0 | 2006 年 10 月 31 日 | 21:17 | 1,163,776 | SP1QFE                          |
| atl.dll     | 3.0.9238.0 | 2007 年 1 月 23 日  | 15:42 | 74,802    | SP1QFE\\asms\\6000\\msft\\vcrtl |
| mfc42.dll   | 6.0.8665.0 | 2007 年 1 月 23 日  | 15:42 | 995,383   | SP1QFE\\asms\\6000\\msft\\vcrtl |
| mfc42u.dll  | 6.0.9792.0 | 2007 年 1 月 23 日  | 15:42 | 1,011,774 | SP1QFE\\asms\\6000\\msft\\vcrtl |
| msvcp60.dll | 6.0.8972.0 | 2007 年 1 月 23 日  | 15:42 | 401,462   | SP1QFE\\asms\\6000\\msft\\vcrtl |
| mfc40u.dll  | 4.1.0.6141 | 2007 年 5 月 1 日   | 10:12 | 927,504   | SP2QFE                          |

Windows Server 2003 Enterprise Edition（用于基于 Itanium 的系统）、Windows Server 2003 Datacenter Edition（用于基于 Itanium 的系统）、Windows Server 2003 Enterprise Edition (SP1)（用于基于 Itanium 的系统）、Windows Server 2003 Datacenter Edition (SP1)（用于基于 Itanium 的系统）、Windows Server 2003 Enterprise Edition (SP2)（用于基于 Itanium 的系统）和 Windows Server 2003 Datacenter Edition (SP2)（用于基于 Itanium 的系统）：

| 文件名      | 版本       | 日期              | 时间  | 大小      | CPU   | 文件夹                          |
|-------------|------------|-------------------|-------|-----------|-------|---------------------------------|
| mfc42u.dll  | 6.5.5211.0 | 2007 年 5 月 1 日 | 15:01 | 3,510,272 | IA-64 | RTMQFE                          |
| atl.dll     | 3.0.9238.0 | 2007 年 5 月 1 日 | 15:01 | 74,802    | X86   | RTMQFE\\asms\\6000\\msft\\vcrtl |
| mfc42.dll   | 6.0.8665.0 | 2007 年 5 月 1 日 | 15:01 | 995,383   | X86   | RTMQFE\\asms\\6000\\msft\\vcrtl |
| mfc42u.dll  | 6.0.9792.0 | 2007 年 5 月 1 日 | 15:01 | 1,011,774 | X86   | RTMQFE\\asms\\6000\\msft\\vcrtl |
| msvcp60.dll | 6.0.8972.0 | 2007 年 5 月 1 日 | 15:01 | 401,462   | X86   | RTMQFE\\asms\\6000\\msft\\vcrtl |
| wmfc40u.dll | 4.1.0.6141 | 2007 年 5 月 1 日 | 15:01 | 927,504   | X86   | RTMQFE\\wow                     |
| wmfc42u.dll | 6.6.8063.0 | 2007 年 5 月 1 日 | 15:01 | 1,163,776 | X86   | RTMQFE\\wow                     |
| mfc42u.dll  | 6.5.9146.0 | 2007 年 5 月 1 日 | 15:01 | 3,508,992 | IA-64 | SP1QFE                          |
| atl.dll     | 3.0.9238.0 | 2007 年 5 月 1 日 | 15:01 | 74,802    | X86   | SP1QFE\\asms\\6000\\msft\\vcrtl |
| mfc42.dll   | 6.0.8665.0 | 2007 年 5 月 1 日 | 15:01 | 995,383   | X86   | SP1QFE\\asms\\6000\\msft\\vcrtl |
| mfc42u.dll  | 6.0.9792.0 | 2007 年 5 月 1 日 | 15:01 | 1,011,774 | X86   | SP1QFE\\asms\\6000\\msft\\vcrtl |
| msvcp60.dll | 6.0.8972.0 | 2007 年 5 月 1 日 | 15:01 | 401,462   | X86   | SP1QFE\\asms\\6000\\msft\\vcrtl |
| wmfc40u.dll | 4.1.0.6141 | 2007 年 5 月 1 日 | 15:01 | 927,504   | X86   | SP1QFE\\wow                     |
| wmfc42u.dll | 6.6.8063.0 | 2007 年 5 月 1 日 | 15:01 | 1,163,776 | X86   | SP1QFE\\wow                     |
| wmfc40u.dll | 4.1.0.6141 | 2007 年 5 月 1 日 | 15:05 | 927,504   | X86   | SP2QFE\\wow                     |
| wmfc42u.dll | 6.6.8063.0 | 2007 年 5 月 1 日 | 15:05 | 1,163,776 | X86   | SP2QFE\\wow                     |

Windows Server 2003 Standard x64 Edition、Windows Server 2003 Enterprise x64 Edition、Windows Server 2003 Datacenter x64 Edition、Windows Server 2003 Standard x64 Edition Service Pack 2、Windows Server 2003 Enterprise x64 Edition Service Pack 2、Windows Server 2003 Datacenter x64 Edition Service Pack 2、Windows Server 2003 R2 Standard x64 Edition、Windows Server 2003 R2 Enterprise x64 Edition 和 Windows Server 2003 R2 Datacenter x64 Edition：

| 文件名      | 版本       | 日期              | 时间  | 大小      | CPU | 文件夹                          |
|-------------|------------|-------------------|-------|-----------|-----|---------------------------------|
| mfc42u.dll  | 6.5.9146.0 | 2007 年 5 月 1 日 | 13:07 | 1,460,992 | X64 | SP1QFE                          |
| atl.dll     | 3.0.9238.0 | 2007 年 5 月 1 日 | 13:07 | 74,802    | X86 | SP1QFE\\asms\\6000\\msft\\vcrtl |
| mfc42.dll   | 6.0.8665.0 | 2007 年 5 月 1 日 | 13:07 | 995,383   | X86 | SP1QFE\\asms\\6000\\msft\\vcrtl |
| mfc42u.dll  | 6.0.9792.0 | 2007 年 5 月 1 日 | 13:07 | 1,011,774 | X86 | SP1QFE\\asms\\6000\\msft\\vcrtl |
| msvcp60.dll | 6.0.8972.0 | 2007 年 5 月 1 日 | 13:07 | 401,462   | X86 | SP1QFE\\asms\\6000\\msft\\vcrtl |
| wmfc40u.dll | 4.1.0.6141 | 2007 年 5 月 1 日 | 13:07 | 927,504   | X86 | SP1QFE\\wow                     |
| wmfc42u.dll | 6.6.8063.0 | 2007 年 5 月 1 日 | 13:07 | 1,163,776 | X86 | SP1QFE\\wow                     |
| wmfc40u.dll | 4.1.0.6141 | 2007 年 5 月 1 日 | 13:13 | 927,504   | X86 | SP2QFE\\wow                     |
| wmfc42u.dll | 6.6.8063.0 | 2007 年 5 月 1 日 | 13:13 | 1,163,776 | X86 | SP2QFE\\wow                     |

**注意** 当您安装这些安全更新时，安装程序将检查系统中正在更新的一个或多个文件是否已由 Microsoft 修补程序更新。

如果以前安装的修补程序已经更新过其中的某个文件，安装程序就会将 RTMQFE、SP1QFE 或 SP2QFE 文件复制到系统中。 否则，安装程序将 RTMGDR、SP1GDR 或 SP2GDR 文件复制到您的系统中。 安全更新可能不包含这些文件的所有版本。 有关此行为的详细信息，请参阅 [Microsoft 知识库文章 824994](http://support.microsoft.com/kb/824994)。

有关此行为的详细信息，请参阅 [Microsoft 知识库文章 824994](http://support.microsoft.com/kb/824994)。

有关 Update.exe 安装程序的详细信息，请访问 [Microsoft TechNet 网站](http://go.microsoft.com/fwlink/?linkid=38951)。

有关本公告中出现的术语（如“*修补程序*”）的详细信息，请参阅 [Microsoft 知识库文章 824684](http://support.microsoft.com/kb/824684)。

**验证是否已应用更新**

-   **Microsoft 基准安全分析器**

    要验证受影响的系统上是否应用了安全更新，可以使用 Microsoft 基准安全分析器 (MBSA) 工具。 请参阅本安全公告前面的“与此安全更新相关的常见问题 (FAQ)”部分的常见问题“可否使用 Microsoft 基准安全分析器 (MBSA) 确定是否需要此更新？”。

-   **文件版本验证**

    **注意** 由于 Microsoft Windows 有多个版本，因此以下步骤在您的计算机上可能会有所不同。 如果不同，请参阅产品文档来完成这些步骤。

    1.  单击“**开始**”，然后单击“**搜索**”。
    2.  在“**搜索结果**”窗格中，单击“**搜索助理**”下的“**所有文件和文件夹**”。
    3.  在“**完整或部分文件名**”框中，键入相应文件信息表中的一个文件名，然后单击“**搜索**”。
    4.  在文件列表中，用鼠标右键单击相应文件信息表中的一个文件名，然后单击“**属性**”。
        **注意** 由于安装的操作系统或程序的版本不同，因此文件信息表中所列的某些文件可能并未安装。
    5.  在“**版本**”选项卡上，通过将计算机上安装的文件与相应文件信息表中记录的版本进行比较来确定该文件的版本。
        **注意** 在安装过程中，除文件版本以外的其他属性均可能会发生变化。 不支持通过将其他文件属性与文件信息表中的信息进行比较这种方法来验证是否应用了更新。 另外，在某些情况下，在安装过程中还可能会重命名文件。 如果没有文件或版本信息，请使用另外一种方法来验证更新安装。

-   **注册表项验证**

    也可以通过查看以下注册表项，检查此安全更新已安装的文件。

    Windows Server 2003 Web Edition、Windows Server 2003 Standard Edition、Windows Server 2003 Enterprise Edition、Windows Server 2003 Datacenter Edition、Windows Small Business Server 2003、Windows Server 2003 Web Edition (SP1)、Windows Server 2003 Standard Edition (SP1)、Windows Server 2003 Enterprise Edition (SP1)、Windows Server 2003 Datacenter Edition (SP1)、Windows Server 2003 Web Edition (SP2)、Windows Server 2003 Standard Edition (SP2)、Windows Server 2003 Enterprise Edition (SP2)、Windows Server 2003 Datacenter Edition (SP2)、Windows Server 2003 Enterprise Edition（用于基于 Itanium 的系统）、Windows Server 2003 Datacenter Edition（用于基于 Itanium 的系统）、Windows Server 2003 Enterprise Edition (SP1)（用于基于 Itanium 的系统）、Windows Server 2003 Datacenter Edition (SP1)（用于基于 Itanium 的系统）、Windows Server 2003 Enterprise Edition (SP2)（用于基于 Itanium 的系统）、Windows Server 2003 Datacenter Edition (SP2)（用于基于 Itanium 的系统）、Windows Server 2003 Standard x64 Edition、Windows Server 2003 Enterprise x64 Edition、Windows Server 2003 Datacenter x64 Edition、Windows Server 2003 Standard x64 Edition Service Pack 2、Windows Server 2003 Enterprise x64 Edition Service Pack 2 和 Windows Server 2003 Datacenter x64 Edition Service Pack 2：

    HKEY\_LOCAL\_MACHINE\\SOFTWARE\\Microsoft\\Updates\\Windows Server 2003\\SP3\\KB924667\\Filelist

    **注意** 此注册表项可能不包含已安装文件的完整列表。 另外，如果管理员或 OEM 将 924667 安全更新集成或组合到 Windows 安装源文件中，则可能无法正确创建此注册表项。

#### Microsoft Visual Studio .NET 2002

**先决条件**
此安全更新需要 Microsoft Visual Studio .NET 2002。

**包括在以后的 Service Pack 中**
此问题的更新程序将包含在以后的更新汇总中。

**安装信息**

此安全更新支持以下安装开关。

<table class="dataTable">
<caption>
受支持的安全更新安装开关
</caption>
<tr class="thead">
<th>
开关
</th>
<th>
描述
</th>
</tr>
<tr>
<td style="border:1px solid black;">
**/?**
</td>
<td style="border:1px solid black;">
显示命令行选项。
</td>
</tr>
<tr>
<th colspan="2">
安装模式
</th>
</tr>
<tr class="alternateRow">
<td style="border:1px solid black;">
**/q**
</td>
<td style="border:1px solid black;">
无提示安装。
</td>
</tr>
<tr>
<th colspan="2">
安装选项
</th>
</tr>
<tr>
<td style="border:1px solid black;">
**/I**
</td>
<td style="border:1px solid black;">
安装（默认操作）。
</td>
</tr>
<tr class="alternateRow">
<td style="border:1px solid black;">
**/U**
</td>
<td style="border:1px solid black;">
卸载。
</td>
</tr>
<tr>
<td style="border:1px solid black;">
**/Xp\[:path\]**
</td>
<td style="border:1px solid black;">
将程序包解压缩到指定的目录。
</td>
</tr>
<tr>
<th colspan="2">
重新启动选项
</th>
</tr>
<tr class="alternateRow">
<td style="border:1px solid black;">
**/q**
</td>
<td style="border:1px solid black;">
安装完成后不重新启动。
</td>
</tr>
<tr>
<td style="border:1px solid black;">
**/l &lt;LogFile&gt;**
</td>
<td style="border:1px solid black;">
生成日志文件。
</td>
</tr>
<tr class="alternateRow">
<td style="border:1px solid black;">
**/l\[d | p | f \] &lt;LogFile&gt;**
</td>
<td style="border:1px solid black;">
d - 日志包详细信息  
p - 日志影响的产品  
f - 日志包含的文件
</td>
</tr>
</table>
<p> </p>
**注意** 这些开关可以在一个命令中组合使用。

**部署信息**

要在没有任何用户干预的情况下安装此安全更新，请在命令提示符下使用以下命令行：

**VS7.0-KB924641-x86 /q**

**注意** 使用此命令也将安装安全更新，而不强制重新启动系统。

**注意** 使用 **/q** 开关将抑制所有消息。 这包括抑制失败消息。 管理员应该使用其中一种支持的方法，验证使用 **/q** 开关时安装是否成功。 管理员还应该检查 KB924641.log 文件，查看使用此开关时的任何失败消息。

有关如何使用软件更新服务部署此安全更新的详细信息，请访问[软件更新服务网站](http://go.microsoft.com/fwlink/?linkid=21125)。 有关如何使用 Windows Server 更新服务部署此安全更新的详细信息，请访问 [Windows Server 更新服务网站](http://go.microsoft.com/fwlink/?linkid=50120)。

**重新启动要求**

在某些情况下，此更新不需要重新启动。 如果所需的文件正在使用，则此更新将需要重新启动。 如果发生这种情况，将显示一条消息建议您重新启动。

**删除信息**

要删除此安全更新，请使用“控制面板”中的“添加或删除程序”工具。

**文件信息**

此安全更新的英文版具有下表所列的文件属性。 这些文件的日期和时间按照协调通用时间 (UTC) 列出。 当您查看文件信息时，它将转换为本地时间。 要了解 UTC 与本地时间之间的时差，请使用“控制面板”上的“日期/时间”工具中的“**时区**”选项卡。

Microsoft Visual Studio .NET 2002：

| 文件名           | 版本       | 日期               | 时间  | 大小       |
|------------------|------------|--------------------|-------|------------|
| Atl70.pdb        | 不适用     | 2006 年 11 月 2 日 | 20:52 | 2,011,136  |
| afxdao.h         | 不适用     | 2006 年 11 月 1 日 | 20:54 | 39,733     |
| atl70.dll        | 7.0.9801.0 | 2006 年 11 月 2 日 | 20:52 | 84,992     |
| atlbase.cpp      | 不适用     | 2006 年 11 月 1 日 | 20:54 | 3,443      |
| atlbase.h        | 不适用     | 2006 年 11 月 1 日 | 20:54 | 163,480    |
| atlcomtime.inl   | 不适用     | 2006 年 11 月 1 日 | 20:54 | 16,396     |
| atlcore.h        | 不适用     | 2006 年 11 月 1 日 | 20:54 | 15,521     |
| atlhost.h        | 不适用     | 2006 年 11 月 1 日 | 20:54 | 76,520     |
| atlimage.h       | 不适用     | 2006 年 11 月 1 日 | 20:54 | 43,105     |
| atlmincrt.lib    | 不适用     | 2006 年 11 月 2 日 | 20:52 | 48,090     |
| atlmincrt.pdb    | 不适用     | 2006 年 11 月 2 日 | 20:52 | 659,456    |
| atlsd.lib        | 不适用     | 2006 年 11 月 2 日 | 20:52 | 1,003,890  |
| atlsd.pdb        | 不适用     | 2006 年 11 月 2 日 | 20:52 | 1,306,624  |
| atls.lib         | 不适用     | 2006 年 11 月 2 日 | 20:52 | 934,264    |
| atls.pdb         | 不适用     | 2006 年 11 月 2 日 | 20:52 | 1,306,624  |
| atl.lib          | 不适用     | 2006 年 11 月 2 日 | 20:52 | 14,546     |
| atl\_sys\_redist | 不适用     | 2006 年 11 月 3 日 | 00:54 | 97,792     |
| cstringt.h       | 不适用     | 2006 年 11 月 1 日 | 20:54 | 63,284     |
| dbcore.cpp       | 不适用     | 2006 年 11 月 1 日 | 20:54 | 116,779    |
| eafxisd.lib      | 不适用     | 2006 年 11 月 2 日 | 21:13 | 273,800    |
| eafxisd.pdb      | 不适用     | 2006 年 11 月 2 日 | 21:13 | 708,608    |
| Eafxis.lib       | 不适用     | 2006 年 11 月 2 日 | 21:13 | 282,816    |
| Eafxis.pdb       | 不适用     | 2006 年 11 月 2 日 | 21:13 | 888,832    |
| makefile.1       | 不适用     | 2006 年 11 月 1 日 | 20:54 | 19,956     |
| mfc70chs.dll     | 7.0.9801.0 | 2006 年 11 月 2 日 | 21:18 | 40,960     |
| mfc70cht.dll     | 7.0.9801.0 | 2006 年 11 月 2 日 | 21:18 | 45,056     |
| mfc70deu.dll     | 7.0.9801.0 | 2006 年 11 月 2 日 | 21:18 | 61,440     |
| mfc70d.def       | 不适用     | 2006 年 11 月 2 日 | 21:14 | 527,756    |
| mfc70d.lib       | 不适用     | 2006 年 11 月 2 日 | 21:14 | 3,066,694  |
| mfc70enu.dll     | 7.0.9801.0 | 2006 年 11 月 2 日 | 21:18 | 57,344     |
| mfc70esp.dll     | 7.0.9801.0 | 2006 年 11 月 2 日 | 21:18 | 61,440     |
| mfc70fra.dll     | 7.0.9801.0 | 2006 年 11 月 2 日 | 21:18 | 61,440     |
| mfc70ita.dll     | 7.0.9801.0 | 2006 年 11 月 2 日 | 21:18 | 61,440     |
| mfc70jpn.dll     | 7.0.9801.0 | 2006 年 11 月 2 日 | 21:18 | 49,152     |
| mfc70kor.dll     | 7.0.9801.0 | 2006 年 11 月 2 日 | 21:18 | 49,152     |
| mfc70ud.def      | 不适用     | 2006 年 11 月 2 日 | 21:14 | 528,736    |
| mfc70ud.dll      | 7.0.9801.0 | 2006 年 11 月 2 日 | 21:14 | 2,066,944  |
| mfc70ud.lib      | 不适用     | 2006 年 11 月 2 日 | 21:15 | 3,978,842  |
| mfc70u.def       | 不适用     | 2006 年 11 月 2 日 | 21:20 | 393,034    |
| mfc70u.dll       | 7.0.9801.0 | 2006 年 11 月 2 日 | 21:26 | 1,017,344  |
| mfc70u.lib       | 不适用     | 2006 年 11 月 2 日 | 21:16 | 3,042,324  |
| mfc70.def        | 不适用     | 2006 年 11 月 2 日 | 21:14 | 392,265    |
| mfc70.dll        | 7.0.9801.0 | 2006 年 11 月 2 日 | 21:14 | 1,019,904  |
| mfc70.lib        | 不适用     | 2006 年 11 月 2 日 | 21:14 | 2,287,020  |
| mfcdll.mak       | 不适用     | 2006 年 11 月 1 日 | 20:54 | 7,662      |
| mfcs70d.lib      | 不适用     | 2006 年 11 月 2 日 | 21:14 | 526,960    |
| mfcs70ud.lib     | 不适用     | 2006 年 11 月 2 日 | 21:14 | 468,956    |
| mfcs70u.lib      | 不适用     | 2006 年 11 月 2 日 | 21:20 | 452,554    |
| mfcs70.lib       | 不适用     | 2006 年 11 月 2 日 | 21:14 | 505,780    |
| mfc.bsc          | 不适用     | 2006 年 11 月 2 日 | 21:18 | 10,513,408 |
| nafxcwd.lib      | 不适用     | 2006 年 11 月 2 日 | 21:12 | 16,598,814 |
| nafxcwd.pdb      | 不适用     | 2006 年 11 月 2 日 | 21:12 | 2,093,056  |
| nafxcw.lib       | 不适用     | 2006 年 11 月 2 日 | 21:13 | 16,468,248 |
| nafxcw.pdb       | 不适用     | 2006 年 11 月 2 日 | 21:12 | 2,068,480  |
| nafxisd.lib      | 不适用     | 2006 年 11 月 2 日 | 21:13 | 123,608    |
| nafxisd.pdb      | 不适用     | 2006 年 11 月 2 日 | 21:13 | 102,400    |
| Nafxis.lib       | 不适用     | 2006 年 11 月 2 日 | 21:13 | 122,026    |
| Nafxis.pdb       | 不适用     | 2006 年 11 月 2 日 | 21:13 | 102,400    |
| Occcont.cpp      | 不适用     | 2006 年 11 月 1 日 | 20:54 | 24,333     |
| Oledisp1.cpp     | 不适用     | 2006 年 11 月 1 日 | 20:54 | 44,958     |
| oleui2.cpp       | 不适用     | 2006 年 11 月 1 日 | 20:54 | 4,166      |
| uafxcwd.lib      | 不适用     | 2006 年 11 月 2 日 | 21:13 | 17,032,222 |
| uafxcwd.pdb      | 不适用     | 2006 年 11 月 2 日 | 21:13 | 2,093,056  |
| Uafxcw.lib       | 不适用     | 2006 年 11 月 2 日 | 21:14 | 16,743,758 |
| Uafxcw.pdb       | 不适用     | 2006 年 11 月 2 日 | 21:13 | 2,068,480  |
| viewprev.cpp     | 不适用     | 2006 年 11 月 1 日 | 20:54 | 34,858     |
| winocc.cpp       | 不适用     | 2006 年 11 月 1 日 | 20:54 | 19,200     |
| Mfc70d.dll       | 7.0.9801.0 | 2006 年 11 月 2 日 | 21:14 | 2,072,576  |
| Mfc70d.map       | 不适用     | 2006 年 11 月 2 日 | 21:14 | 1,791,934  |
| Mfc70d.pdb       | 不适用     | 2006 年 11 月 2 日 | 21:14 | 7,875,584  |
| Mfc70ud.map      | 不适用     | 2006 年 11 月 2 日 | 21:14 | 1,842,070  |
| Mfc70ud.pdb      | 不适用     | 2006 年 11 月 2 日 | 21:14 | 7,908,352  |
| Mfc70u.pdb       | 不适用     | 2006 年 11 月 2 日 | 21:26 | 9,964,544  |
| Mfc70.map        | 不适用     | 2006 年 11 月 2 日 | 21:14 | 1,254,636  |
| Mfc70.pdb        | 不适用     | 2006 年 11 月 2 日 | 21:14 | 6,786,048  |
| Mfcs70d.pdb      | 不适用     | 2006 年 11 月 2 日 | 21:14 | 1,888,256  |
| Mfcs70ud.pdb     | 不适用     | 2006 年 11 月 2 日 | 21:14 | 1,896,448  |
| Mfcs70u.pdb      | 不适用     | 2006 年 11 月 2 日 | 21:20 | 1,888,256  |
| Mfcs70.pdb       | 不适用     | 2006 年 11 月 2 日 | 21:14 | 1,880,064  |

**注意**当您安装这些安全更新时，安装程序将检查系统中正在更新的一个或多个文件是否已由 Microsoft 修补程序更新。

有关此行为的详细信息，请参阅 [Microsoft 知识库文章 824994](http://support.microsoft.com/kb/824994)。

有关本公告中出现的术语（如“*修补程序*”）的详细信息，请参阅 [Microsoft 知识库文章 824684](http://support.microsoft.com/kb/824684)。

**验证是否已应用更新**

-   **Microsoft 基准安全分析器**

    要验证受影响的系统上是否应用了安全更新，可以使用 Microsoft 基准安全分析器 (MBSA) 工具。 请参阅本安全公告前面的“与此安全更新相关的常见问题 (FAQ)”部分的常见问题“可否使用 Microsoft 基准安全分析器 (MBSA) 确定是否需要此更新？”。

-   **文件版本验证**

    **注意** 由于 Microsoft Windows 有多个版本，因此以下步骤在您的计算机上可能会有所不同。 如果不同，请参阅产品文档来完成这些步骤。

    1.  单击“**开始**”，然后单击“**搜索**”。
    2.  在“**搜索结果**”窗格中，单击“**搜索助理**”下的“**所有文件和文件夹**”。
    3.  在“**完整或部分文件名**”框中，键入相应文件信息表中的一个文件名，然后单击“**搜索**”。
    4.  在文件列表中，用鼠标右键单击相应文件信息表中的一个文件名，然后单击“**属性**”。
        **注意** 由于安装的操作系统或程序的版本不同，因此文件信息表中所列的某些文件可能并未安装。
    5.  在“**版本**”选项卡上，通过将计算机上安装的文件与相应文件信息表中记录的版本进行比较来确定该文件的版本。
        **注意** 在安装过程中，除文件版本以外的其他属性均可能会发生变化。 不支持通过将其他文件属性与文件信息表中的信息进行比较这种方法来验证是否应用了更新。 另外，在某些情况下，在安装过程中还可能会重命名文件。 如果没有文件或版本信息，请使用另外一种方法来验证更新安装。

-   **注册表项验证**

    也可以通过查看以下注册表项，检查此安全更新已安装的文件：

    HKEY\_LOCAL\_MACHINE\\Software\\Microsoft\\Updates\\Visual Studio\\7.0\\M924641
    "Installed" = dword:1

#### Microsoft Visual Studio .NET 2002 Service Pack 1

**先决条件**
此安全更新需要 Microsoft Visual Studio .NET 2002 Service Pack 1。

**包括在以后的 Service Pack 中**
此问题的更新程序将包含在以后的 Service Pack 或更新汇总中。

**安装信息**

此安全更新支持以下安装开关。

<table class="dataTable">
<caption>
受支持的安全更新安装开关
</caption>
<tr class="thead">
<th>
开关
</th>
<th>
描述
</th>
</tr>
<tr>
<td style="border:1px solid black;">
**/?**
</td>
<td style="border:1px solid black;">
显示命令行选项。
</td>
</tr>
<tr>
<th colspan="2">
安装模式
</th>
</tr>
<tr class="alternateRow">
<td style="border:1px solid black;">
**/q**
</td>
<td style="border:1px solid black;">
安静模式。 这与无人参与模式相同，但是不显示任何状态或错误消息。
</td>
</tr>
<tr>
<th colspan="2">
安装选项
</th>
</tr>
<tr>
<td style="border:1px solid black;">
**/I**
</td>
<td style="border:1px solid black;">
安装（默认操作）。
</td>
</tr>
<tr class="alternateRow">
<td style="border:1px solid black;">
**/U**
</td>
<td style="border:1px solid black;">
卸载。
</td>
</tr>
<tr>
<td style="border:1px solid black;">
**/Xp\[:path\]**
</td>
<td style="border:1px solid black;">
将程序包解压缩到指定的目录。
</td>
</tr>
<tr>
<th colspan="2">
重新启动选项
</th>
</tr>
<tr class="alternateRow">
<td style="border:1px solid black;">
**/q**
</td>
<td style="border:1px solid black;">
安装完成后不重新启动。
</td>
</tr>
<tr>
<td style="border:1px solid black;">
**/l &lt;LogFile&gt;**
</td>
<td style="border:1px solid black;">
生成日志文件。
</td>
</tr>
<tr class="alternateRow">
<td style="border:1px solid black;">
**/l\[d | p | f \] &lt;LogFile&gt;**
</td>
<td style="border:1px solid black;">
d - 日志包详细信息  
p - 日志影响的产品  
f - 日志包含的文件
</td>
</tr>
</table>
<p> </p>
**注意** 这些开关可以在一个命令中组合使用。

**部署信息**

要在没有任何用户干预的情况下安装此安全更新，请在命令提示符下使用以下命令行：

**VS7.0sp1-KB924642-x86 /q**

**注意** 使用此命令也将安装安全更新，而不强制重新启动系统。

**注意** 使用 **/q** 开关将抑制所有消息。 这包括抑制失败消息。 管理员应该使用其中一种支持的方法，验证使用 **/q** 开关时安装是否成功。 管理员还应该检查 KB924642.log 文件，查看使用此开关时的任何失败消息。

有关如何使用软件更新服务部署此安全更新的信息，请访问[软件更新服务网站](http://go.microsoft.com/fwlink/?linkid=21125)。 有关如何使用 Windows Server 更新服务部署此安全更新的详细信息，请访问 [Windows Server 更新服务网站](http://go.microsoft.com/fwlink/?linkid=50120)。

**重新启动要求**

在某些情况下，此更新不需要重新启动。 如果所需的文件正在使用，则此更新将需要重新启动。 如果发生这种情况，将显示一条消息建议您重新启动。

**删除信息**

要删除此安全更新，请使用“控制面板”中的“添加或删除程序”工具。

**文件信息**

此安全更新的英文版具有下表所列的文件属性。 这些文件的日期和时间按照协调通用时间 (UTC) 列出。 当您查看文件信息时，它将转换为本地时间。 要了解 UTC 与本地时间之间的时差，请使用“控制面板”上的“日期/时间”工具中的“**时区**”选项卡。

Microsoft Visual Studio .NET 2002 Service Pack 1：

| 文件名        | 版本       | 日期               | 时间  | 大小       |
|---------------|------------|--------------------|-------|------------|
| Atl70.pdb     | 不适用     | 2006 年 8 月 26 日 | 06:17 | 2,011,136  |
| atl70.dll     | 7.0.9975.0 | 2006 年 8 月 26 日 | 06:17 | 86,016     |
| atlmincrt.lib | 不适用     | 2006 年 8 月 26 日 | 06:17 | 48,090     |
| atlmincrt.pdb | 不适用     | 2006 年 8 月 26 日 | 06:17 | 659,456    |
| atlsd.lib     | 不适用     | 2006 年 8 月 26 日 | 06:17 | 1,017,490  |
| atlsd.pdb     | 不适用     | 2006 年 8 月 26 日 | 06:17 | 1,306,624  |
| atls.lib      | 不适用     | 2006 年 8 月 26 日 | 06:17 | 949,488    |
| atls.pdb      | 不适用     | 2006 年 8 月 26 日 | 06:17 | 1,306,624  |
| atl.lib       | 不适用     | 2006 年 8 月 26 日 | 06:17 | 14,546     |
| dbcore.cpp    | 不适用     | 2006 年3 月 30 日  | 22:43 | 116,779    |
| eafxisd.lib   | 不适用     | 2006 年 8 月 26 日 | 07:05 | 274,018    |
| eafxisd.pdb   | 不适用     | 2006 年 8 月 26 日 | 07:05 | 708,608    |
| eafxis.lib    | 不适用     | 2006 年 8 月 26 日 | 07:05 | 283,524    |
| eafxis.pdb    | 不适用     | 2006 年 8 月 26 日 | 07:05 | 888,832    |
| makefile.1    | 不适用     | 2006 年3 月 30 日  | 22:43 | 19,956     |
| mfc70chs.dll  | 7.0.9975.0 | 2006 年 8 月 26 日 | 07:15 | 40,960     |
| mfc70cht.dll  | 7.0.9975.0 | 2006 年 8 月 26 日 | 07:15 | 45,056     |
| mfc70deu.dll  | 7.0.9975.0 | 2006 年 8 月 26 日 | 07:15 | 61,440     |
| mfc70d.lib    | 不适用     | 2006 年 8 月 26 日 | 07:07 | 3,066,694  |
| mfc70enu.dll  | 7.0.9975.0 | 2006 年 8 月 26 日 | 07:15 | 57,344     |
| mfc70esp.dll  | 7.0.9975.0 | 2006 年 8 月 26 日 | 07:15 | 61,440     |
| mfc70fra.dll  | 7.0.9975.0 | 2006 年 8 月 26 日 | 07:15 | 61,440     |
| mfc70ita.dll  | 7.0.9975.0 | 2006 年 8 月 26 日 | 07:15 | 61,440     |
| mfc70jpn.dll  | 7.0.9975.0 | 2006 年 8 月 26 日 | 07:15 | 49,152     |
| mfc70kor.dll  | 7.0.9975.0 | 2006 年 8 月 26 日 | 07:15 | 49,152     |
| mfc70ud.dll   | 7.0.9975.0 | 2006 年 8 月 26 日 | 07:08 | 2,067,456  |
| mfc70ud.lib   | 不适用     | 2006 年 8 月 26 日 | 07:09 | 3,978,842  |
| mfc70u.dll    | 7.0.9975.0 | 2006 年 8 月 26 日 | 07:28 | 1,017,344  |
| mfc70u.lib    | 不适用     | 2006 年 8 月 26 日 | 07:10 | 3,042,324  |
| mfc70.dll     | 7.0.9975.0 | 2006 年 8 月 26 日 | 07:07 | 1,024,000  |
| mfc70.lib     | 不适用     | 2006 年 8 月 26 日 | 07:07 | 2,287,020  |
| mfcs70d.lib   | 不适用     | 2006 年 8 月 26 日 | 07:07 | 526,960    |
| mfcs70ud.lib  | 不适用     | 2006 年 8 月 26 日 | 07:08 | 468,956    |
| mfcs70u.lib   | 不适用     | 2006 年 8 月 26 日 | 07:19 | 452,554    |
| mfcs70.lib    | 不适用     | 2006 年 8 月 26 日 | 07:07 | 505,780    |
| mfc.bsc       | 不适用     | 2006 年 8 月 26 日 | 07:15 | 10,513,408 |
| nafxcwd.lib   | 不适用     | 2006 年 8 月 26 日 | 07:05 | 16,599,632 |
| nafxcwd.pdb   | 不适用     | 2006 年 8 月 26 日 | 07:04 | 2,093,056  |
| nafxcw.lib    | 不适用     | 2006 年 8 月 26 日 | 07:05 | 16,468,908 |
| nafxcw.pdb    | 不适用     | 2006 年 8 月 26 日 | 07:05 | 2,068,480  |
| nafxisd.lib   | 不适用     | 2006 年 8 月 26 日 | 07:05 | 123,826    |
| nafxisd.pdb   | 不适用     | 2006 年 8 月 26 日 | 07:05 | 102,400    |
| nafxis.lib    | 不适用     | 2006 年 8 月 26 日 | 07:05 | 122,458    |
| nafxis.pdb    | 不适用     | 2006 年 8 月 26 日 | 07:05 | 102,400    |
| occcont.cpp   | 不适用     | 2006 年3 月 30 日  | 22:43 | 24,333     |
| oledisp1.cpp  | 不适用     | 2006 年3 月 30 日  | 22:43 | 44,958     |
| oleui2.cpp    | 不适用     | 2006 年 8 月 25 日 | 02:19 | 4,166      |
| uafxcwd.lib   | 不适用     | 2006 年 8 月 26 日 | 07:06 | 17,032,684 |
| uafxcwd.pdb   | 不适用     | 2006 年 8 月 26 日 | 07:05 | 2,093,056  |
| uafxcw.lib    | 不适用     | 2006 年 8 月 26 日 | 07:06 | 16,744,322 |
| uafxcw.pdb    | 不适用     | 2006 年 8 月 26 日 | 07:06 | 2,068,480  |
| viewprev.cpp  | 不适用     | 2006 年3 月 30 日  | 22:44 | 34,858     |
| winocc.cpp    | 不适用     | 2006 年3 月 30 日  | 22:44 | 19,200     |
| Mfc70d.dll    | 7.0.9975.0 | 2006 年 8 月 26 日 | 07:07 | 2,072,576  |
| Mfc70d.map    | 不适用     | 2006 年 8 月 26 日 | 07:07 | 1,792,017  |
| Mfc70d.pdb    | 不适用     | 2006 年 8 月 26 日 | 07:07 | 7,875,584  |
| Mfc70ud.map   | 不适用     | 2006 年 8 月 26 日 | 07:08 | 1,842,153  |
| Mfc70ud.pdb   | 不适用     | 2006 年 8 月 26 日 | 07:08 | 7,908,352  |
| Mfc70u.pdb    | 不适用     | 2006 年 8 月 26 日 | 07:28 | 9,964,544  |
| Mfc70.map     | 不适用     | 2006 年 8 月 26 日 | 07:07 | 1,254,718  |
| Mfc70.pdb     | 不适用     | 2006 年 8 月 26 日 | 07:07 | 6,786,048  |
| Mfcs70d.pdb   | 不适用     | 2006 年 8 月 26 日 | 07:07 | 1,888,256  |
| Mfcs70ud.pdb  | 不适用     | 2006 年 8 月 26 日 | 07:08 | 1,896,448  |
| Mfcs70u.pdb   | 不适用     | 2006 年 8 月 26 日 | 07:19 | 1,888,256  |
| Mfcs70.pdb    | 不适用     | 2006 年 8 月 26 日 | 07:07 | 1,880,064  |

**注意**当您安装这些安全更新时，安装程序将检查系统中正在更新的一个或多个文件是否已由 Microsoft 修补程序更新。

有关此行为的详细信息，请参阅 [Microsoft 知识库文章 824994](http://support.microsoft.com/kb/824994)。

有关本公告中出现的术语（如“*修补程序*”）的详细信息，请参阅 [Microsoft 知识库文章 824684](http://support.microsoft.com/kb/824684)。

**验证是否已应用更新**

-   **Microsoft 基准安全分析器**

    要验证受影响的系统上是否应用了安全更新，可以使用 Microsoft 基准安全分析器 (MBSA) 工具。 请参阅本安全公告前面的“与此安全更新相关的常见问题 (FAQ)”部分的常见问题“可否使用 Microsoft 基准安全分析器 (MBSA) 确定是否需要此更新？”。

-   **文件版本验证**

    **注意** 由于 Microsoft Windows 有多个版本，因此以下步骤在您的计算机上可能会有所不同。 如果不同，请参阅产品文档来完成这些步骤。

    1.  单击“**开始**”，然后单击“**搜索**”。
    2.  在“**搜索结果**”窗格中，单击“**搜索助理**”下的“**所有文件和文件夹**”。
    3.  在“**完整或部分文件名**”框中，键入相应文件信息表中的一个文件名，然后单击“**搜索**”。
    4.  在文件列表中，用鼠标右键单击相应文件信息表中的一个文件名，然后单击“**属性**”。
        **注意** 由于安装的操作系统或程序的版本不同，因此文件信息表中所列的某些文件可能并未安装。
    5.  在“**版本**”选项卡上，通过将计算机上安装的文件与相应文件信息表中记录的版本进行比较来确定该文件的版本。
        **注意** 在安装过程中，除文件版本以外的其他属性均可能会发生变化。 不支持通过将其他文件属性与文件信息表中的信息进行比较这种方法来验证是否应用了更新。 另外，在某些情况下，在安装过程中还可能会重命名文件。 如果没有文件或版本信息，请使用另外一种方法来验证更新安装。

-   **注册表项验证**

    也可以通过查看以下注册表项，检查此安全更新已安装的文件。

    HKEY\_LOCAL\_MACHINE\\Software\\Microsoft\\Updates\\Visual Studio\\7.0\\M924642
    "Installed" = dword:1

#### Microsoft Visual Studio .NET 2003

**先决条件**
此安全更新需要 Microsoft Visual Studio .NET 2003。

**包括在以后的 Service Pack 中**
此问题的更新将包括在以后的 Service Pack 或更新汇总中。

**安装信息**

此安全更新支持以下安装开关。

<table class="dataTable">
<caption>
受支持的安全更新安装开关
</caption>
<tr class="thead">
<th>
开关
</th>
<th>
描述
</th>
</tr>
<tr>
<td style="border:1px solid black;">
**/?**
</td>
<td style="border:1px solid black;">
显示命令行选项。
</td>
</tr>
<tr>
<th colspan="2">
安装模式
</th>
</tr>
<tr class="alternateRow">
<td style="border:1px solid black;">
**/q**
</td>
<td style="border:1px solid black;">
无提示安装。
</td>
</tr>
<tr>
<th colspan="2">
安装选项
</th>
</tr>
<tr>
<td style="border:1px solid black;">
**/I**
</td>
<td style="border:1px solid black;">
安装（默认操作）。
</td>
</tr>
<tr class="alternateRow">
<td style="border:1px solid black;">
**/U**
</td>
<td style="border:1px solid black;">
卸载。
</td>
</tr>
<tr>
<td style="border:1px solid black;">
**/Xp\[:path\]**
</td>
<td style="border:1px solid black;">
将程序包解压缩到指定的目录。
</td>
</tr>
<tr>
<th colspan="2">
重新启动选项
</th>
</tr>
<tr class="alternateRow">
<td style="border:1px solid black;">
**/q**
</td>
<td style="border:1px solid black;">
安装完成后不重新启动。
</td>
</tr>
<tr>
<th colspan="2">
日志记录选项
</th>
</tr>
<tr>
<td style="border:1px solid black;">
**/l &lt;LogFile&gt;**
</td>
<td style="border:1px solid black;">
生成日志文件。
</td>
</tr>
<tr class="alternateRow">
<td style="border:1px solid black;">
**/l\[d | p | f \] &lt;LogFile&gt;**
</td>
<td style="border:1px solid black;">
d - 日志包详细信息  
p - 日志影响的产品  
f - 日志包含的文件
</td>
</tr>
</table>
<p> </p>
**注意** 这些开关可以在一个命令中组合使用。

**部署信息**

要在没有任何用户干预的情况下安装此安全更新，请在命令提示符下使用以下命令行：

**VS7.1-KB924643-x86 /q**

**注意** 使用此命令也将安装安全更新，而不强制重新启动系统。

**注意** 使用 **/q** 开关将抑制所有消息。 这包括抑制失败消息。 管理员应该使用其中一种支持的方法，验证使用 **/q** 开关时安装是否成功。 管理员还应该检查 KB924643.log 文件，查看使用此开关时的任何失败消息。

有关如何使用软件更新服务部署此安全更新的信息，请访问[软件更新服务网站](http://go.microsoft.com/fwlink/?linkid=21125)。 有关如何使用 Windows Server 更新服务部署此安全更新的详细信息，请访问 [Windows Server 更新服务网站](http://go.microsoft.com/fwlink/?linkid=50120)。

**重新启动要求**

在某些情况下，此更新不需要重新启动。 如果所需的文件正在使用，则此更新将需要重新启动。 如果发生这种情况，将显示一条消息建议您重新启动。

**删除信息**

要删除此更新，请使用“控制面板”中的“添加/删除程序”工具。

**文件信息**

此安全更新的英文版具有下表所列的文件属性。 这些文件的日期和时间按照协调通用时间 (UTC) 列出。 当您查看文件信息时，它将转换为本地时间。 要了解 UTC 与本地时间之间的时差，请使用“控制面板”上的“日期/时间”工具中的“**时区**”选项卡。

Microsoft Visual Studio .NET 2003：

| 文件名                                  | 版本        | 日期                | 时间  | 大小       |
|-----------------------------------------|-------------|---------------------|-------|------------|
| afxisapi.h                              | 不适用      | 2005 年 12 月 16 日 | 00:38 | 21,792     |
| afx.h                                   | 不适用      | 2003 年 7 月 18 日  | 00:22 | 56,223     |
| Array\_s.cpp                            | 不适用      | 2005 年 6 月 14 日  | 18:25 | 9,801      |
| atl71.dll                               | 7.10.5057.0 | 2006 年 11 月 1 日  | 04:24 | 89,088     |
| atl71.dll                               | 7.10.5057.0 | 2006 年 11 月 1 日  | 04:24 | 89,088     |
| atl71.dll                               | 7.10.5057.0 | 2006 年 11 月 1 日  | 04:24 | 106,496    |
| atl71.pdb                               | 不适用      | 2006 年 11 月 1 日  | 04:24 | 2,052,096  |
| atl71.pdb                               | 不适用      | 2006 年 11 月 1 日  | 04:24 | 2,043,904  |
| atlcomtime.inl                          | 不适用      | 2003 年 11 月 18 日 | 05:55 | 17,677     |
| atlevent.h                              | 不适用      | 2004 年 1 月 22 日  | 20:05 | 13,014     |
| atlhost.h                               | 不适用      | 2004 年 5 月 4 日   | 20:11 | 76,374     |
| atlsd.lib                               | 不适用      | 2006 年 11 月 1 日  | 04:24 | 1,240,238  |
| atlsd.pdb                               | 不适用      | 2006 年 11 月 1 日  | 04:24 | 1,323,008  |
| atls.lib                                | 不适用      | 2006 年 11 月 1 日  | 04:24 | 1,199,632  |
| atls.pdb                                | 不适用      | 2006 年 11 月 1 日  | 04:24 | 1,323,008  |
| atltime.h                               | 不适用      | 2003 年 8 月 30 日  | 00:16 | 10,647     |
| atltime.inl                             | 不适用      | 2003 年 8 月 30 日  | 00:18 | 14,773     |
| atl.lib                                 | 不适用      | 2006 年 11 月 1 日  | 04:24 | 14,546     |
| dbcore.cpp                              | 不适用      | 2004 年 8 月 3 日   | 21:55 | 118,402    |
| dllinit.cpp                             | 不适用      | 2004 年 11 月 2 日  | 20:46 | 22,956     |
| eafxisd.lib                             | 不适用      | 2006 年 11 月 1 日  | 04:48 | 316,428    |
| eafxisd.pdb                             | 不适用      | 2006 年 11 月 1 日  | 04:48 | 724,992    |
| eafxis.lib                              | 不适用      | 2006 年 11 月 1 日  | 04:48 | 324,994    |
| eafxis.pdb                              | 不适用      | 2006 年 11 月 1 日  | 04:48 | 897,024    |
| filest.cpp                              | 不适用      | 11-Sep-2003         | 22:30 | 9,121      |
| mfc71d.dll                              | 7.10.5057.0 | 2006 年 11 月 1 日  | 04:49 | 2,187,264  |
| mfc71chs.dll                            | 7.10.5057.0 | 2006 年 11 月 1 日  | 04:54 | 40,960     |
| mfc71cht.dll                            | 7.10.5057.0 | 2006 年 11 月 1 日  | 04:54 | 45,056     |
| mfc71deu.dll                            | 7.10.5057.0 | 2006 年 11 月 1 日  | 04:54 | 65,536     |
| mfc71d.lib                              | 不适用      | 2006 年 11 月 1 日  | 04:49 | 3,361,062  |
| mfc71d.map                              | 不适用      | 2006 年 11 月 1 日  | 04:49 | 2,187,278  |
| mfc71d.pdb                              | 不适用      | 2006 年 11 月 1 日  | 04:49 | 8,326,144  |
| mfc71enu.dll                            | 7.10.5057.0 | 2006 年 11 月 1 日  | 04:54 | 57,344     |
| mfc71esp.dll                            | 7.10.5057.0 | 2006 年 11 月 1 日  | 04:54 | 61,440     |
| mfc71fra.dll                            | 7.10.5057.0 | 2006 年 11 月 1 日  | 04:54 | 61,440     |
| mfc71ita.dll                            | 7.10.5057.0 | 2006 年 11 月 1 日  | 04:54 | 61,440     |
| mfc71jpn.dll                            | 7.10.5057.0 | 2006 年 11 月 1 日  | 04:54 | 49,152     |
| mfc71kor.dll                            | 7.10.5057.0 | 2006 年 11 月 1 日  | 04:54 | 49,152     |
| mfc71ud.dll                             | 7.10.5057.0 | 2006 年 11 月 1 日  | 04:50 | 2,182,144  |
| mfc71ud.lib                             | 不适用      | 2006 年 11 月 1 日  | 04:51 | 4,287,960  |
| mfc71ud.map                             | 不适用      | 2006 年 11 月 1 日  | 04:50 | 2,235,638  |
| mfc71ud.pdb                             | 不适用      | 2006 年 11 月 1 日  | 04:50 | 8,367,104  |
| mfc71u.dll                              | 7.10.5057.0 | 2006 年 11 月 1 日  | 05:05 | 1,049,600  |
| mfc71u.lib                              | 不适用      | 2006 年 11 月 1 日  | 04:51 | 3,348,140  |
| mfc71u.map                              | 不适用      | 2006 年 11 月 1 日  | 05:05 | 1,192,844  |
| mfc71u.pdb                              | 不适用      | 2006 年 11 月 1 日  | 05:05 | 10,415,104 |
| mfc71.dll                               | 7.10.5057.0 | 2006 年 11 月 1 日  | 04:50 | 1,056,768  |
| mfc71.lib                               | 不适用      | 2006 年 11 月 1 日  | 04:50 | 2,580,010  |
| mfc71.map                               | 不适用      | 2006 年 11 月 1 日  | 04:50 | 1,604,499  |
| mfc71.pdb                               | 不适用      | 2006 年 11 月 1 日  | 04:50 | 7,105,536  |
| mfcs71d.lib                             | 不适用      | 2006 年 11 月 1 日  | 04:49 | 582,136    |
| mfcs71d.pdb                             | 不适用      | 2006 年 11 月 1 日  | 04:49 | 1,937,408  |
| mfcs71ud.lib                            | 不适用      | 2006 年 11 月 1 日  | 04:51 | 507,600    |
| mfcs71ud.pdb                            | 不适用      | 2006 年 11 月 1 日  | 04:50 | 1,945,600  |
| mfcs71u.lib                             | 不适用      | 2006 年 11 月 1 日  | 04:57 | 490,054    |
| mfcs71u.pdb                             | 不适用      | 2006 年 11 月 1 日  | 04:57 | 1,937,408  |
| mfcs71.lib                              | 不适用      | 2006 年 11 月 1 日  | 04:50 | 561,646    |
| mfcs71.pdb                              | 不适用      | 2006 年 11 月 1 日  | 04:50 | 1,929,216  |
| nafxcwd.lib                             | 不适用      | 2006 年 11 月 1 日  | 04:48 | 17,069,496 |
| nafxcwd.pdb                             | 不适用      | 2006 年 11 月 1 日  | 04:47 | 2,142,208  |
| nafxcw.lib                              | 不适用      | 2006 年 11 月 1 日  | 04:48 | 16,946,542 |
| nafxcw.pdb                              | 不适用      | 2006 年 11 月 1 日  | 04:47 | 2,125,824  |
| nafxisd.lib                             | 不适用      | 2006 年 11 月 1 日  | 04:48 | 146,178    |
| nafxisd.pdb                             | 不适用      | 2006 年 11 月 1 日  | 04:48 | 118,784    |
| Nafxis.lib                              | 不适用      | 2006 年 11 月 1 日  | 04:48 | 142,140    |
| Nafxis.pdb                              | 不适用      | 2006 年 11 月 1 日  | 04:48 | 118,784    |
| objcore.cpp                             | 不适用      | 2003 年 7 月 18 日  | 00:19 | 6,073      |
| occcont.cpp                             | 不适用      | 2003 年 7 月 18 日  | 01:21 | 24,323     |
| occdlg.cpp                              | 不适用      | 2004 年 7 月 16 日  | 23:34 | 20,901     |
| oledlgs1.cpp                            | 不适用      | 06-Aug-2004         | 00:07 | 39,089     |
| oledobj2.cpp                            | 不适用      | 2005 年 2 月 1 日   | 21:37 | 21,661     |
| olefact.cpp                             | 不适用      | 2004 年 1 月 20 日  | 21:31 | 16,801     |
| olepset.cpp                             | 不适用      | 2004 年 3 月 25 日  | 07:32 | 40,431     |
| olestrm.cpp                             | 不适用      | 2004 年 5 月 5 日   | 17:48 | 14,141     |
| oleui2.cpp                              | 不适用      | 2006 年 2 月 14 日  | 18:05 | 4,156      |
| statreg.h                               | 不适用      | 2004 年 7 月 14 日  | 21:47 | 34,214     |
| uafxcwd.lib                             | 不适用      | 2006 年 11 月 1 日  | 04:49 | 17,459,910 |
| uafxcwd.pdb                             | 不适用      | 2006 年 11 月 1 日  | 04:48 | 2,142,208  |
| uafxcw.lib                              | 不适用      | 2006 年 11 月 1 日  | 04:49 | 17,244,280 |
| uafxcw.pdb                              | 不适用      | 2006 年 11 月 1 日  | 04:48 | 2,125,824  |
| vc\_user\_atl71\_rtl\_x86\_---.msm      | 不适用      | 2006 年 11 月 1 日  | 23:02 | 101,376    |
| vc\_user\_mfc71\_loc\_rtl\_x86\_---.msm | 不适用      | 2006 年 11 月 1 日  | 23:02 | 100,864    |
| vc\_user\_mfc71\_rtl\_x86\_---.msm      | 不适用      | 2006 年 11 月 1 日  | 23:02 | 890,880    |
| winctrl4.cpp                            | 不适用      | 2006 年 10 月 26 日 | 23:48 | 8,830      |
| winfrm.cpp                              | 不适用      | 2004 年 8 月 17 日  | 22:01 | 65,514     |
| winocc.cpp                              | 不适用      | 2005 年 2 月 23 日  | 00:04 | 23,623     |

**注意**当您安装这些安全更新时，安装程序将检查系统中正在更新的一个或多个文件是否已由 Microsoft 修补程序更新。

有关此行为的详细信息，请参阅 [Microsoft 知识库文章 824994](http://support.microsoft.com/kb/824994)。

有关本公告中出现的术语（如“*修补程序*”）的详细信息，请参阅 [Microsoft 知识库文章 824684](http://support.microsoft.com/kb/824684)。

**验证是否已应用更新**

-   **Microsoft 基准安全分析器**

    要验证受影响的系统上是否应用了安全更新，可以使用 Microsoft 基准安全分析器 (MBSA) 工具。 请参阅本安全公告前面的“与此安全更新相关的常见问题 (FAQ)”部分的常见问题“可否使用 Microsoft 基准安全分析器 (MBSA) 确定是否需要此更新？”。

-   **文件版本验证**

    **注意** 由于 Microsoft Windows 有多个版本，因此以下步骤在您的计算机上可能会有所不同。 如果不同，请参阅产品文档来完成这些步骤。

    1.  单击“**开始**”，然后单击“**搜索**”。
    2.  在“**搜索结果**”窗格中，单击“**搜索助理**”下的“**所有文件和文件夹**”。
    3.  在“**完整或部分文件名**”框中，键入相应文件信息表中的一个文件名，然后单击“**搜索**”。
    4.  在文件列表中，用鼠标右键单击相应文件信息表中的一个文件名，然后单击“**属性**”。
        **注意** 由于安装的操作系统或程序的版本不同，因此文件信息表中所列的某些文件可能并未安装。
    5.  在“**版本**”选项卡上，通过将计算机上安装的文件与相应文件信息表中记录的版本进行比较来确定该文件的版本。
        **注意** 在安装过程中，除文件版本以外的其他属性均可能会发生变化。 不支持通过将其他文件属性与文件信息表中的信息进行比较这种方法来验证是否应用了更新。 另外，在某些情况下，在安装过程中还可能会重命名文件。 如果没有文件或版本信息，请使用另外一种方法来验证更新安装。

-   **注册表项验证**

    也可以通过查看以下注册表项，检查此安全更新已安装的文件。

    HKEY\_LOCAL\_MACHINE\\Software\\Microsoft\\Updates\\Visual Studio\\7.1\\M924643
    "Installed" = dword:1

#### Microsoft Visual Studio .NET 2003 Service Pack 1

**先决条件**
此安全更新需要 Microsoft Visual Studio .NET 2003 Service Pack 1。

**包括在以后的 Service Pack 中**
此问题的更新将包括在以后的 Service Pack 或更新汇总中。

**安装信息**

此安全更新支持以下安装开关。

<table class="dataTable">
<caption>
受支持的安全更新安装开关
</caption>
<tr class="thead">
<th>
开关
</th>
<th>
描述
</th>
</tr>
<tr>
<td style="border:1px solid black;">
**/?**
</td>
<td style="border:1px solid black;">
显示命令行选项。
</td>
</tr>
<tr>
<th colspan="2">
安装模式
</th>
</tr>
<tr class="alternateRow">
<td style="border:1px solid black;">
**/q**
</td>
<td style="border:1px solid black;">
无提示安装。
</td>
</tr>
<tr>
<th colspan="2">
安装选项
</th>
</tr>
<tr>
<td style="border:1px solid black;">
**/I**
</td>
<td style="border:1px solid black;">
安装（默认操作）。
</td>
</tr>
<tr class="alternateRow">
<td style="border:1px solid black;">
**/U**
</td>
<td style="border:1px solid black;">
卸载。
</td>
</tr>
<tr>
<td style="border:1px solid black;">
**/Xp\[:path\]**
</td>
<td style="border:1px solid black;">
将程序包解压缩到指定的目录。
</td>
</tr>
<tr>
<th colspan="2">
重新启动选项
</th>
</tr>
<tr class="alternateRow">
<td style="border:1px solid black;">
**/q**
</td>
<td style="border:1px solid black;">
安装完成后不重新启动。
</td>
</tr>
<tr>
<th colspan="2">
日志记录选项
</th>
</tr>
<tr>
<td style="border:1px solid black;">
**/l &lt;LogFile&gt;**
</td>
<td style="border:1px solid black;">
生成日志文件。
</td>
</tr>
<tr class="alternateRow">
<td style="border:1px solid black;">
**/l\[d | p | f \] &lt;LogFile&gt;**
</td>
<td style="border:1px solid black;">
d - 日志包详细信息  
p - 日志影响的产品  
f - 日志包含的文件
</td>
</tr>
</table>
<p> </p>
**注意** 这些开关可以在一个命令中组合使用。

**部署信息**

要在没有任何用户干预的情况下安装此安全更新，请在命令提示符下使用以下命令行：

**VS7.1sp1-KB927696-x86 /q**

**注意** 使用此命令也将安装安全更新，而不强制重新启动系统。

**注意** 使用 **/q** 开关将抑制所有消息。 这包括抑制失败消息。 管理员应该使用其中一种支持的方法，验证使用 **/q** 开关时安装是否成功。 管理员还应该检查 KB927696.log 文件，查看使用此开关时的任何失败消息。

有关如何使用软件更新服务部署此安全更新的信息，请访问[软件更新服务网站](http://go.microsoft.com/fwlink/?linkid=21125)。 有关如何使用 Windows Server 更新服务部署此安全更新的详细信息，请访问 [Windows Server 更新服务网站](http://go.microsoft.com/fwlink/?linkid=50120)。

**重新启动要求**

在某些情况下，此更新不需要重新启动。 如果所需的文件正在使用，则此更新将需要重新启动。 如果发生这种情况，将显示一条消息建议您重新启动。

**删除信息**

要删除此更新，请使用“控制面板”中的“添加/删除程序”工具。

**文件信息**

此安全更新的英文版具有下表所列的文件属性。 这些文件的日期和时间按照协调通用时间 (UTC) 列出。 当您查看文件信息时，它将转换为本地时间。 要了解 UTC 与本地时间之间的时差，请使用“控制面板”上的“日期/时间”工具中的“**时区**”选项卡。

Microsoft Visual Studio .NET 2003 Service Pack 1：

| 文件名                                  | 版本        | 日期               | 时间  | 大小       |
|-----------------------------------------|-------------|--------------------|-------|------------|
| atl71.dll                               | 7.10.6041.0 | 2006 年 8 月 26 日 | 06:44 | 89,600     |
| atl71.dll                               | 7.10.6041.0 | 2006 年 8 月 26 日 | 06:44 | 89,600     |
| atl71.dll                               | 7.10.6041.0 | 2006 年 8 月 26 日 | 06:44 | 106,496    |
| atl71.pdb                               | 不适用      | 2006 年 8 月 26 日 | 06:44 | 2,068,480  |
| atl71.pdb                               | 不适用      | 2006 年 8 月 26 日 | 06:44 | 2,068,480  |
| atlsd.lib                               | 不适用      | 2006 年 8 月 26 日 | 06:44 | 1,326,976  |
| atlsd.pdb                               | 不适用      | 2006 年 8 月 26 日 | 06:44 | 1,323,008  |
| atls.lib                                | 不适用      | 2006 年 8 月 26 日 | 06:44 | 1,282,964  |
| atls.pdb                                | 不适用      | 2006 年 8 月 26 日 | 06:44 | 1,323,008  |
| atl.lib                                 | 不适用      | 2006 年 8 月 26 日 | 06:44 | 14,546     |
| eafxisd.lib                             | 不适用      | 2006 年 8 月 26 日 | 07:21 | 320,952    |
| eafxisd.pdb                             | 不适用      | 2006 年 8 月 26 日 | 07:21 | 724,992    |
| eafxis.lib                              | 不适用      | 2006 年 8 月 26 日 | 07:21 | 329,588    |
| eafxis.pdb                              | 不适用      | 2006 年 8 月 26 日 | 07:21 | 897,024    |
| mfc71d.dll                              | 7.10.6041.0 | 2006 年 8 月 26 日 | 07:23 | 2,187,264  |
| mfc71chs.dll                            | 7.10.6041.0 | 2006 年 8 月 26 日 | 07:31 | 40,960     |
| mfc71cht.dll                            | 7.10.6041.0 | 2006 年 8 月 26 日 | 07:31 | 45,056     |
| mfc71deu.dll                            | 7.10.6041.0 | 2006 年 8 月 26 日 | 07:31 | 65,536     |
| mfc71d.lib                              | 不适用      | 2006 年 8 月 26 日 | 07:23 | 3,361,062  |
| mfc71d.map                              | 不适用      | 2006 年 8 月 26 日 | 07:23 | 2,187,489  |
| mfc71d.pdb                              | 不适用      | 2006 年 8 月 26 日 | 07:23 | 8,473,600  |
| mfc71enu.dll                            | 7.10.6041.0 | 2006 年 8 月 26 日 | 07:31 | 57,344     |
| mfc71esp.dll                            | 7.10.6041.0 | 2006 年 8 月 26 日 | 07:31 | 61,440     |
| mfc71fra.dll                            | 7.10.6041.0 | 2006 年 8 月 26 日 | 07:31 | 61,440     |
| mfc71ita.dll                            | 7.10.6041.0 | 2006 年 8 月 26 日 | 07:31 | 61,440     |
| mfc71jpn.dll                            | 7.10.6041.0 | 2006 年 8 月 26 日 | 07:31 | 49,152     |
| mfc71kor.dll                            | 7.10.6041.0 | 2006 年 8 月 26 日 | 07:31 | 49,152     |
| mfc71ud.dll                             | 7.10.6041.0 | 2006 年 8 月 26 日 | 07:24 | 2,183,168  |
| mfc71ud.lib                             | 不适用      | 2006 年 8 月 26 日 | 07:25 | 4,287,960  |
| mfc71ud.map                             | 不适用      | 2006 年 8 月 26 日 | 07:24 | 2,235,783  |
| mfc71ud.pdb                             | 不适用      | 2006 年 8 月 26 日 | 07:24 | 8,514,560  |
| mfc71u.dll                              | 7.10.6041.0 | 2006 年 8 月 26 日 | 07:47 | 1,053,184  |
| mfc71u.lib                              | 不适用      | 2006 年 8 月 26 日 | 07:26 | 3,348,140  |
| mfc71u.map                              | 不适用      | 2006 年 8 月 26 日 | 07:47 | 1,192,800  |
| mfc71u.pdb                              | 不适用      | 2006 年 8 月 26 日 | 07:47 | 10,554,368 |
| mfc71.dll                               | 7.10.6041.0 | 2006 年 8 月 26 日 | 07:23 | 1,060,864  |
| mfc71.lib                               | 不适用      | 2006 年 8 月 26 日 | 07:24 | 2,580,010  |
| mfc71.pdb                               | 不适用      | 2006 年 8 月 26 日 | 07:23 | 7,220,224  |
| mfcs71d.lib                             | 不适用      | 2006 年 8 月 26 日 | 07:23 | 586,414    |
| mfcs71d.pdb                             | 不适用      | 2006 年 8 月 26 日 | 07:23 | 1,937,408  |
| mfcs71ud.lib                            | 不适用      | 2006 年 8 月 26 日 | 07:25 | 509,512    |
| mfcs71ud.pdb                            | 不适用      | 2006 年 8 月 26 日 | 07:24 | 1,945,600  |
| mfcs71u.lib                             | 不适用      | 2006 年 8 月 26 日 | 07:36 | 491,984    |
| mfcs71u.pdb                             | 不适用      | 2006 年 8 月 26 日 | 07:36 | 1,937,408  |
| mfcs71.lib                              | 不适用      | 2006 年 8 月 26 日 | 07:24 | 565,986    |
| mfcs71.pdb                              | 不适用      | 2006 年 8 月 26 日 | 07:23 | 1,929,216  |
| nafxcwd.lib                             | 不适用      | 2006 年 8 月 26 日 | 07:21 | 17,390,490 |
| nafxcwd.pdb                             | 不适用      | 2006 年 8 月 26 日 | 07:20 | 2,142,208  |
| nafxcw.lib                              | 不适用      | 2006 年 8 月 26 日 | 07:21 | 17,308,020 |
| nafxcw.pdb                              | 不适用      | 2006 年 8 月 26 日 | 07:20 | 2,125,824  |
| nafxisd.lib                             | 不适用      | 2006 年 8 月 26 日 | 07:21 | 147,520    |
| nafxisd.pdb                             | 不适用      | 2006 年 8 月 26 日 | 07:21 | 118,784    |
| nafxis.lib                              | 不适用      | 2006 年 8 月 26 日 | 07:21 | 143,584    |
| nafxis.pdb                              | 不适用      | 2006 年 8 月 26 日 | 07:21 | 118,784    |
| uafxcwd.lib                             | 不适用      | 2006 年 8 月 26 日 | 07:22 | 17,787,842 |
| uafxcwd.pdb                             | 不适用      | 2006 年 8 月 26 日 | 07:21 | 2,142,208  |
| uafxcw.lib                              | 不适用      | 2006 年 8 月 26 日 | 07:22 | 17,598,838 |
| uafxcw.pdb                              | 不适用      | 2006 年 8 月 26 日 | 07:22 | 2,125,824  |
| vc\_user\_atl71\_rtl\_x86\_---.msm      | 不适用      | 2006 年 8 月 26 日 | 17:54 | 101,888    |
| vc\_user\_mfc71\_loc\_rtl\_x86\_---.msm | 不适用      | 2006 年 8 月 26 日 | 17:54 | 100,864    |
| vc\_user\_mfc71\_rtl\_x86\_---.msm      | 不适用      | 2006 年 8 月 26 日 | 17:54 | 892,928    |

**注意**当您安装这些安全更新时，安装程序将检查系统中正在更新的一个或多个文件是否已由 Microsoft 修补程序更新。

有关此行为的详细信息，请参阅 [Microsoft 知识库文章 824994](http://support.microsoft.com/kb/824994)。

有关本公告中出现的术语（如“*修补程序*”）的详细信息，请参阅 [Microsoft 知识库文章 824684](http://support.microsoft.com/kb/824684)。

**验证是否已应用更新**

-   **Microsoft 基准安全分析器**

    要验证受影响的系统上是否应用了安全更新，可以使用 Microsoft 基准安全分析器 (MBSA) 工具。 请参阅本安全公告前面的“与此安全更新相关的常见问题 (FAQ)”部分的常见问题“可否使用 Microsoft 基准安全分析器 (MBSA) 确定是否需要此更新？”。

-   **文件版本验证**

    **注意** 由于 Microsoft Windows 有多个版本，因此以下步骤在您的计算机上可能会有所不同。 如果不同，请参阅产品文档来完成这些步骤。

    1.  单击“**开始**”，然后单击“**搜索**”。
    2.  在“**搜索结果**”窗格中，单击“**搜索助理**”下的“**所有文件和文件夹**”。
    3.  在“**完整或部分文件名**”框中，键入相应文件信息表中的一个文件名，然后单击“**搜索**”。
    4.  在文件列表中，用鼠标右键单击相应文件信息表中的一个文件名，然后单击“**属性**”。
        **注意** 由于安装的操作系统或程序的版本不同，因此文件信息表中所列的某些文件可能并未安装。
    5.  在“**版本**”选项卡上，通过将计算机上安装的文件与相应文件信息表中记录的版本进行比较来确定该文件的版本。
        **注意** 在安装过程中，除文件版本以外的其他属性均可能会发生变化。 不支持通过将其他文件属性与文件信息表中的信息进行比较这种方法来验证是否应用了更新。 另外，在某些情况下，在安装过程中还可能会重命名文件。 如果没有文件或版本信息，请使用另外一种方法来验证更新安装。

-   **注册表项验证**

    也可以通过查看以下注册表项，检查此安全更新已安装的文件。

    HKEY\_LOCAL\_MACHINE\\Software\\Microsoft\\Updates\\Visual Studio\\7.1\\M927696
    "Installed" = dword:1

### 其他信息

**鸣谢**

Microsoft [感谢](http://go.microsoft.com/fwlink/?linkid=21127)下列人员或组织与我们一起致力于保护客户的利益：

-   [Immunity, Inc.](http://www.immunityinc.com/) 的 Kostya Kortchinsky 和 [EADS Common Research Center](http://www.eads.net/) 的Fabrice Desclaux 报告了 MFC 内存损坏漏洞 - (CVE-2007-0025)。

**获取其他安全更新：**

可从以下位置获得针对其他安全问题的更新：

-   [Microsoft 下载中心](http://go.microsoft.com/fwlink/?linkid=21129)提供了安全更新。 通过搜索关键字“安全修补程序”，可以非常方便地找到这些更新。
-   有关客户平台的更新可从 [Microsoft Update 网站](http://go.microsoft.com/fwlink/?linkid=40747)获得。

**支持：**

-   美国和加拿大的客户可拨打电话 1-866-PCSAFETY，从 [Microsoft 产品支持服务](http://go.microsoft.com/fwlink/?linkid=21131)获得技术支持。 与安全更新有关的电话支持服务是免费的。
-   其他国家（或地区）的用户可从当地的 Microsoft 分公司获得支持。 与安全更新有关的支持服务不收取任何费用。 有关如何就支持问题与 Microsoft 取得联系方面的详细信息，请访问[国际支持网站](http://go.microsoft.com/fwlink/?linkid=21155)。

**安全资源：**

-   [Microsoft TechNet 安全](http://go.microsoft.com/fwlink/?linkid=21132)网站提供了有关 Microsoft 产品安全的详细信息。
-   [TechNet 更新管理中心](http://go.microsoft.com/fwlink/?linkid=69903)
-   [Microsoft 软件更新服务](http://go.microsoft.com/fwlink/?linkid=21133)
-   [Microsoft Windows Server 更新服务](http://go.microsoft.com/fwlink/?linkid=50120)
-   [Microsoft 基准安全分析器](http://go.microsoft.com/fwlink/?linkid=21134) (MBSA)
-   [Windows Update](http://go.microsoft.com/fwlink/?linkid=21130)
-   [Microsoft Update](http://update.microsoft.com/microsoftupdate)
-   Windows Update 目录： 有关 Windows Update 目录的详细信息，请参阅 [Microsoft 知识库文章 323166](http://support.microsoft.com/kb/323166)。
-   [Office Update](http://go.microsoft.com/fwlink/?linkid=21135)

**软件更新服务：**

通过使用 Microsoft 软件更新服务 (SUS)，管理员可以在基于 Windows 2000 和 Windows Server 2003 的服务器以及运行 Windows 2000 Professional 或 Windows XP Professional 的台式机系统上快速而可靠地部署最新的关键更新和安全更新。

有关如何使用软件更新服务部署安全更新的详细信息，请访问[软件更新服务网站](http://go.microsoft.com/fwlink/?linkid=21133)。

**Windows Server 更新服务：**

通过使用 Windows Server 更新服务 (WSUS)，管理员可以快速而可靠地将 Windows 2000 操作系统和更高版本、Office XP 和更高版本、Exchange Server 2003 以及 SQL Server 2000 的最新关键更新和安全更新部署到 Windows 2000 和更高版本的操作系统。

有关如何使用 Windows Server 更新服务部署安全更新的详细信息，请访问 [Windows Server 更新服务网站](http://go.microsoft.com/fwlink/?linkid=50120)。

**Systems Management Server：**

Microsoft Systems Management Server (SMS) 提供了一个用于管理更新且可高度配置的企业解决方案。 通过使用 SMS，管理员可以确定需要安全更新的基于 Windows 的系统，并在整个企业中以可控制的方式执行这些更新的部署，而只对最终用户造成最低程度的干扰。 有关管理员如何使用 SMS 2003 来部署安全更新的详细信息，请访问 [SMS 2003 安全修补程序管理网站](http://go.microsoft.com/fwlink/?linkid=22939)。 SMS 2.0 用户还可以使用[软件更新服务功能包](http://go.microsoft.com/fwlink/?linkid=33340)帮助部署安全更新。 有关 SMS 的信息，请访问 [SMS 网站](http://go.microsoft.com/fwlink/?linkid=21158)。

**注意** SMS 使用 Microsoft 基准安全分析器、Microsoft Office 检测工具和企业更新扫描工具为安全公告更新检测和部署提供广泛支持。 这些工具可能检测不到某些软件更新。 在这些情况下，管理员可以使用 SMS 的清单功能将更新部署到特定系统上。 有关此过程的详细信息，请访问以下[网站](http://go.microsoft.com/fwlink/?linkid=33341)。 某些安全更新在重新启动系统后可能需要管理权限。 管理员可以使用提升权限部署工具（在 [SMS 2003 管理功能包](http://go.microsoft.com/fwlink/?linkid=33387)和 [SMS 2.0 管理功能包](http://go.microsoft.com/fwlink/?linkid=21161)中提供）来安装这些更新。

**免责声明：**

Microsoft 知识库中的信息“按原样”提供，没有任何形式的担保。 Microsoft 不作任何明示或暗示保证，包括对适销性和针对特定目的的适用性的保证。 Microsoft Corporation 或其供应商不对任何损害（包括直接的、间接的、偶然的、必然的损害，商业利润损失，或特殊损害）承担任何责任，即使 Microsoft Corporation 或其供应商事先已被告知有可能发生此类损害。 有些州不允许排除或限制必然或偶然损害的赔偿责任，因此上述限制可能不适用。

**修订：**

-   V1.0（2007 年 2 月 13 日）： 已发布公告。
-   V1.1（2007 年 2 月 21 日）已更新公告： 附加阐述已添加到电子邮件攻击媒介。 当用户与 RTF 电子邮件中格式错误的嵌入式 OLE 对象进行交互时，攻击者也可能企图利用此漏洞。 由于 [Microsoft 知识库文章中 924667](http://support.microsoft.com/?kbid=924667) 中反映的安全更新发现新问题，同时修订了此公告。
-   V1.2（2007 年 4 月 26 日）已更新公告： 提供附加阐述，解决了正在开发可动态链接到由 Visual Studio 更新替代的可重新分发文件的应用程序的客户所遇到的问题。 Microsoft SQL Server 2000 也被添加到“不受影响的软件”列表。
-   V2.0（2007 年 6 月 12 日）已更新公告： 此公告已重新发布，作为受影响的产品添加了 Microsoft Windows Server 2003 Service Pack 2。 Platform SDK 也被添加到“不受影响的软件”列表。

*Built at 2014-04-18T01:50:00Z-07:00*
